/* ForensicInvestigator - Design sobre et professionnel */
/* Palette: Blanc et Bleu foncé uniquement */

/* Toast Notifications */
#toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10001;
    display: flex;
    flex-direction: column;
    gap: 10px;
    pointer-events: none;
}

.toast {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 20px;
    border-radius: 8px;
    background: #1e3a5f;
    color: white;
    font-size: 14px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    animation: toastSlideIn 0.3s ease-out;
    pointer-events: auto;
}

.toast .material-icons {
    font-size: 20px;
}

.toast-success {
    background: #059669;
}

.toast-error {
    background: #dc2626;
}

.toast-warning {
    background: #d97706;
}

.toast-info {
    background: #1e3a5f;
}

.toast-fade-out {
    animation: toastFadeOut 0.3s ease-out forwards;
}

@keyframes toastSlideIn {
    from {
        opacity: 0;
        transform: translateX(100%);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes toastFadeOut {
    from {
        opacity: 1;
        transform: translateX(0);
    }
    to {
        opacity: 0;
        transform: translateX(100%);
    }
}

/* Authentication Modal */
.auth-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #1e3a5f 0%, #0f1f33 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
}

.auth-modal-content {
    background: white;
    padding: 3rem;
    border-radius: 16px;
    box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
    text-align: center;
    max-width: 400px;
    width: 90%;
    animation: authFadeIn 0.3s ease-out;
}

@keyframes authFadeIn {
    from { opacity: 0; transform: scale(0.95) translateY(-20px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
}

.auth-modal-header {
    margin-bottom: 1.5rem;
}

.auth-modal-header .auth-icon {
    font-size: 3rem;
    color: #1e3a5f;
    background: linear-gradient(135deg, #e8f4fc 0%, #d4e8f5 100%);
    padding: 1rem;
    border-radius: 50%;
    display: inline-block;
    margin-bottom: 1rem;
}

.auth-modal-header h2 {
    color: #1e3a5f;
    font-size: 1.5rem;
    font-weight: 600;
}

.auth-description {
    color: #4a5568;
    margin-bottom: 2rem;
    line-height: 1.6;
    font-size: 0.95rem;
}

.auth-input-group {
    display: flex;
    align-items: center;
    background: #f7fafc;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    padding: 0.75rem 1rem;
    margin-bottom: 1rem;
    transition: border-color 0.2s;
}

.auth-input-group:focus-within {
    border-color: #1e3a5f;
}

.auth-input-group .material-icons {
    color: #718096;
    margin-right: 0.75rem;
}

.auth-input-group input {
    flex: 1;
    border: none;
    background: transparent;
    font-size: 1rem;
    outline: none;
    color: #1a1a2e;
}

.auth-input-group input::placeholder {
    color: #a0aec0;
}

.auth-error {
    color: #e53e3e;
    font-size: 0.875rem;
    margin-bottom: 1rem;
    padding: 0.5rem;
    background: #fff5f5;
    border-radius: 6px;
}

.auth-submit {
    width: 100%;
    padding: 0.875rem;
    font-size: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.auth-submit .material-icons {
    font-size: 1.25rem;
}

:root {
    --primary: #1e3a5f;
    --primary-dark: #152a45;
    --primary-light: #2d4a6f;
    --primary-hover: #1a3050;
    --text-dark: #1a1a2e;
    --text-muted: #4a5568;
    --text-light: #718096;
    --border: #e2e8f0;
    --border-dark: #cbd5e0;
    --bg-white: #ffffff;
    --bg-light: #f7fafc;
    --bg-subtle: #edf2f7;
    --success: #1e3a5f;
    --warning: #2d4a6f;
    --danger: #1e3a5f;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* Toast notification animation */
@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

/* Streaming cursor animation */
@keyframes blink {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0; }
}

.streaming-cursor {
    animation: blink 0.8s infinite;
    color: var(--primary);
    font-weight: bold;
}

/* Analysis Streaming Header */
.analysis-streaming {
    background: linear-gradient(135deg, var(--bg-white), var(--bg-lighter));
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.analysis-streaming .streaming-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    color: var(--primary);
    margin-bottom: 0.5rem;
}

.analysis-streaming .streaming-meta {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: var(--text-muted);
}

.analysis-streaming .streaming-meta .material-icons {
    font-size: 1rem;
}

.streaming-content {
    line-height: 1.7;
}

/* Analysis Error */
.analysis-error {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    text-align: center;
    background: var(--bg-lighter);
    border-radius: 8px;
    border: 1px solid var(--danger);
}

.analysis-error .material-icons {
    font-size: 3rem;
    color: var(--danger);
    margin-bottom: 0.5rem;
}

.analysis-error p {
    margin: 0.25rem 0;
    color: var(--text-dark);
}

/* Utility classes */
.hidden {
    display: none !important;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background-color: var(--bg-light);
    color: var(--text-dark);
    line-height: 1.6;
}

/* Layout principal */
.app-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
}

/* Header */
.header {
    background: var(--primary);
    color: white;
    padding: 1rem 2rem;
    box-shadow: 0 2px 10px rgba(30, 58, 95, 0.15);
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 1rem;
}

.header h1 {
    font-size: 1.5rem;
    font-weight: 600;
    letter-spacing: -0.5px;
}

.header-subtitle {
    font-size: 0.875rem;
    opacity: 0.8;
    margin-top: 0.25rem;
}

/* Header layout */
.header-left {
    display: flex;
    flex-direction: column;
}

.header-right {
    display: flex;
    align-items: center;
    gap: 1rem;
}

/* Bouton aide header */
.btn-header-help {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: rgba(255, 255, 255, 0.15);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.3);
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-header-help:hover {
    background: rgba(255, 255, 255, 0.25);
    border-color: rgba(255, 255, 255, 0.5);
}

.btn-header-help .material-icons {
    font-size: 1.25rem;
}

/* Help Sidebar */
.help-sidebar-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.help-sidebar-overlay.active {
    opacity: 1;
    visibility: visible;
}

.help-sidebar {
    position: fixed;
    top: 0;
    left: 0;
    width: 50%;
    max-width: 700px;
    min-width: 400px;
    height: 100vh;
    background: var(--bg-white);
    box-shadow: 4px 0 30px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    transform: translateX(-100%);
    transition: transform 0.3s ease;
    display: flex;
    flex-direction: column;
}

.help-sidebar.active {
    transform: translateX(0);
}

.help-sidebar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.25rem 1.5rem;
    background: var(--primary);
    color: white;
}

.help-sidebar-header h2 {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1.25rem;
    font-weight: 600;
    margin: 0;
}

.help-sidebar-header h2 .material-icons {
    font-size: 1.5rem;
}

.help-sidebar-header .btn-ghost {
    color: white;
    opacity: 0.8;
}

.help-sidebar-header .btn-ghost:hover {
    opacity: 1;
    background: rgba(255, 255, 255, 0.1);
}

.help-sidebar-content {
    flex: 1;
    overflow-y: auto;
    padding: 1.5rem;
}

.help-section {
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--border);
}

.help-section:last-child {
    border-bottom: none;
    margin-bottom: 0;
}

.help-section h3 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--primary);
    margin-bottom: 0.75rem;
}

.help-section h3 .material-icons {
    font-size: 1.25rem;
}

.help-section p {
    color: var(--text-dark);
    line-height: 1.6;
    margin-bottom: 0.75rem;
}

.help-section ul {
    margin: 0;
    padding-left: 1.25rem;
    color: var(--text-muted);
}

.help-section li {
    margin-bottom: 0.5rem;
    line-height: 1.5;
}

.help-section li strong {
    color: var(--text-dark);
}

.help-section ul ul {
    margin-top: 0.5rem;
    padding-left: 1rem;
}

.help-section ul ul li {
    margin-bottom: 0.25rem;
}

.help-section code {
    background: var(--bg-subtle);
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
    font-family: 'Monaco', 'Consolas', monospace;
    font-size: 0.85rem;
    color: var(--primary);
}

.help-tips {
    background: var(--bg-subtle);
    padding: 1.25rem;
    border-radius: 8px;
    border: 1px solid var(--border);
}

.help-tips h3 {
    color: var(--primary-dark);
}

.help-tips ul {
    color: var(--text-dark);
}

@media (max-width: 900px) {
    .help-sidebar {
        width: 80%;
        min-width: unset;
    }
}

@media (max-width: 600px) {
    .help-sidebar {
        width: 100%;
    }
}

/* Recherche globale */
.header-search {
    position: relative;
    display: flex;
    align-items: center;
    background: rgba(255,255,255,0.15);
    border-radius: 8px;
    padding: 0.5rem 1rem;
    min-width: 300px;
}

.header-search .material-icons {
    font-size: 1.25rem;
    opacity: 0.7;
    margin-right: 0.5rem;
}

.header-search input {
    background: transparent;
    border: none;
    color: white;
    font-size: 0.875rem;
    width: 100%;
    outline: none;
}

.header-search input::placeholder {
    color: rgba(255,255,255,0.6);
}

.search-results {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    margin-top: 0.5rem;
    max-height: 400px;
    overflow-y: auto;
    z-index: 1000;
}

.search-result-item {
    padding: 0.75rem 1rem;
    cursor: pointer;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--text-dark);
}

.search-result-item:hover {
    background: var(--bg-subtle);
}

.search-result-item:last-child {
    border-bottom: none;
}

.search-result-item .material-icons {
    color: var(--primary);
    font-size: 1.25rem;
}

.search-result-type {
    font-size: 0.7rem;
    text-transform: uppercase;
    background: var(--bg-subtle);
    color: var(--text-muted);
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    margin-left: auto;
}

.search-no-results {
    padding: 1rem;
    text-align: center;
    color: var(--text-muted);
    font-size: 0.875rem;
}

/* Navigation principale */
.main-nav {
    background: var(--bg-white);
    border-bottom: 1px solid var(--border);
    padding: 0.5rem 2rem;
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.nav-btn {
    background: transparent;
    border: 1px solid transparent;
    color: var(--text-muted);
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-size: 0.875rem;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.nav-btn:hover {
    background: var(--bg-subtle);
    color: var(--primary);
}

.nav-btn.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

/* Contenu principal */
.main-content {
    display: flex;
    flex: 1;
    overflow: hidden;
    min-height: 0;
}

/* Sidebar */
.sidebar {
    width: 280px;
    background: var(--bg-white);
    border-right: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    height: 100%;
}

.sidebar-header {
    padding: 1rem;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.sidebar-title {
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted);
}

.sidebar-filter {
    padding: 0.5rem 0.75rem;
    border-bottom: 1px solid var(--border);
    background: var(--bg-subtle);
}

.sidebar-filter .form-select {
    width: 100%;
    font-size: 0.8rem;
    padding: 0.4rem 0.5rem;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: white;
    cursor: pointer;
}

.sidebar-filter .form-select:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(30, 58, 95, 0.1);
}

/* Sidebar filters avancés */
.sidebar-filters {
    padding: 0.5rem;
    border-bottom: 1px solid var(--border);
    background: var(--bg-subtle);
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
}

.sidebar-filters .filter-row {
    width: 100%;
}

.sidebar-filters .form-select-sm,
.sidebar-filters .form-input-sm {
    width: 100%;
    font-size: 0.75rem;
    padding: 0.35rem 0.5rem;
    border-radius: 5px;
    border: 1px solid var(--border);
    background: white;
}

.sidebar-filters .form-select-sm:focus,
.sidebar-filters .form-input-sm:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(30, 58, 95, 0.1);
}

.sidebar-filters .form-input-sm::placeholder {
    color: var(--text-light);
}

.sidebar-filters .filter-row-search {
    display: flex;
    gap: 0.25rem;
}

.sidebar-filters .filter-row-search .form-input-sm {
    flex: 1;
}

.btn-icon-sm {
    padding: 0.3rem;
    min-width: auto;
    border-radius: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.btn-icon-sm .material-icons {
    font-size: 1rem;
}

.btn-icon-sm:hover {
    background: var(--primary);
    color: white;
}

/* Case item amélioré */
.case-item-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.5rem;
}

.recent-indicator {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 18px;
    height: 18px;
    background: var(--primary);
    color: white;
    font-size: 0.65rem;
    font-weight: 600;
    border-radius: 50%;
    flex-shrink: 0;
}

.case-item.recent {
    border-left: 3px solid var(--primary);
}

.case-item-actions {
    display: flex;
    align-items: center;
    gap: 0.35rem;
}

.btn-delete-case {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    padding: 0;
    background: transparent;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    opacity: 0;
    transition: all 0.2s ease;
    color: var(--text-muted);
}

.case-item:hover .btn-delete-case {
    opacity: 1;
}

.btn-delete-case:hover {
    background: rgba(239, 68, 68, 0.1);
    color: #b91c1c;
}

.btn-delete-case .material-icons {
    font-size: 1rem;
}

.case-item.active .btn-delete-case {
    color: rgba(255, 255, 255, 0.7);
}

.case-item.active .btn-delete-case:hover {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

.case-status-badge {
    font-size: 0.65rem;
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
    background: var(--bg-light);
    color: var(--text-muted);
}

.case-status-badge.en_cours {
    background: #dbeafe;
    color: #1e40af;
}

.case-status-badge.resolu {
    background: #d1fae5;
    color: #065f46;
}

.case-status-badge.classe {
    background: var(--bg-subtle);
    color: var(--text-light);
}

.sidebar-content {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 0.5rem;
    min-height: 0;
}

/* Case list items */
.case-item {
    padding: 0.75rem 1rem;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-bottom: 0.25rem;
    border: 1px solid transparent;
}

.case-item:hover {
    background: var(--bg-subtle);
}

.case-item.active {
    background: var(--primary);
    color: white;
}

.case-item-name {
    font-weight: 500;
    font-size: 0.9rem;
}

.case-item-meta {
    font-size: 0.75rem;
    opacity: 0.7;
    margin-top: 0.25rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.case-type-badge {
    display: inline-block;
    font-size: 0.65rem;
    font-weight: 600;
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
    text-transform: uppercase;
    letter-spacing: 0.3px;
    /* Couleur par défaut pour les types non définis */
    background: #6b7280;
    color: white;
}

.case-type-badge.homicide {
    background: #dc2626;
    color: white;
}

.case-type-badge.disparition {
    background: #f59e0b;
    color: white;
}

.case-type-badge.fraude {
    background: #8b5cf6;
    color: white;
}

.case-type-badge.vol {
    background: #3b82f6;
    color: white;
}

.case-type-badge.incendie {
    background: #ef4444;
    color: white;
}

.case-type-badge.trafic {
    background: #059669;
    color: white;
}

.case-type-badge.agression {
    background: #ec4899;
    color: white;
}

.case-type-badge.cyber {
    background: #06b6d4;
    color: white;
}

.case-type-badge.terrorisme {
    background: #1f2937;
    color: white;
}

.case-type-badge.autre {
    background: var(--text-muted);
    color: white;
}

.case-item.active .case-type-badge {
    background: rgba(255, 255, 255, 0.25);
    color: white;
}

/* Workspace */
.workspace {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.workspace-header {
    padding: 1rem 1.5rem;
    background: var(--bg-white);
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.workspace-tabs {
    display: flex;
    gap: 0.25rem;
}

.tab-btn {
    background: transparent;
    border: none;
    padding: 0.5rem 1rem;
    color: var(--text-muted);
    font-size: 0.875rem;
    cursor: pointer;
    border-radius: 6px;
    transition: all 0.2s ease;
}

.tab-btn:hover {
    background: var(--bg-subtle);
    color: var(--primary);
}

.tab-btn.active {
    background: var(--primary);
    color: white;
}

.workspace-content {
    flex: 1;
    overflow: hidden;
    padding: 1.5rem;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr;
    gap: 1.5rem;
    max-height: calc(100vh - 180px);
}

/* Hypotheses view - single column layout */
#view-hypotheses {
    grid-template-columns: 1fr;
}

/* Hypotheses list - 2 columns grid */
#hypotheses-list {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
}

#hypotheses-list .hypothesis-card {
    margin-bottom: 0;
}

/* Panels */
.panel {
    background: var(--bg-white);
    border-radius: 8px;
    border: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.panel-header {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--bg-light);
}

.panel-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-dark);
}

.panel-description {
    font-size: 0.8rem;
    color: var(--text-muted);
    padding: 0.75rem 1rem;
    background: var(--bg-subtle);
    border-bottom: 1px solid var(--border);
    line-height: 1.5;
}

.panel-description .material-icons {
    font-size: 1rem;
    vertical-align: middle;
    margin-right: 0.25rem;
    color: var(--primary);
}

.panel-content {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
}

.panel-full {
    grid-column: span 2;
}

/* Buttons */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid transparent;
}

.btn-primary {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.btn-primary:hover {
    background: var(--primary-dark);
    border-color: var(--primary-dark);
}

.btn-secondary {
    background: var(--bg-white);
    color: var(--primary);
    border-color: var(--border-dark);
}

.btn-secondary:hover {
    background: var(--bg-subtle);
}

.btn-ghost {
    background: transparent;
    color: var(--text-muted);
}

.btn-ghost:hover {
    background: var(--bg-subtle);
    color: var(--primary);
}

.btn-separator {
    display: inline-block;
    width: 1px;
    height: 24px;
    background: var(--border);
    margin: 0 0.25rem;
    vertical-align: middle;
}

.btn-sm {
    padding: 0.375rem 0.75rem;
    font-size: 0.8rem;
}

.btn-icon {
    padding: 0.5rem;
    width: 36px;
    height: 36px;
}

.btn-sm.btn-icon {
    padding: 0.25rem;
    width: 28px;
    height: 28px;
    min-width: 28px;
}

/* Panel collapsible */
.panel {
    transition: all 0.3s ease;
    min-width: 0;
}

.panel-collapsed {
    min-width: 48px !important;
    max-width: 48px !important;
    flex: 0 0 48px !important;
}

.panel-collapsed .panel-content,
.panel-collapsed .panel-description {
    display: none !important;
}

.panel-collapsed .panel-header {
    flex-direction: column;
    align-items: center;
    padding: 0.75rem 0.5rem;
    height: 100%;
}

.panel-collapsed .panel-title {
    writing-mode: vertical-rl;
    text-orientation: mixed;
    white-space: nowrap;
    margin-top: 0.5rem;
}

.panel-collapsed .panel-header > div {
    display: flex;
    flex-direction: column;
}

.panel-collapsed .panel-header .btn:not(.btn-icon) {
    display: none;
}

/* Panel section divider (for integrated alerts) */
.panel-section-divider {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: var(--bg-subtle);
    border-top: 1px solid var(--border);
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--primary);
}

.panel-section-divider .material-icons {
    font-size: 1rem;
}

/* N4L specific - when one panel is collapsed, the other expands */
#view-n4l {
    display: grid;
    grid-template-columns: 1fr 1fr;
}

#view-n4l.has-collapsed {
    grid-template-columns: 48px 1fr;
}

#view-n4l.has-collapsed-right {
    grid-template-columns: 1fr 48px;
}

/* Graph containers */
#graph-container,
#n4l-graph-container {
    width: 100%;
    height: 100%;
    min-height: 300px;
    background: var(--bg-light);
    border-radius: 4px;
}

#n4l-metadata-container {
    background: var(--bg-subtle);
    border-radius: 8px;
    padding: 0.75rem;
    font-size: 0.8rem;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

/* N4L Info Banner */
.n4l-info-banner {
    display: flex;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%);
    border-radius: 6px;
    border-left: 3px solid var(--primary);
    font-size: 0.75rem;
    color: #0369a1;
    line-height: 1.4;
}

.n4l-info-banner .material-icons {
    font-size: 1rem;
    color: var(--primary);
    flex-shrink: 0;
    margin-top: 2px;
}

.n4l-info-banner em {
    font-style: normal;
    background: #bae6fd;
    padding: 0 4px;
    border-radius: 3px;
}

/* N4L Stats Row */
.n4l-stats-row {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.n4l-stat-item {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    background: white;
    padding: 0.35rem 0.6rem;
    border-radius: 20px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    font-size: 0.7rem;
}

.n4l-stat-item .material-icons {
    font-size: 0.9rem;
    color: var(--primary);
}

.n4l-stat-value {
    font-weight: 700;
    color: var(--primary);
}

.n4l-stat-label {
    color: var(--text-muted);
}

/* N4L Sections */
.n4l-section {
    background: white;
    border-radius: 6px;
    padding: 0.5rem;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

.n4l-section-header {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
}

.n4l-section-header .material-icons {
    font-size: 1rem;
    color: var(--primary);
}

.n4l-section-header.n4l-collapsible {
    cursor: pointer;
    padding: 0.25rem;
    margin: -0.25rem;
    border-radius: 4px;
    transition: background 0.15s;
}

.n4l-section-header.n4l-collapsible:hover {
    background: var(--bg-subtle);
}

.n4l-expand-icon {
    margin-left: auto;
    color: var(--text-muted) !important;
}

.n4l-section-content {
    overflow: hidden;
    transition: max-height 0.3s ease;
}

.n4l-section-content.n4l-collapsed {
    max-height: 0;
    margin-bottom: 0;
}

/* Graph Legend */
.graph-legend-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    padding: 0.75rem;
}

.legend-group {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
}

.legend-group-title {
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.25rem;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.75rem;
    color: var(--text-dark);
}

.legend-shape {
    width: 14px;
    height: 14px;
    flex-shrink: 0;
}

.legend-shape.dot {
    border-radius: 50%;
}

.legend-shape.square {
    border-radius: 2px;
}

.legend-shape.triangle {
    width: 0;
    height: 0;
    background: transparent !important;
    border-left: 7px solid transparent;
    border-right: 7px solid transparent;
    border-bottom: 14px solid var(--shape-color, #f59e0b);
}

.legend-shape.triangle-down {
    width: 0;
    height: 0;
    background: transparent !important;
    border-left: 7px solid transparent;
    border-right: 7px solid transparent;
    border-top: 14px solid var(--shape-color, #06b6d4);
}

.legend-shape.diamond {
    transform: rotate(45deg);
    border-radius: 2px;
    width: 10px;
    height: 10px;
    margin: 2px;
}

.legend-shape.star {
    clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
}

.legend-shape.hexagon {
    clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
}

.legend-line {
    width: 25px;
    height: 3px;
    border-radius: 2px;
    flex-shrink: 0;
}

.n4l-reset-btn {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 0.2rem;
    background: #ef4444;
    color: white;
    border: none;
    padding: 0.2rem 0.5rem;
    border-radius: 12px;
    font-size: 0.65rem;
    font-weight: 500;
    cursor: pointer;
    transition: background 0.15s;
}

.n4l-reset-btn:hover {
    background: #dc2626;
}

.n4l-reset-btn .material-icons {
    font-size: 0.8rem;
    color: white !important;
}

.n4l-reset-btn.hidden {
    display: none;
}

/* N4L Context Grid */
.n4l-context-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.35rem;
}

.n4l-context-btn {
    display: flex;
    align-items: center;
    gap: 0.3rem;
    padding: 0.35rem 0.5rem;
    background: #f1f5f9;
    border: 1px solid transparent;
    border-radius: 6px;
    font-size: 0.7rem;
    color: var(--text-dark);
    cursor: pointer;
    transition: all 0.15s;
    text-align: left;
}

.n4l-context-btn .material-icons {
    font-size: 0.9rem;
    color: var(--primary);
}

.n4l-context-btn:hover {
    background: #e0f2fe;
    border-color: var(--primary);
}

.n4l-context-btn.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.n4l-context-btn.active .material-icons {
    color: white;
}

/* N4L Layout Grid */
.n4l-layout-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 0.35rem;
}

.n4l-layout-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.2rem;
    padding: 0.5rem 0.3rem;
    background: #f1f5f9;
    border: 1px solid transparent;
    border-radius: 6px;
    font-size: 0.65rem;
    color: var(--text-dark);
    cursor: pointer;
    transition: all 0.15s;
}

.n4l-layout-btn .material-icons {
    font-size: 1.1rem;
    color: var(--primary);
}

.n4l-layout-btn:hover {
    background: #e0f2fe;
    border-color: var(--primary);
}

.n4l-layout-btn.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.n4l-layout-btn.active .material-icons {
    color: white;
}

/* N4L Sequences */
.n4l-sequence-item {
    padding: 0.4rem 0.5rem;
    background: #fef3c7;
    border-radius: 4px;
    margin-bottom: 0.35rem;
    cursor: pointer;
    transition: all 0.15s;
    border-left: 3px solid #f59e0b;
}

.n4l-sequence-item:last-child {
    margin-bottom: 0;
}

.n4l-sequence-item:hover {
    background: #fde68a;
    transform: translateX(2px);
}

.n4l-sequence-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.2rem;
}

.n4l-sequence-number {
    background: #f59e0b;
    color: white;
    font-size: 0.6rem;
    font-weight: 700;
    padding: 0.1rem 0.35rem;
    border-radius: 10px;
}

.n4l-sequence-count {
    font-size: 0.65rem;
    color: #92400e;
}

.n4l-sequence-preview {
    font-size: 0.65rem;
    color: #78350f;
    line-height: 1.3;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* N4L Sequence Navigation */
.n4l-sequence-block {
    margin-bottom: 0.5rem;
}

.n4l-sequence-block:last-child {
    margin-bottom: 0;
}

.n4l-sequence-nav {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    border-radius: 6px;
    padding: 0.5rem;
    margin-top: 0.35rem;
    border: 1px solid #f59e0b;
}

.n4l-sequence-nav-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.n4l-nav-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    background: white;
    border: 1px solid #d97706;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.15s;
    padding: 0;
}

.n4l-nav-btn:hover {
    background: #f59e0b;
    color: white;
}

.n4l-nav-btn:hover .material-icons {
    color: white;
}

.n4l-nav-btn .material-icons {
    font-size: 1rem;
    color: #92400e;
}

.n4l-nav-btn.n4l-nav-play {
    background: #f59e0b;
}

.n4l-nav-btn.n4l-nav-play .material-icons {
    color: white;
}

.n4l-nav-btn.n4l-nav-play:hover {
    background: #d97706;
}

.n4l-nav-indicator {
    font-size: 0.75rem;
    font-weight: 600;
    color: #92400e;
    min-width: 50px;
    text-align: center;
}

.n4l-nav-current {
    color: #dc2626;
    font-size: 0.85rem;
}

.n4l-sequence-current-label {
    text-align: center;
    margin-top: 0.4rem;
    font-size: 0.7rem;
    font-weight: 600;
    color: #78350f;
    padding: 0.25rem 0.5rem;
    background: white;
    border-radius: 4px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* N4L Aliases */
.n4l-alias-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
}

.n4l-alias-item {
    background: #f3e8ff;
    padding: 0.2rem 0.4rem;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s;
}

.n4l-alias-item:hover {
    background: #e9d5ff;
    transform: scale(1.02);
}

.n4l-alias-key {
    font-family: monospace;
    font-size: 0.65rem;
    color: #7c3aed;
}

.n4l-alias-more {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.7rem;
    color: var(--primary);
    padding: 0.35rem 0.5rem;
    cursor: pointer;
    background: var(--bg-light);
    border-radius: 4px;
    transition: all 0.2s ease;
    grid-column: 1 / -1;
    justify-content: center;
    margin-top: 0.25rem;
}

.n4l-alias-more:hover {
    background: var(--primary);
    color: white;
}

.n4l-alias-more .material-icons {
    font-size: 1rem;
}

.n4l-alias-hidden {
    display: contents;
}

/* N4L Graph Legend */
.n4l-legend {
    position: absolute;
    top: 10px;
    right: 10px;
    background: white;
    padding: 0.6rem;
    border-radius: 6px;
    font-size: 0.8rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    z-index: 100;
    border: 1px solid var(--border);
}

.n4l-legend-title {
    font-weight: 600;
    margin-bottom: 0.4rem;
    color: var(--primary);
    font-size: 0.75rem;
}

.n4l-legend-item {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    margin-bottom: 0.2rem;
    font-size: 0.7rem;
    color: var(--text-dark);
}

.n4l-legend-item:last-child {
    margin-bottom: 0;
}

.n4l-legend-line {
    width: 20px;
    height: 3px;
    border-radius: 2px;
    flex-shrink: 0;
}

/* N4L Legend in fullscreen */
.fullscreen-panel .n4l-legend {
    top: 15px;
    right: 15px;
    z-index: 200;
}

/* N4L TODOs */
.n4l-todo-section {
    border-left: 3px solid #ef4444;
}

.n4l-todo-section .n4l-section-header {
    color: #dc2626;
}

.n4l-todo-section .n4l-section-header .material-icons {
    color: #ef4444;
}

.n4l-todo-list {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.n4l-todo-item {
    display: flex;
    align-items: flex-start;
    gap: 0.35rem;
    font-size: 0.7rem;
    color: #991b1b;
    padding: 0.25rem;
    background: #fef2f2;
    border-radius: 4px;
}

.n4l-todo-item .material-icons {
    font-size: 0.85rem;
    color: #ef4444;
    flex-shrink: 0;
}

/* N4L Causal Chains Section */
.n4l-causal-section {
    border-left: 3px solid #f97316;
}

.n4l-causal-section .n4l-section-header {
    color: #ea580c;
}

.n4l-causal-section .n4l-section-header .material-icons {
    color: #f97316;
}

.n4l-chain-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.n4l-chain-item {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    padding: 0.5rem;
    background: #fff7ed;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.n4l-chain-item:hover {
    background: #ffedd5;
    transform: translateX(2px);
}

.n4l-chain-elements {
    font-family: monospace;
    font-size: 0.8rem;
    color: #9a3412;
    word-break: break-all;
}

.n4l-chain-meta {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.7rem;
}

.n4l-chain-context {
    color: var(--text-muted);
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.n4l-chain-type {
    background: #fed7aa;
    color: #9a3412;
    padding: 0.125rem 0.375rem;
    border-radius: 3px;
    font-weight: 500;
}

/* N4L Restore Button */
.n4l-restore-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 500;
    margin-bottom: 0.75rem;
    transition: all 0.2s ease;
    width: 100%;
    justify-content: center;
}

.n4l-restore-btn:hover {
    background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(249, 115, 22, 0.3);
}

.n4l-restore-btn .material-icons {
    font-size: 1.1rem;
}

/* N4L Chain Header */
.n4l-chain-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.75rem;
    margin-bottom: 0.25rem;
}

.n4l-chain-number {
    background: #f97316;
    color: white;
    width: 1.25rem;
    height: 1.25rem;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 0.7rem;
}

.n4l-chain-id {
    color: #9a3412;
    font-family: monospace;
    font-size: 0.7rem;
}

/* N4L Chain Steps */
.n4l-chain-steps {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.8rem;
}

.n4l-chain-step {
    background: white;
    color: #9a3412;
    padding: 0.125rem 0.5rem;
    border-radius: 4px;
    border: 1px solid #fed7aa;
}

.n4l-chain-arrow {
    color: #f97316;
    font-weight: bold;
}

/* N4L Cross References Section */
.n4l-crossrefs-section {
    border-left: 3px solid #a855f7;
}

.n4l-crossrefs-section .n4l-section-header {
    color: #9333ea;
}

.n4l-crossrefs-section .n4l-section-header .material-icons {
    color: #a855f7;
}

.n4l-crossref-list {
    display: flex;
    flex-direction: column;
    gap: 0.375rem;
}

.n4l-crossref-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.375rem 0.5rem;
    background: #faf5ff;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.n4l-crossref-item:hover {
    background: #f3e8ff;
    transform: translateX(2px);
}

.n4l-crossref-alias {
    font-family: monospace;
    font-size: 0.8rem;
    color: #7c3aed;
    font-weight: 600;
}

.n4l-crossref-arrow {
    color: var(--text-muted);
    font-size: 0.8rem;
}

.n4l-crossref-value {
    font-size: 0.8rem;
    color: var(--text-dark);
}

/* N4L Markers Section */
.n4l-markers-section {
    border-left: 3px solid #06b6d4;
}

.n4l-markers-section .n4l-section-header {
    color: #0891b2;
}

.n4l-markers-section .n4l-section-header .material-icons {
    color: #06b6d4;
}

.n4l-marker-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.375rem;
}

.n4l-marker-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 500;
}

.n4l-marker-tag.definition {
    background: #ecfdf5;
    color: #059669;
    border: 1px solid #a7f3d0;
}

.n4l-marker-tag.important {
    background: #fef3c7;
    color: #d97706;
    border: 1px solid #fcd34d;
}

.n4l-marker-tag.reference {
    background: #e0f2fe;
    color: #0284c7;
    border: 1px solid #7dd3fc;
}

.n4l-marker-tag .material-icons {
    font-size: 0.75rem;
}

/* N4L Marker Groups */
.n4l-marker-group {
    margin-bottom: 0.5rem;
}

.n4l-marker-label {
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--text-secondary);
    margin-bottom: 0.25rem;
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.n4l-marker-icon {
    font-weight: 700;
    font-size: 0.85rem;
}

.n4l-marker-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.375rem;
}

.n4l-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 500;
}

.n4l-tag-def {
    background: #ecfdf5;
    color: #059669;
    border: 1px solid #a7f3d0;
}

.n4l-tag-important {
    background: #fef3c7;
    color: #d97706;
    border: 1px solid #fcd34d;
}

.n4l-tag-ref {
    background: #e0f2fe;
    color: #0284c7;
    border: 1px solid #7dd3fc;
}

/* Clickable marker styles */
.n4l-marker-clickable {
    cursor: pointer;
    transition: all 0.15s ease;
}

.n4l-marker-clickable:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
    filter: brightness(0.95);
}

.n4l-marker-clickable:active {
    transform: translateY(0);
    box-shadow: none;
}

/* Forms */
.form-group {
    margin-bottom: 1rem;
}

.form-label {
    display: block;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--text-dark);
    margin-bottom: 0.375rem;
}

.form-input,
.form-select,
.form-textarea {
    width: 100%;
    padding: 0.625rem 0.875rem;
    border: 1px solid var(--border-dark);
    border-radius: 6px;
    font-size: 0.875rem;
    transition: all 0.2s ease;
    background: var(--bg-white);
}

.form-input:focus,
.form-select:focus,
.form-textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(30, 58, 95, 0.1);
}

.form-textarea {
    min-height: 100px;
    resize: vertical;
}

/* Entity cards */
.entity-card {
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 0.75rem;
    transition: all 0.2s ease;
}

.entity-card:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(30, 58, 95, 0.1);
}

.entity-card.summary-link {
    background: var(--bg-light);
}

.entity-card.summary-link:hover {
    background: var(--primary);
    color: white;
    transform: translateY(-2px);
}

.entity-card.summary-link:hover .entity-name,
.entity-card.summary-link:hover .entity-description {
    color: white;
}

.entity-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5rem;
}

.entity-name {
    font-weight: 600;
    font-size: 0.95rem;
    color: var(--text-dark);
}

.entity-badge {
    font-size: 0.7rem;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    background: var(--primary);
    color: white;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 600;
}

/* Victime - Rouge */
.entity-badge.victim,
.entity-badge.victime {
    background: #ef4444;
    color: white;
}

/* Suspect - Orange */
.entity-badge.suspect {
    background: #f59e0b;
    color: #1a1a2e;
}

/* Témoin - Vert */
.entity-badge.witness,
.entity-badge.temoin,
.entity-badge.témoin {
    background: #22c55e;
    color: white;
}

/* Preuve - Violet */
.entity-badge.preuve,
.entity-badge.evidence {
    background: #8b5cf6;
    color: white;
}

/* Lieu - Bleu */
.entity-badge.lieu,
.entity-badge.location {
    background: #3b82f6;
    color: white;
}

/* Objet - Cyan */
.entity-badge.objet,
.entity-badge.object {
    background: #06b6d4;
    color: white;
}

/* Événement - Rose */
.entity-badge.evenement,
.entity-badge.event {
    background: #ec4899;
    color: white;
}

/* Autres / Défaut - Gris */
.entity-badge.autre,
.entity-badge.other {
    background: #6b7280;
    color: white;
}

/* Entity attributes */
.entity-attributes {
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
}

.attr-item {
    font-size: 0.8rem;
    margin-bottom: 0.25rem;
    display: flex;
    gap: 0.5rem;
}

.attr-key {
    color: var(--text-muted);
    font-weight: 500;
    min-width: 80px;
}

.attr-val {
    color: var(--text-dark);
}

/* Entity relations */
.entity-relations {
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
}

.rel-title {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
    text-transform: uppercase;
}

.rel-item {
    font-size: 0.8rem;
    color: var(--primary);
    display: flex;
    align-items: center;
    gap: 0.25rem;
    margin-bottom: 0.25rem;
}

.entity-description {
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-top: 0.5rem;
}

/* Evidence cards */
.evidence-card {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-left: 4px solid var(--primary);
    border-radius: 0 8px 8px 0;
    padding: 1rem;
    margin-bottom: 0.75rem;
}

.evidence-title {
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--text-dark);
    margin-bottom: 0.25rem;
}

.evidence-type {
    font-size: 0.7rem;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-weight: 500;
    text-transform: capitalize;
    display: inline-block;
}

/* Physique - Bleu */
.evidence-type.physique,
.evidence-type.physical {
    background: #3b82f6;
    color: white;
}

/* Testimoniale - Vert */
.evidence-type.testimoniale,
.evidence-type.testimonial {
    background: #22c55e;
    color: white;
}

/* Documentaire - Orange */
.evidence-type.documentaire,
.evidence-type.documentary {
    background: #f59e0b;
    color: #1a1a2e;
}

/* Numérique - Violet */
.evidence-type.numerique,
.evidence-type.numérique,
.evidence-type.digital {
    background: #8b5cf6;
    color: white;
}

/* Forensique - Rouge */
.evidence-type.forensique,
.evidence-type.forensic {
    background: #ef4444;
    color: white;
}

/* Autres / Défaut - Gris */
.evidence-type.autre,
.evidence-type.other {
    background: #6b7280;
    color: white;
}

.evidence-reliability {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.5rem;
    font-size: 0.8rem;
}

.reliability-bar {
    flex: 1;
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
}

.reliability-fill {
    height: 100%;
    background: var(--primary);
    transition: width 0.3s ease;
}

/* Timeline */
.timeline {
    position: relative;
    padding-left: 2rem;
}

.timeline::before {
    content: '';
    position: absolute;
    left: 0.5rem;
    top: 0;
    bottom: 0;
    width: 2px;
    background: var(--border-dark);
}

.timeline-event {
    position: relative;
    padding-bottom: 1rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    margin-bottom: 0.75rem;
    transition: all 0.2s ease;
}

.timeline-event:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(30, 58, 95, 0.1);
}

.timeline-event.expanded {
    border-color: var(--primary);
}

.timeline-event.importance-high {
    border-left: 3px solid #dc2626;
}

.timeline-event::before {
    content: '';
    position: absolute;
    left: -1.65rem;
    top: 1rem;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--primary);
    border: 2px solid var(--bg-white);
    box-shadow: 0 0 0 2px var(--primary);
}

.timeline-event.verified::before {
    background: var(--primary-dark);
    box-shadow: 0 0 0 2px var(--primary-dark);
}

.timeline-event-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1rem;
    cursor: pointer;
}

.timeline-chevron {
    color: var(--text-muted);
    transition: transform 0.2s ease;
}

.timeline-event.expanded .timeline-chevron {
    transform: rotate(180deg);
}

.timeline-event-details {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease, padding 0.3s ease;
    padding: 0 1rem;
}

.timeline-event-details.expanded {
    max-height: 500px;
    padding: 0 1rem 1rem 1rem;
    border-top: 1px solid var(--border);
}

.timeline-entities {
    margin-top: 0.75rem;
    padding: 0.5rem;
    background: var(--bg-subtle);
    border-radius: 6px;
}

.entity-chip {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.25rem 0.5rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 16px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.entity-chip:hover {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.entity-chip:hover .material-icons {
    color: white;
}

.timeline-date {
    font-size: 0.75rem;
    color: var(--text-muted);
    margin-bottom: 0.25rem;
}

.timeline-title {
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--text-dark);
}

.timeline-description {
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-top: 0.25rem;
}

/* ============================================
   Timeline Interactive Améliorée
   ============================================ */

/* Timeline Controls Bar */
.timeline-controls-bar {
    display: flex;
    flex-wrap: wrap;
    gap: 1.5rem;
    padding: 1rem;
    background: var(--bg-subtle);
    border-radius: 8px;
    margin-bottom: 1rem;
    align-items: center;
}

.timeline-controls-group {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.controls-label {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Zoom Buttons */
.timeline-zoom-buttons {
    display: flex;
    gap: 0.25rem;
    background: var(--bg-white);
    border-radius: 6px;
    padding: 0.25rem;
    border: 1px solid var(--border);
}

.timeline-zoom-btn {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.4rem 0.75rem;
    border: none;
    background: transparent;
    border-radius: 4px;
    font-size: 0.8rem;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
}

.timeline-zoom-btn .material-icons {
    font-size: 1rem;
}

.timeline-zoom-btn:hover {
    background: var(--bg-subtle);
    color: var(--text-dark);
}

.timeline-zoom-btn.active {
    background: var(--primary);
    color: white;
}

/* Overlay Toggles */
.timeline-overlay-toggles {
    display: flex;
    gap: 0.75rem;
}

.overlay-toggle {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.4rem 0.75rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 6px;
    font-size: 0.8rem;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
}

.overlay-toggle:has(input:checked) {
    background: var(--primary-light);
    border-color: var(--primary);
    color: white;
}

.overlay-toggle input {
    display: none;
}

.overlay-toggle .material-icons {
    font-size: 1rem;
}

/* Animation Controls */
.timeline-animation-controls {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.speed-control {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.25rem 0.5rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 6px;
}

.speed-control .material-icons {
    color: var(--text-muted);
}

.speed-slider {
    width: 80px;
    height: 4px;
    -webkit-appearance: none;
    appearance: none;
    background: var(--border-dark);
    border-radius: 2px;
    cursor: pointer;
}

.speed-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 14px;
    height: 14px;
    background: var(--primary);
    border-radius: 50%;
    cursor: pointer;
}

/* Timeline Analysis Panel */
.timeline-analysis-panel {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
}

.timeline-analysis-section {
    flex: 1;
    padding: 0.75rem;
    border-radius: 8px;
    background: var(--bg-white);
    border: 1px solid var(--border);
}

.timeline-gaps {
    border-left: 3px solid #f59e0b;
}

.timeline-overlaps {
    border-left: 3px solid #ef4444;
}

.analysis-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.85rem;
}

.timeline-gaps .analysis-header {
    color: #f59e0b;
}

.timeline-overlaps .analysis-header {
    color: #ef4444;
}

.analysis-header .material-icons {
    font-size: 1.1rem;
}

.analysis-items {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
}

.gap-item, .overlap-item {
    display: flex;
    flex-direction: column;
    padding: 0.5rem;
    background: var(--bg-subtle);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.gap-item:hover, .overlap-item:hover {
    background: var(--bg-light);
    transform: translateX(4px);
}

.gap-duration, .overlap-events {
    font-weight: 600;
    font-size: 0.8rem;
    color: var(--text-dark);
}

.gap-period, .overlap-period {
    font-size: 0.75rem;
    color: var(--text-muted);
}

/* Timeline Causal Chains Panel */
.timeline-causal-chains-panel {
    margin-bottom: 1rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-left: 3px solid #f97316;
    border-radius: 8px;
    overflow: hidden;
}

.causal-chains-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    cursor: pointer;
    background: #fff7ed;
    transition: background 0.2s ease;
}

.causal-chains-header:hover {
    background: #ffedd5;
}

.causal-chains-header .material-icons {
    color: #f97316;
}

.causal-chains-header strong {
    color: #c2410c;
    font-size: 0.85rem;
}

.causal-chains-badge {
    margin-left: auto;
    background: #f97316;
    color: white;
    padding: 0.15rem 0.5rem;
    border-radius: 12px;
    font-size: 0.7rem;
    font-weight: 600;
}

.causal-chains-header .expand-icon {
    color: #c2410c;
}

.causal-chains-content {
    padding: 0.75rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    max-height: 300px;
    overflow-y: auto;
}

.timeline-causal-chain {
    padding: 0.75rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid transparent;
}

.timeline-causal-chain:hover {
    background: #fff7ed;
    border-color: #fed7aa;
}

.timeline-causal-chain.linked {
    background: #fef3c7;
    border-color: #fcd34d;
}

.timeline-causal-chain.active {
    background: #ffedd5;
    border-color: #f97316;
    box-shadow: 0 2px 8px rgba(249, 115, 22, 0.2);
}

.timeline-causal-chain .chain-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.timeline-causal-chain .chain-context {
    font-weight: 600;
    font-size: 0.8rem;
    color: #9a3412;
}

.chain-match-rate {
    font-size: 0.7rem;
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
    font-weight: 600;
}

.chain-match-rate.high {
    background: #dcfce7;
    color: #166534;
}

.chain-match-rate.medium {
    background: #fef3c7;
    color: #92400e;
}

.chain-match-rate.low {
    background: #fee2e2;
    color: #991b1b;
}

.chain-steps-flow {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.75rem;
}

.chain-step {
    padding: 0.2rem 0.4rem;
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 4px;
    color: var(--text-dark);
}

.chain-step.matched {
    background: #dcfce7;
    border-color: #86efac;
    color: #166534;
    font-weight: 600;
}

.chain-step.matched.clickable {
    cursor: pointer;
    transition: all 0.2s ease;
}

.chain-step.matched.clickable:hover {
    background: #bbf7d0;
    border-color: #4ade80;
    transform: translateY(-1px);
    box-shadow: 0 2px 6px rgba(34, 197, 94, 0.3);
}

.chain-arrow {
    color: #9a3412;
    font-weight: 600;
}

.chain-matched-events-list {
    margin-top: 0.5rem;
    padding-top: 0.5rem;
    border-top: 1px dashed #e5e7eb;
}

.chain-matched-header {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.7rem;
    color: #059669;
    margin-bottom: 0.35rem;
}

.chain-matched-header .material-icons {
    font-size: 0.85rem;
}

.chain-matched-event-item {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.35rem 0.5rem;
    margin: 0.2rem 0;
    background: #f0fdf4;
    border-radius: 4px;
    font-size: 0.7rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.chain-matched-event-item:hover {
    background: #dcfce7;
    transform: translateX(3px);
}

.chain-matched-event-item .material-icons {
    font-size: 0.75rem;
    color: #22c55e;
}

.matched-step-name {
    color: #166534;
    font-weight: 600;
}

.matched-event-arrow {
    color: #9ca3af;
}

.matched-event-title {
    color: #1e3a5f;
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.chain-matched-events {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    margin-top: 0.5rem;
    font-size: 0.7rem;
    color: #059669;
}

.chain-matched-events .material-icons {
    font-size: 0.85rem;
}

/* Timeline Event Scroll Highlight */
.timeline-event.scroll-highlighted {
    border-color: #3b82f6 !important;
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%) !important;
    box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4) !important;
    animation: scrollHighlightPulse 0.5s ease-out;
}

@keyframes scrollHighlightPulse {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.6);
    }
    50% {
        transform: scale(1.02);
        box-shadow: 0 4px 25px rgba(59, 130, 246, 0.5);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4);
    }
}

/* Timeline Event Chain Highlight */
.timeline-event.chain-highlighted {
    border-color: #f97316 !important;
    background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%) !important;
    box-shadow: 0 2px 12px rgba(249, 115, 22, 0.3) !important;
}

.timeline-event.chain-highlighted::before {
    content: '⛓️';
    position: absolute;
    top: -8px;
    right: -8px;
    font-size: 1rem;
}

/* Timeline Overlays Container */
.timeline-overlays-container {
    margin-bottom: 1rem;
    padding: 1rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
}

/* Overlay Columns Layout */
.overlay-columns {
    display: grid;
    grid-template-columns: repeat(var(--column-count, 3), 1fr);
    gap: 1rem;
}

.overlay-column {
    background: var(--bg-subtle);
    border-radius: 8px;
    overflow: hidden;
}

.overlay-column-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: var(--primary);
    color: white;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.overlay-column-header .material-icons {
    font-size: 1.1rem;
}

.overlay-count {
    margin-left: auto;
    background: rgba(255, 255, 255, 0.2);
    padding: 0.15rem 0.5rem;
    border-radius: 10px;
    font-size: 0.7rem;
}

.overlay-column-content {
    padding: 0.75rem;
    max-height: 300px;
    overflow-y: auto;
}

.overlay-item {
    background: var(--bg-white);
    border-radius: 6px;
    padding: 0.5rem 0.75rem;
    margin-bottom: 0.5rem;
    border-left: 3px solid var(--item-color);
    transition: all 0.2s ease;
}

.overlay-item:last-child {
    margin-bottom: 0;
}

.overlay-item:hover {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transform: translateX(2px);
}

.overlay-item-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.35rem;
}

.overlay-item-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    flex-shrink: 0;
}

.overlay-item-name {
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text-dark);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
}

.overlay-item-badge {
    background: var(--bg-subtle);
    color: var(--text-muted);
    font-size: 0.7rem;
    padding: 0.1rem 0.4rem;
    border-radius: 8px;
    font-weight: 600;
}

.overlay-item-events {
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem;
    padding-left: 1.25rem;
}

.overlay-event-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s ease;
    opacity: 0.7;
}

.overlay-event-dot:hover {
    transform: scale(1.5);
    opacity: 1;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
}

/* Legacy overlay styles (keeping for compatibility) */
.overlay-section {
    margin-bottom: 1rem;
}

.overlay-section:last-child {
    margin-bottom: 0;
}

.overlay-section-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.overlay-section-header .material-icons {
    font-size: 1rem;
}

.overlay-tracks {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.overlay-track {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.35rem 0;
}

.track-label {
    width: 120px;
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text-dark);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    padding-left: 0.5rem;
    border-left: 3px solid var(--track-color);
}

.track-events {
    flex: 1;
    display: flex;
    gap: 0.5rem;
    padding: 0.25rem 0;
    min-height: 20px;
    background: var(--bg-subtle);
    border-radius: 4px;
}

.track-event {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0;
}

.track-event:hover {
    transform: scale(1.5);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

/* Timeline Main Area */
.timeline-main {
    position: relative;
}

/* Timeline Ruler */
.timeline-ruler {
    padding: 0.5rem 0 0.5rem 2rem;
    margin-bottom: 0.5rem;
    border-bottom: 1px solid var(--border);
}

.ruler-track {
    display: flex;
    gap: 2rem;
    overflow-x: auto;
    padding-bottom: 0.25rem;
}

.ruler-mark {
    font-size: 0.7rem;
    color: var(--text-muted);
    white-space: nowrap;
    position: relative;
}

.ruler-mark::before {
    content: '';
    position: absolute;
    left: 0;
    bottom: -0.5rem;
    width: 1px;
    height: 8px;
    background: var(--border-dark);
}

/* Timeline Groups */
.timeline-group {
    margin-bottom: 1.5rem;
}

.timeline-group-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.5rem 1rem;
    background: var(--primary);
    color: white;
    border-radius: 6px;
    margin-bottom: 0.75rem;
}

.group-label {
    font-weight: 600;
    font-size: 0.9rem;
}

.group-count {
    font-size: 0.75rem;
    opacity: 0.8;
}

.timeline-group-events {
    padding-left: 1rem;
}

/* Event Badges */
.timeline-event-badges {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.badge {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border-radius: 50%;
}

.badge .material-icons {
    font-size: 0.9rem;
}

.badge-verified {
    background: rgba(16, 185, 129, 0.1);
    color: #10b981;
}

.badge-high {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
}

/* Event Location in Details */
.event-location {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
}

.event-location .material-icons {
    font-size: 0.9rem;
    color: var(--primary);
}

/* Timeline Event Actions */
.timeline-event-actions {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
}

/* Animation Styles */
@keyframes timelineEventAppear {
    0% {
        opacity: 0;
        transform: translateX(-20px);
    }
    100% {
        opacity: 1;
        transform: translateX(0);
    }
}

.timeline.animating .timeline-event {
    opacity: 0;
}

.timeline-event.animated {
    animation: timelineEventAppear 0.5s ease-out forwards;
    animation-delay: var(--animation-delay);
}

.timeline-event.animation-highlight {
    border-color: var(--primary) !important;
    box-shadow: 0 0 0 3px rgba(30, 58, 95, 0.2), 0 4px 12px rgba(30, 58, 95, 0.15);
}

/* Gap and Overlap Highlights */
@keyframes gapHighlight {
    0%, 100% { border-color: #f59e0b; }
    50% { border-color: transparent; box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.3); }
}

@keyframes overlapHighlight {
    0%, 100% { border-color: #ef4444; }
    50% { border-color: transparent; box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.3); }
}

.timeline-event.gap-highlight {
    animation: gapHighlight 0.5s ease-in-out 6;
    border-color: #f59e0b !important;
}

.timeline-event.overlap-highlight {
    animation: overlapHighlight 0.5s ease-in-out 6;
    border-color: #ef4444 !important;
}

/* Form Row for date inputs */
.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

@media (max-width: 900px) {
    .overlay-columns {
        grid-template-columns: 1fr !important;
    }
}

@media (max-width: 600px) {
    .form-row {
        grid-template-columns: 1fr;
    }

    .timeline-controls-bar {
        flex-direction: column;
        align-items: flex-start;
    }

    .timeline-analysis-panel {
        flex-direction: column;
    }

    .track-label {
        width: 80px;
    }

    .overlay-column-content {
        max-height: 200px;
    }
}

/* Search highlight animation */
@keyframes searchHighlight {
    0% { box-shadow: 0 0 0 0 rgba(30, 58, 95, 0.4); }
    50% { box-shadow: 0 0 0 8px rgba(30, 58, 95, 0.2); }
    100% { box-shadow: 0 0 0 0 rgba(30, 58, 95, 0); }
}

.search-highlight {
    animation: searchHighlight 1s ease-out 2;
    border-color: var(--primary) !important;
}

/* Hypothesis cards */
.hypothesis-card {
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 0.75rem;
}

.hypothesis-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5rem;
}

.hypothesis-title {
    font-weight: 600;
    font-size: 0.95rem;
    color: var(--text-dark);
}

.hypothesis-status {
    font-size: 0.7rem;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    text-transform: uppercase;
}

.hypothesis-status.pending {
    background: var(--bg-subtle);
    color: var(--text-muted);
}

.hypothesis-status.supported {
    background: var(--primary);
    color: white;
}

.hypothesis-status.refuted {
    background: var(--primary-light);
    color: white;
}

.hypothesis-confidence {
    margin-top: 0.75rem;
}

.confidence-label {
    font-size: 0.75rem;
    color: var(--text-muted);
    margin-bottom: 0.25rem;
}

.confidence-bar {
    height: 6px;
    background: var(--border);
    border-radius: 3px;
    overflow: hidden;
}

.confidence-fill {
    height: 100%;
    background: var(--primary);
    transition: width 0.3s ease;
}

.confidence-fill.confidence-high {
    background: #22c55e;
}

.confidence-fill.confidence-medium {
    background: #f59e0b;
}

.confidence-fill.confidence-low {
    background: #ef4444;
}

/* Hypothesis improvements */
.hypothesis-header-actions {
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.hypothesis-card {
    position: relative;
    border-left: 4px solid var(--border);
    transition: all 0.2s ease;
}

.hypothesis-card.status-pending {
    border-left-color: #9ca3af;
}

.hypothesis-card.status-supported {
    border-left-color: #22c55e;
}

.hypothesis-card.status-refuted {
    border-left-color: #ef4444;
}

.hypothesis-card.status-partial {
    border-left-color: #f59e0b;
}

.hypothesis-card.selected-for-compare {
    box-shadow: 0 0 0 2px var(--primary);
}

.hypothesis-card.analyzing {
    opacity: 0.7;
}

.hypothesis-card.highlighted {
    box-shadow: 0 0 0 3px var(--primary), 0 4px 12px rgba(37, 99, 235, 0.3);
    background: linear-gradient(135deg, rgba(37, 99, 235, 0.05) 0%, rgba(255, 255, 255, 1) 100%);
}

@keyframes pulse-highlight {
    0% { box-shadow: 0 0 0 3px var(--primary); }
    50% { box-shadow: 0 0 0 6px rgba(37, 99, 235, 0.4); }
    100% { box-shadow: 0 0 0 3px var(--primary); }
}

.hypothesis-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 0.5rem;
}

.hypothesis-header-left {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.hypothesis-origin-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.2rem;
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
    font-size: 0.65rem;
    font-weight: 600;
    text-transform: uppercase;
}

.hypothesis-origin-badge .material-icons {
    font-size: 0.75rem;
}

.hypothesis-origin-badge.ai {
    background: linear-gradient(135deg, #8b5cf6, #6366f1);
    color: white;
}

.hypothesis-origin-badge.manual {
    background: var(--bg-subtle);
    color: var(--text-muted);
    border: 1px solid var(--border);
}

.hypothesis-status-dropdown {
    flex-shrink: 0;
}

.hypothesis-status-select {
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    border: 1px solid var(--border);
    font-size: 0.75rem;
    cursor: pointer;
    background: white;
}

.hypothesis-status-select.status-pending {
    background: #f3f4f6;
    color: #6b7280;
}

.hypothesis-status-select.status-supported {
    background: #dcfce7;
    color: #166534;
}

.hypothesis-status-select.status-refuted {
    background: #fee2e2;
    color: #991b1b;
}

.hypothesis-status-select.status-partial {
    background: #fef3c7;
    color: #92400e;
}

.hypothesis-description {
    font-size: 0.85rem;
    color: var(--text-muted);
    margin: 0.5rem 0;
    line-height: 1.5;
}

.hypothesis-evidence {
    margin-top: 0.75rem;
    padding: 0.5rem;
    border-radius: 6px;
    font-size: 0.8rem;
}

.hypothesis-evidence.supporting {
    background: #f0fdf4;
    border: 1px solid #bbf7d0;
}

.hypothesis-evidence.contradicting {
    background: #fef2f2;
    border: 1px solid #fecaca;
}

.hypothesis-evidence .evidence-label {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-weight: 600;
    margin-bottom: 0.35rem;
}

.hypothesis-evidence .evidence-label .material-icons {
    font-size: 1rem;
}

.hypothesis-evidence.supporting .evidence-label {
    color: #166534;
}

.hypothesis-evidence.contradicting .evidence-label {
    color: #991b1b;
}

.hypothesis-evidence .evidence-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
}

.hypothesis-evidence .evidence-tag {
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
    font-size: 0.7rem;
}

.hypothesis-evidence .evidence-tag.supporting {
    background: #dcfce7;
    color: #166534;
}

.hypothesis-evidence .evidence-tag.contradicting {
    background: #fee2e2;
    color: #991b1b;
}

.hypothesis-evidence .evidence-tag.clickable {
    cursor: pointer;
    transition: all 0.2s ease;
}

.hypothesis-evidence .evidence-tag.clickable:hover {
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.hypothesis-evidence .evidence-tag.supporting.clickable:hover {
    background: #166534;
    color: white;
}

.hypothesis-evidence .evidence-tag.contradicting.clickable:hover {
    background: #991b1b;
    color: white;
}

/* Hypothesis Causal Chains */
.hypothesis-causal-chains {
    margin-top: 0.75rem;
    padding: 0.75rem;
    background: #fff7ed;
    border: 1px solid #fed7aa;
    border-radius: 6px;
}

.hypothesis-causal-chains .causal-chains-label {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.8rem;
    font-weight: 600;
    color: #c2410c;
    margin-bottom: 0.5rem;
}

.hypothesis-causal-chains .causal-chains-label .material-icons {
    font-size: 1rem;
    color: #f97316;
}

.hypothesis-causal-chains .causal-chains-list {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
}

.hypothesis-chain-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.4rem 0.6rem;
    background: white;
    border: 1px solid #fed7aa;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.hypothesis-chain-item:hover {
    background: #ffedd5;
    border-color: #f97316;
    transform: translateX(4px);
}

.hypothesis-chain-item .chain-relevance {
    font-size: 0.65rem;
    font-weight: 700;
    padding: 0.15rem 0.35rem;
    border-radius: 4px;
    min-width: 32px;
    text-align: center;
}

.hypothesis-chain-item .chain-relevance.high {
    background: #dcfce7;
    color: #166534;
}

.hypothesis-chain-item .chain-relevance.medium {
    background: #fef3c7;
    color: #92400e;
}

.hypothesis-chain-item .chain-preview {
    font-size: 0.75rem;
    color: var(--text-dark);
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Hypothesis Chain Modal */
.hypothesis-chain-modal .chain-modal-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.hypothesis-chain-modal .chain-modal-header .material-icons {
    color: #f97316;
    font-size: 1.5rem;
}

.hypothesis-chain-modal .chain-modal-header h3 {
    margin: 0;
    color: #c2410c;
    font-size: 1.1rem;
}

.hypothesis-chain-modal .chain-visualization {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem;
    background: var(--bg-subtle);
    border-radius: 8px;
    margin-bottom: 1rem;
}

.hypothesis-chain-modal .chain-step-card {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    background: white;
    border: 2px solid #fed7aa;
    border-radius: 8px;
    width: 100%;
    max-width: 350px;
}

.hypothesis-chain-modal .chain-step-card .step-number {
    width: 24px;
    height: 24px;
    background: #f97316;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: 700;
    flex-shrink: 0;
}

.hypothesis-chain-modal .chain-step-card .step-entity {
    flex: 1;
    font-weight: 600;
    color: var(--text-dark);
}

.hypothesis-chain-modal .chain-step-card .step-relation {
    font-size: 0.7rem;
    color: #9a3412;
    background: #ffedd5;
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
}

.hypothesis-chain-modal .chain-connector {
    color: #f97316;
}

.hypothesis-chain-modal .chain-actions {
    display: flex;
    justify-content: center;
}

.hypothesis-questions {
    margin-top: 0.75rem;
    font-size: 0.8rem;
    padding: 0.5rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--primary);
    transition: all 0.2s ease;
}

.hypothesis-questions:hover {
    background: var(--primary);
    color: white;
}

.hypothesis-questions strong {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    color: var(--primary);
    margin-bottom: 0.35rem;
}

.hypothesis-questions strong .material-icons {
    font-size: 1rem;
}

.hypothesis-questions ul {
    margin: 0;
    padding-left: 1.25rem;
}

.hypothesis-questions li {
    margin-bottom: 0.25rem;
    color: var(--text-dark);
}

/* Questions list in modal */
.questions-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.question-item {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 8px;
    transition: all 0.2s ease;
}

.question-item:hover {
    background: var(--bg-subtle);
    border-color: var(--primary);
}

.question-number {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    background: var(--primary);
    color: white;
    border-radius: 50%;
    font-size: 0.75rem;
    font-weight: 600;
    flex-shrink: 0;
}

.question-text {
    flex: 1;
    color: var(--text-dark);
    line-height: 1.5;
}

.hypothesis-actions {
    display: flex;
    gap: 0.25rem;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
    flex-wrap: wrap;
}

.hypothesis-actions .btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
}

.hypothesis-actions .btn .material-icons {
    font-size: 0.9rem;
}

.hypothesis-actions .btn-danger {
    color: #dc2626;
}

.hypothesis-actions .btn-danger:hover {
    background: #fee2e2;
}

/* Analysis loading */
.analysis-loading {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    margin-top: 0.75rem;
    font-size: 0.85rem;
    color: var(--primary);
}

/* Hypothesis filter menu */
#hypothesis-filter-menu {
    display: none;
    position: absolute;
    top: 100%;
    right: 0;
    background: white;
    border: 1px solid var(--border);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 100;
    min-width: 200px;
    padding: 0.5rem;
}

#hypothesis-filter-menu.active {
    display: block;
}

.filter-section {
    padding: 0.5rem 0;
    border-bottom: 1px solid var(--border);
}

.filter-section:last-child {
    border-bottom: none;
}

.filter-section-title {
    font-weight: 600;
    font-size: 0.75rem;
    color: var(--primary);
    text-transform: uppercase;
    margin-bottom: 0.35rem;
    display: block;
}

/* Evidence manager modal */
.evidence-manager {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
}

.evidence-manager .evidence-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
    font-size: 0.95rem;
}

.evidence-manager .evidence-checkboxes {
    max-height: 250px;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 0.5rem;
}

.evidence-manager .evidence-checkbox {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.4rem 0.5rem;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.2s;
    font-size: 0.85rem;
}

.evidence-manager .evidence-checkbox:hover {
    background: var(--bg-subtle);
}

.evidence-manager .evidence-checkbox.selected {
    background: var(--bg-light);
}

.evidence-manager .evidence-checkbox input {
    accent-color: var(--primary);
}

/* Hypothesis comparison */
.hypothesis-comparison {
    display: flex;
    gap: 1rem;
    align-items: stretch;
}

.hypothesis-comparison .comparison-column {
    flex: 1;
    padding: 1rem;
    background: var(--bg-subtle);
    border-radius: 8px;
    border: 1px solid var(--border);
}

.hypothesis-comparison .comparison-column h3 {
    margin: 0 0 0.75rem;
    font-size: 1rem;
    color: var(--primary);
}

.hypothesis-comparison .comparison-status {
    display: inline-block;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.hypothesis-comparison .comparison-status.status-pending {
    background: #f3f4f6;
    color: #6b7280;
}

.hypothesis-comparison .comparison-status.status-supported {
    background: #dcfce7;
    color: #166534;
}

.hypothesis-comparison .comparison-status.status-refuted {
    background: #fee2e2;
    color: #991b1b;
}

.hypothesis-comparison .comparison-status.status-partial {
    background: #fef3c7;
    color: #92400e;
}

.hypothesis-comparison .comparison-confidence {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
}

.hypothesis-comparison .comparison-confidence .confidence-bar {
    flex: 1;
    height: 8px;
}

.hypothesis-comparison .comparison-desc {
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-bottom: 0.75rem;
    line-height: 1.4;
}

.hypothesis-comparison .comparison-evidence {
    font-size: 0.8rem;
    color: var(--text-dark);
}

.hypothesis-comparison .comparison-vs {
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1.25rem;
    color: var(--primary);
    padding: 0 0.5rem;
}

/* Form range slider */
.form-range {
    width: 100%;
    height: 6px;
    background: var(--border);
    border-radius: 3px;
    outline: none;
    -webkit-appearance: none;
}

.form-range::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    background: var(--primary);
    border-radius: 50%;
    cursor: pointer;
}

.form-range::-moz-range-thumb {
    width: 18px;
    height: 18px;
    background: var(--primary);
    border-radius: 50%;
    cursor: pointer;
    border: none;
}

#confidence-value {
    display: inline-block;
    margin-left: 0.5rem;
    font-weight: 600;
    color: var(--primary);
}

/* Modal explanation */
.modal-explanation {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(99, 102, 241, 0.04) 100%);
    border: 1px solid rgba(99, 102, 241, 0.2);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1.25rem;
}

.modal-explanation .material-icons {
    color: var(--primary);
    font-size: 1.5rem;
    flex-shrink: 0;
    margin-top: 0.1rem;
}

.modal-explanation p {
    margin: 0;
    font-size: 0.875rem;
    color: var(--text-secondary);
    line-height: 1.5;
}

.modal-explanation strong {
    font-weight: 600;
}

/* Graph container */
#graph-container {
    width: 100%;
    height: calc(100vh - 280px);
    min-height: 500px;
    background: var(--bg-white);
    border-radius: 8px;
}

/* Graph control buttons */
.graph-buttons-container {
    position: absolute !important;
    bottom: 15px !important;
    left: 15px !important;
    z-index: 9999 !important;
    display: flex !important;
    gap: 0.5rem;
}

.graph-control-btn {
    display: flex !important;
    align-items: center;
    gap: 0.35rem;
    padding: 0.5rem 0.85rem;
    font-size: 0.85rem;
    font-weight: 500;
    background: white !important;
    border: 1px solid #ccc !important;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    cursor: pointer;
    transition: all 0.2s ease;
    color: #1e3a5f;
}

.graph-control-btn .material-icons {
    font-size: 1.1rem;
}

.graph-control-btn:hover {
    background: #1e3a5f !important;
    color: white !important;
    border-color: #1e3a5f !important;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(30, 58, 95, 0.3);
}

/* Fullscreen panel mode */
.fullscreen-panel {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    z-index: 9999 !important;
    margin: 0 !important;
    border-radius: 0 !important;
    background: var(--bg-white) !important;
}

.fullscreen-panel .panel-content {
    display: flex !important;
    flex-direction: row !important;
    height: calc(100vh - 120px) !important;
    overflow: hidden !important;
    gap: 1rem !important;
    padding: 1rem !important;
}

.fullscreen-panel #graph-metadata-container {
    width: 350px !important;
    max-width: 350px !important;
    min-width: 300px !important;
    max-height: 100% !important;
    overflow-y: auto !important;
    flex-shrink: 0 !important;
    margin-bottom: 0 !important;
    background: var(--bg-light);
    border-radius: 8px;
    padding: 0.5rem;
}

.fullscreen-panel #graph-container {
    flex: 1 !important;
    min-height: 0 !important;
    min-width: 0 !important;
    border-radius: 8px;
    border: 1px solid var(--border);
}

.fullscreen-panel .panel-header {
    position: sticky;
    top: 0;
    background: var(--bg-white);
    z-index: 10;
    padding: 1rem;
    border-bottom: 1px solid var(--border);
}

.fullscreen-panel .panel-description {
    display: none !important;
}

body.has-fullscreen-panel {
    overflow: hidden;
}

body.has-fullscreen-panel > *:not(.fullscreen-panel):not(#graph-context-menu):not(#crosscase-context-menu):not(.context-menu):not(.modal):not(#toast-container) {
    visibility: hidden;
}

/* Toast always visible in fullscreen */
body.has-fullscreen-panel #toast-container {
    visibility: visible !important;
    z-index: 100002 !important;
}

/* Ensure context menus and modals are always visible in fullscreen */
.fullscreen-panel .context-menu,
#graph-context-menu,
#crosscase-context-menu {
    z-index: 10001 !important;
    visibility: visible !important;
}

body.has-fullscreen-panel .modal-overlay.active {
    z-index: 10002 !important;
    visibility: visible !important;
    opacity: 1 !important;
}

body.has-fullscreen-panel .fullscreen-panel {
    visibility: visible;
}

/* N4L Fullscreen panel specific rules */
.fullscreen-panel#panel-n4l-graph .panel-content {
    display: flex !important;
    flex-direction: row !important;
    height: calc(100vh - 120px) !important;
    overflow: hidden !important;
    gap: 1rem !important;
    padding: 1rem !important;
}

.fullscreen-panel #n4l-graph-container {
    flex: 1 !important;
    min-height: 0 !important;
    min-width: 0 !important;
    position: relative !important;
    height: 100% !important;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--bg-white);
}

.fullscreen-panel #n4l-metadata-container {
    width: 350px !important;
    max-width: 350px !important;
    min-width: 300px !important;
    max-height: 100% !important;
    overflow-y: auto !important;
    flex-shrink: 0 !important;
    margin-bottom: 0 !important;
    background: var(--bg-light);
    border-radius: 8px;
    padding: 0.5rem;
}

/* N4L View layout */
#view-n4l {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    height: calc(100vh - 180px);
}

#view-n4l .panel {
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

#view-n4l .panel .panel-content {
    flex: 1;
    overflow: hidden;
    padding: 0;
    position: relative;
}

#n4l-graph-container {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--bg-white);
    border-radius: 8px;
}

#view-n4l #n4l-editor {
    width: 100%;
    height: 100%;
    resize: none;
    padding: 0.5rem;
    border: none;
    font-family: monospace;
}

/* Dashboard layout */
#view-dashboard {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 1rem;
    height: calc(100vh - 180px);
}

#view-dashboard .panel {
    height: 100%;
    display: flex;
    flex-direction: column;
}

#view-dashboard .panel .panel-content {
    flex: 1;
    overflow: auto;
}

#view-dashboard .panel:first-child .panel-content {
    padding: 0;
}

/* Dashboard Graph Fullscreen - same layout as N4L */
#view-dashboard .panel.fullscreen-panel .panel-content {
    display: flex !important;
    flex-direction: row !important;
    height: calc(100vh - 120px) !important;
    overflow: hidden !important;
    gap: 1rem !important;
    padding: 1rem !important;
}

#view-dashboard .panel.fullscreen-panel #dashboard-graph-container {
    flex: 1 !important;
    min-height: 0 !important;
    min-width: 0 !important;
    position: relative !important;
    height: 100% !important;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--bg-white);
}

#view-dashboard .panel.fullscreen-panel #dashboard-metadata-container {
    width: 350px !important;
    max-width: 350px !important;
    min-width: 300px !important;
    max-height: 100% !important;
    overflow-y: auto !important;
    flex-shrink: 0 !important;
    background: var(--bg-light);
    border-radius: 8px;
    padding: 0.5rem;
}

#view-dashboard .panel.fullscreen-panel #dashboard-metadata-container .n4l-section {
    margin-bottom: 1rem;
}

/* Graph Fullscreen Sidebar (for old graph - kept for backwards compatibility) */
.graph-fullscreen-sidebar {
    display: none;
    width: 350px !important;
    max-width: 350px !important;
    min-width: 300px !important;
    max-height: 100% !important;
    overflow-y: auto !important;
    flex-shrink: 0 !important;
    background: var(--bg-light);
    border-radius: 8px;
    padding: 0.5rem;
}

.fullscreen-panel .graph-fullscreen-sidebar {
    display: block !important;
}

.graph-fullscreen-sidebar .n4l-section {
    margin-bottom: 1rem;
}

/* Modal */
.modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(26, 26, 46, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
}

.modal-overlay.active {
    opacity: 1;
    visibility: visible;
}

.modal {
    background: var(--bg-white);
    border-radius: 12px;
    width: 90%;
    max-width: 600px;
    max-height: 90vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-shadow: 0 20px 60px rgba(30, 58, 95, 0.2);
    transform: translateY(20px);
    transition: transform 0.2s ease;
}

.modal-overlay.active .modal {
    transform: translateY(0);
}

.modal-header {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--primary);
    color: white;
}

.modal-title {
    font-size: 1.1rem;
    font-weight: 600;
}

.modal-close {
    background: transparent;
    border: none;
    color: white;
    cursor: pointer;
    padding: 0.25rem;
    opacity: 0.7;
    transition: opacity 0.2s;
}

.modal-close:hover {
    opacity: 1;
}

/* Draggable Modal Styles */
.modal .modal-header {
    cursor: grab;
}

.modal .modal-header:active {
    cursor: grabbing;
}

.modal.draggable {
    position: fixed !important;
    margin: 0 !important;
    z-index: 1001;
}

.modal.dragging {
    user-select: none;
    opacity: 0.95;
    box-shadow: 0 25px 80px rgba(30, 58, 95, 0.3);
}

.modal.dragging .modal-header {
    cursor: grabbing;
}

.modal-body {
    flex: 1;
    overflow-y: auto;
    padding: 1.5rem;
}

.modal-footer {
    padding: 1rem 1.5rem;
    border-top: 1px solid var(--border);
    display: flex;
    justify-content: flex-end;
    gap: 0.75rem;
    background: var(--bg-light);
}

/* AI Analysis display */
.ai-analysis {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    max-height: calc(70vh - 120px);
    overflow-y: auto;
    overflow-x: hidden;
    word-wrap: break-word;
    overflow-wrap: break-word;
    white-space: normal;
}

/* Force tout le contenu à ne pas déborder */
.ai-analysis * {
    max-width: 100%;
    word-wrap: break-word;
    overflow-wrap: break-word;
}

.ai-analysis h1, .ai-analysis h2, .ai-analysis h3 {
    color: var(--primary);
    margin-top: 1rem;
    margin-bottom: 0.5rem;
}

.ai-analysis h1 { font-size: 1.25rem; }
.ai-analysis h2 { font-size: 1.1rem; }
.ai-analysis h3 { font-size: 1rem; }
.ai-analysis h4 { font-size: 0.95rem; color: var(--primary-light); }

.ai-analysis p {
    margin-bottom: 0.75rem;
    color: var(--text-dark);
    line-height: 1.6;
}

.ai-analysis ul, .ai-analysis ol {
    margin-left: 1.5rem;
    margin-bottom: 0.75rem;
}

.ai-analysis li {
    margin-bottom: 0.25rem;
    line-height: 1.5;
}

.ai-analysis strong {
    color: var(--primary);
}

.ai-analysis hr {
    border: none;
    border-top: 1px solid var(--border);
    margin: 1rem 0;
}

.ai-analysis blockquote {
    border-left: 3px solid var(--primary);
    padding-left: 1rem;
    margin: 1rem 0;
    color: var(--text-muted);
    font-style: italic;
}

.ai-analysis code {
    background: var(--bg-dark);
    padding: 0.2rem 0.4rem;
    border-radius: 4px;
    font-family: monospace;
    font-size: 0.9em;
}

.ai-analysis pre {
    background: var(--bg-dark);
    padding: 1rem;
    border-radius: 8px;
    overflow-x: auto;
    margin: 1rem 0;
}

.ai-analysis pre code {
    background: none;
    padding: 0;
}

/* Loading state */
.loading {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
}

.loading-analysis {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 3rem 2rem;
    text-align: center;
}

.loading-analysis .spinner {
    width: 48px;
    height: 48px;
    border-width: 4px;
}

.spinner {
    width: 32px;
    height: 32px;
    border: 3px solid var(--border);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Empty state */
.empty-state {
    text-align: center;
    padding: 3rem 2rem;
    color: var(--text-muted);
}

.empty-state-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.empty-state-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
}

.empty-state-description {
    font-size: 0.9rem;
}

/* Tooltips */
.tooltip {
    position: relative;
}

.tooltip::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: var(--primary-dark);
    color: white;
    padding: 0.5rem 0.75rem;
    border-radius: 6px;
    font-size: 0.75rem;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    z-index: 100;
}

.tooltip:hover::after {
    opacity: 1;
    visibility: visible;
}

/* Responsive */
@media (max-width: 1024px) {
    .workspace-content {
        grid-template-columns: 1fr;
    }

    .panel-full {
        grid-column: span 1;
    }
}

@media (max-width: 768px) {
    .sidebar {
        width: 240px;
    }

    .header h1 {
        font-size: 1.25rem;
    }
}

/* AI Assistant Panel */
.ai-assistant {
    position: fixed;
    bottom: 1rem;
    right: 1rem;
    width: 800px;
    max-width: calc(100vw - 2rem);
    background: var(--bg-white);
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(30, 58, 95, 0.2);
    z-index: 1000;
    overflow: hidden;
    transition: all 0.3s ease;
}

.ai-assistant.collapsed .ai-assistant-body {
    display: none;
}

/* AI Assistant Draggable State */
.ai-assistant.dragging {
    transition: none;
    opacity: 0.95;
    box-shadow: 0 8px 30px rgba(30, 58, 95, 0.35);
}

.ai-assistant-header {
    background: var(--primary);
    color: white;
    padding: 0.75rem 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: move;
    user-select: none;
}

#ai-assistant-chevron {
    transition: transform 0.3s ease;
    margin-left: auto;
}

.ai-assistant.collapsed #ai-assistant-chevron {
    transform: rotate(180deg);
}

.ai-assistant-body {
    display: flex;
    flex-direction: column;
    height: 600px;
    max-height: calc(100vh - 150px);
}

.ai-assistant-messages {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.ai-message {
    padding: 0.75rem 1rem;
    border-radius: 8px;
    font-size: 0.9rem;
    line-height: 1.6;
    max-width: 95%;
}

.ai-message-user {
    background: var(--primary);
    color: white;
    align-self: flex-end;
}

.ai-message-bot {
    background: var(--bg-light);
    color: var(--text-dark);
    align-self: flex-start;
    border: 1px solid var(--border);
    max-width: 100%;
}

/* Markdown styling inside AI messages */
.ai-message-bot h1, .ai-message-bot h2, .ai-message-bot h3, .ai-message-bot h4 {
    color: var(--primary);
    margin-top: 0.75rem;
    margin-bottom: 0.5rem;
}

.ai-message-bot h1:first-child, .ai-message-bot h2:first-child, .ai-message-bot h3:first-child {
    margin-top: 0;
}

.ai-message-bot h1 { font-size: 1.2rem; }
.ai-message-bot h2 { font-size: 1.1rem; }
.ai-message-bot h3 { font-size: 1rem; }
.ai-message-bot h4 { font-size: 0.95rem; }

.ai-message-bot p {
    margin-bottom: 0.5rem;
}

.ai-message-bot p:last-child {
    margin-bottom: 0;
}

.ai-message-bot ul, .ai-message-bot ol {
    margin-left: 1.25rem;
    margin-bottom: 0.5rem;
}

.ai-message-bot li {
    margin-bottom: 0.25rem;
}

.ai-message-bot strong {
    color: var(--primary);
    font-weight: 600;
}

.ai-message-bot em {
    font-style: italic;
}

.ai-message-bot table {
    width: 100%;
    border-collapse: collapse;
    margin: 0.75rem 0;
    font-size: 0.85rem;
}

.ai-message-bot table th, .ai-message-bot table td {
    border: 1px solid var(--border);
    padding: 0.5rem;
    text-align: left;
}

.ai-message-bot table th {
    background: var(--bg-subtle);
    font-weight: 600;
    color: var(--primary);
}

.ai-message-bot table tr:nth-child(even) {
    background: var(--bg-light);
}

.ai-message-bot code {
    background: var(--bg-subtle);
    padding: 0.125rem 0.375rem;
    border-radius: 4px;
    font-family: monospace;
    font-size: 0.85em;
}

.ai-message-bot pre {
    background: var(--bg-subtle);
    padding: 0.75rem;
    border-radius: 6px;
    overflow-x: auto;
    margin: 0.5rem 0;
}

.ai-message-bot pre code {
    background: transparent;
    padding: 0;
}

.ai-message-bot blockquote {
    border-left: 3px solid var(--primary);
    padding-left: 1rem;
    margin: 0.5rem 0;
    color: var(--text-muted);
    font-style: italic;
}

.ai-message-bot hr {
    border: none;
    border-top: 1px solid var(--border);
    margin: 0.75rem 0;
}

.ai-assistant-input {
    display: flex;
    gap: 0.5rem;
    padding: 0.75rem;
    border-top: 1px solid var(--border);
    background: var(--bg-light);
}

.ai-assistant-input .form-input {
    flex: 1;
}

/* AI Assistant Suggestions */
.ai-assistant-suggestions {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.5rem;
    padding: 0.75rem;
    background: var(--bg-light);
    border-top: 1px solid var(--border);
}

.ai-suggestions-label {
    grid-column: 1 / -1;
    font-size: 0.75rem;
    color: var(--text-muted);
    font-weight: 500;
    margin-bottom: 0.25rem;
}

.ai-suggestion-btn {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.4rem 0.6rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 16px;
    font-size: 0.7rem;
    color: var(--text-dark);
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: left;
}

.ai-suggestion-btn:hover {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.ai-suggestion-btn .material-icons {
    font-size: 1rem;
    opacity: 0.7;
}

.ai-suggestion-btn:hover .material-icons {
    opacity: 1;
}

/* Entity/Evidence card actions */
.card-actions {
    display: flex;
    gap: 0.25rem;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
}

.card-actions .btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
}

/* Entity actions with multiple buttons */
.entity-actions {
    flex-wrap: wrap;
    justify-content: flex-start;
}

.entity-actions .btn:hover {
    background: var(--primary-light);
    color: var(--primary);
}

/* Analysis loading state */
.analysis-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2rem;
    color: var(--text-muted);
}

.analysis-loading .material-icons {
    font-size: 3rem;
    color: var(--primary);
    margin-bottom: 1rem;
}

.spinning {
    animation: spin 1.5s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* SSTorytime Report */
.sstorytime-report-content {
    max-height: 70vh;
    overflow-y: auto;
    padding: 0.5rem;
}

.sstorytime-report .report-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem;
    background: linear-gradient(135deg, #1e3a5f, #2c5282) !important;
    color: #ffffff !important;
    border-radius: 8px;
    margin-bottom: 1rem;
}

.sstorytime-report .report-header span {
    color: #ffffff !important;
}

.sstorytime-report .report-header .material-icons {
    font-size: 1.5rem;
    color: #ffffff !important;
}

.sstorytime-report .report-date {
    margin-left: auto;
    font-size: 0.85rem;
    opacity: 0.9;
    color: #ffffff !important;
}

.sstorytime-report .report-body {
    line-height: 1.7;
    color: var(--text-dark);
}

.sstorytime-report .report-body h2 {
    color: var(--primary);
    border-bottom: 2px solid var(--primary);
    padding-bottom: 0.5rem;
    margin-top: 1.5rem;
    margin-bottom: 1rem;
}

.sstorytime-report .report-body h3 {
    color: var(--secondary);
    margin-top: 1.25rem;
    margin-bottom: 0.75rem;
}

.sstorytime-report .report-body h4 {
    color: var(--text-dark);
    margin-top: 1rem;
    margin-bottom: 0.5rem;
}

.sstorytime-report .report-body ul {
    margin: 0.5rem 0;
    padding-left: 1.5rem;
}

.sstorytime-report .report-body li {
    margin-bottom: 0.25rem;
}

.sstorytime-report .report-body strong {
    color: var(--primary);
}

.report-data-section,
.report-ai-section {
    margin-bottom: 1.5rem;
}

.report-data-section h4,
.report-ai-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--primary);
    margin-bottom: 0.75rem;
    font-size: 1rem;
}

.report-data-section h4 .material-icons,
.report-ai-section h4 .material-icons {
    font-size: 1.2rem;
}

.report-stats-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.75rem;
}

.report-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0.75rem;
    background: #f8fafc;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
}

.report-stat .stat-value {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--primary);
}

.report-stat .stat-label {
    font-size: 0.75rem;
    color: var(--text-muted);
    margin-top: 0.25rem;
}

.report-stat.success {
    background: #ecfdf5;
    border-color: #10b981;
}

.report-stat.success .stat-value {
    color: #10b981;
}

.report-stat.warning {
    background: #fef3c7;
    border-color: #f59e0b;
}

.report-stat.warning .stat-value {
    color: #f59e0b;
}

/* Report Sections */
.report-section {
    background: #ffffff;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.report-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--primary);
    margin: 0 0 0.5rem 0;
    font-size: 1rem;
}

.report-section h4 .material-icons {
    font-size: 1.2rem;
}

.report-section .section-desc {
    color: var(--text-muted);
    font-size: 0.85rem;
    margin: 0 0 0.75rem 0;
    line-height: 1.4;
}

.report-section ul {
    margin: 0;
    padding-left: 1.25rem;
}

.report-section li {
    margin-bottom: 0.35rem;
    color: var(--text-dark);
}

/* No data message */
.no-data {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem;
    background: #f8fafc;
    border-radius: 6px;
    color: var(--text-muted);
    font-size: 0.85rem;
    font-style: italic;
    margin: 0;
}

.no-data .material-icons {
    font-size: 1rem;
    color: #64748b;
}

/* Analysis result blocks */
.analysis-result {
    background: #f8fafc;
    border-radius: 6px;
    padding: 0.75rem;
}

.result-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 0.5rem;
    font-size: 0.85rem;
    color: var(--text-dark);
}

/* Collision points (Contrawave) */
.collision-points {
    margin-top: 0.5rem;
    font-size: 0.9rem;
}

.collision-point {
    display: inline-block;
    background: var(--primary);
    color: white;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    margin: 0.25rem 0.25rem 0 0;
    font-size: 0.8rem;
}

/* Dirac notation display */
.dirac-query-display {
    text-align: center;
    margin-bottom: 0.75rem;
}

.dirac-notation {
    font-family: 'Courier New', monospace;
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--secondary);
    background: #e0f2fe;
    padding: 0.5rem 1rem;
    border-radius: 6px;
}

/* Path items */
.path-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 4px;
    margin-top: 0.5rem;
    font-size: 0.85rem;
}

.path-item .material-icons {
    font-size: 1rem;
    color: var(--primary);
}

/* Orbit summary */
.orbit-summary {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.orbit-level-item {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 4px;
    padding: 0.35rem 0.5rem;
    font-size: 0.8rem;
}

.level-badge {
    background: #f97316;
    color: white;
    padding: 0.15rem 0.35rem;
    border-radius: 3px;
    font-weight: 600;
    font-size: 0.7rem;
}

/* Super node groups */
.super-node-group {
    background: #fef3c7;
    border: 1px solid #fbbf24;
    border-radius: 4px;
    padding: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.85rem;
}

/* STType stats and details */
.sttype-stats {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 0.5rem;
}

.sttype-stats span {
    font-size: 0.9rem;
}

.sttype-detail {
    margin-top: 0.5rem;
    padding-top: 0.5rem;
    border-top: 1px dashed #e2e8f0;
    font-size: 0.85rem;
    color: var(--text-dark);
}

.loading-indicator {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 3rem;
    color: var(--text-muted);
    gap: 1rem;
}

.loading-indicator .material-icons {
    font-size: 2.5rem;
    color: var(--primary);
}

.error-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    text-align: center;
    gap: 1rem;
}

.error-state .material-icons {
    font-size: 3rem;
    color: var(--danger);
}

/* Entity analysis result */
.entity-analysis-result {
    max-height: 60vh;
    overflow-y: auto;
}

.entity-analysis-result .analysis-header {
    display: flex;
    gap: 0.5rem;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--border);
}

.entity-analysis-result .entity-type {
    color: var(--text-muted);
    font-size: 0.85rem;
}

.entity-analysis-result .analysis-content {
    line-height: 1.6;
}

.entity-analysis-result .analysis-content p {
    margin-bottom: 0.5rem;
}

.entity-analysis-result .analysis-point {
    font-weight: 500;
    color: var(--primary);
    margin-top: 1rem;
}

.entity-analysis-result .analysis-bullet {
    padding-left: 1rem;
    color: var(--text-dark);
}

.entity-analysis-result .analysis-meta {
    margin-top: 1rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
    color: var(--text-muted);
    font-size: 0.8rem;
}

/* Error state */
.error-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2rem;
    text-align: center;
}

.error-state .material-icons {
    font-size: 3rem;
    color: var(--danger);
    margin-bottom: 1rem;
}

.error-state .hint {
    color: var(--text-muted);
    font-size: 0.85rem;
    margin-top: 0.5rem;
}

/* Entity timeline modal */
.entity-timeline-modal .timeline-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--border);
}

.entity-timeline-list {
    max-height: 50vh;
    overflow-y: auto;
}

.entity-timeline-event {
    display: flex;
    gap: 1rem;
    padding: 0.75rem;
    border-radius: 8px;
    margin-bottom: 0.5rem;
    background: var(--bg-light);
    border-left: 3px solid var(--primary);
}

.entity-timeline-event.high {
    border-left-color: var(--danger);
    background: #fef2f2;
}

.entity-timeline-event.medium {
    border-left-color: var(--warning);
}

.entity-timeline-event.low {
    border-left-color: var(--text-muted);
}

.entity-timeline-event .event-time {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 70px;
    font-size: 0.8rem;
}

.entity-timeline-event .event-date {
    font-weight: 600;
    color: var(--text-dark);
}

.entity-timeline-event .event-hour {
    color: var(--primary);
    font-weight: 500;
}

.entity-timeline-event .event-content {
    flex: 1;
}

.entity-timeline-event .event-title {
    font-weight: 500;
    color: var(--text-dark);
    margin-bottom: 0.25rem;
}

.entity-timeline-event .event-location {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.8rem;
    color: var(--text-muted);
}

.entity-timeline-event .event-location .material-icons {
    font-size: 0.9rem;
}

.entity-timeline-event .event-desc {
    font-size: 0.85rem;
    color: var(--text-dark);
    margin-top: 0.25rem;
}

.entity-timeline-event.clickable {
    cursor: pointer;
    transition: all 0.2s ease;
}

.entity-timeline-event.clickable:hover {
    background: #eff6ff;
    border-left-color: #3b82f6;
    transform: translateX(4px);
}

.entity-timeline-event .event-goto {
    display: flex;
    align-items: center;
    color: #9ca3af;
    transition: all 0.2s ease;
}

.entity-timeline-event.clickable:hover .event-goto {
    color: #3b82f6;
}

.entity-timeline-event .event-goto .material-icons {
    font-size: 1.2rem;
}

/* Entity comparison checkbox */
.entity-compare-checkbox {
    position: relative;
    display: inline-flex;
    align-items: center;
    cursor: pointer;
    margin-right: 0.5rem;
}

.entity-compare-checkbox input {
    opacity: 0;
    width: 0;
    height: 0;
    position: absolute;
}

.entity-compare-checkbox .checkmark {
    width: 18px;
    height: 18px;
    border: 2px solid var(--border);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

.entity-compare-checkbox input:checked + .checkmark {
    background: var(--primary);
    border-color: var(--primary);
}

.entity-compare-checkbox input:checked + .checkmark::after {
    content: '✓';
    color: white;
    font-size: 12px;
    font-weight: bold;
}

.entity-compare-checkbox:hover .checkmark {
    border-color: var(--primary);
}

.entity-card.selected-for-compare {
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
}

/* Compare entities button */
.btn-warning {
    background: var(--warning);
    color: white;
}

.btn-warning:hover {
    background: #d97706;
}

.btn-accent {
    background: linear-gradient(135deg, #8b5cf6, #6366f1);
    color: white;
}

.btn-accent:hover {
    background: linear-gradient(135deg, #7c3aed, #4f46e5);
}

/* Dropdown component */
.dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    right: 0;
    z-index: 100;
    min-width: 220px;
    padding: 0.5rem 0;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    display: none;
    animation: dropdownFadeIn 0.15s ease-out;
}

@keyframes dropdownFadeIn {
    from {
        opacity: 0;
        transform: translateY(-5px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.dropdown:hover .dropdown-menu,
.dropdown.open .dropdown-menu {
    display: block;
}

.dropdown-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    color: var(--text-dark);
    text-decoration: none;
    cursor: pointer;
    font-size: 0.85rem;
    transition: background-color 0.15s;
}

.dropdown-item:hover {
    background: var(--bg-subtle);
}

.dropdown-item .material-icons {
    font-size: 1rem;
    color: var(--primary-color);
}

/* Entity comparison modal */
.entity-comparison-modal {
    max-height: 70vh;
    overflow-y: auto;
}

.compare-entities-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.compare-entity-col {
    background: var(--bg-light);
    border-radius: 8px;
    padding: 1rem;
    border: 1px solid var(--border);
}

.compare-entity-header {
    text-align: center;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--border);
}

.compare-entity-header h4 {
    margin: 0.5rem 0 0.25rem;
    color: var(--text-dark);
}

.compare-entity-header .entity-type {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.compare-entity-details .description {
    font-size: 0.85rem;
    color: var(--text-dark);
    margin-bottom: 0.75rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px dashed var(--border);
}

.compare-attrs {
    margin-bottom: 0.75rem;
}

.compare-attrs .attr {
    font-size: 0.8rem;
    color: var(--text-dark);
    margin-bottom: 0.25rem;
}

.compare-relations,
.compare-events {
    margin-top: 0.75rem;
}

.compare-relations h5,
.compare-events h5 {
    font-size: 0.8rem;
    color: var(--primary);
    margin-bottom: 0.5rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.compare-relations .rel,
.compare-events .event {
    font-size: 0.8rem;
    color: var(--text-dark);
    padding: 0.25rem 0;
    border-bottom: 1px dotted var(--border);
}

.compare-common-section {
    background: #f0fdf4;
    border: 1px solid #86efac;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.compare-common-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #166534;
    margin-bottom: 1rem;
}

.compare-common-section h4 .material-icons {
    font-size: 1.2rem;
}

.common-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.common-item h5 {
    font-size: 0.8rem;
    color: #166534;
    margin-bottom: 0.5rem;
}

.common-connection,
.common-event {
    font-size: 0.85rem;
    color: var(--text-dark);
    padding: 0.25rem 0.5rem;
    background: white;
    border-radius: 4px;
    margin-bottom: 0.25rem;
}

.common-event .event-date {
    font-weight: 600;
    color: var(--primary);
    margin-right: 0.5rem;
}

.compare-actions {
    display: flex;
    justify-content: center;
    padding-top: 1rem;
    border-top: 1px solid var(--border);
}

.compare-actions .btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.empty {
    font-size: 0.8rem;
    color: var(--text-muted);
    font-style: italic;
}

/* Markdown rendering in analysis */
.analysis-content .md-h1 {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--primary);
    margin: 1.5rem 0 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid var(--primary);
}

.analysis-content .md-h2 {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text-dark);
    margin: 1.25rem 0 0.75rem;
    padding-bottom: 0.25rem;
    border-bottom: 1px solid var(--border);
}

.analysis-content .md-h3 {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-dark);
    margin: 1rem 0 0.5rem;
}

.analysis-content .md-h4,
.analysis-content .md-h5,
.analysis-content .md-h6 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-dark);
    margin: 0.75rem 0 0.5rem;
}

.analysis-content .md-hr {
    border: none;
    border-top: 1px solid var(--border);
    margin: 1rem 0;
}

.analysis-content .md-list {
    margin: 0.5rem 0;
    padding-left: 1.5rem;
}

.analysis-content .md-list li {
    margin-bottom: 0.35rem;
    line-height: 1.5;
}

.analysis-content .md-code {
    background: var(--bg-light);
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 0.85em;
    color: var(--danger);
}

.analysis-content .md-table-wrapper {
    overflow-x: auto;
    margin: 1rem 0;
}

.analysis-content .md-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.85rem;
}

.analysis-content .md-table th,
.analysis-content .md-table td {
    border: 1px solid var(--border);
    padding: 0.5rem 0.75rem;
    text-align: left;
    vertical-align: top;
}

.analysis-content .md-table th {
    background: var(--primary);
    color: white;
    font-weight: 600;
}

.analysis-content .md-table tr:nth-child(even) {
    background: var(--bg-light);
}

.analysis-content .md-table tr:hover {
    background: rgba(59, 130, 246, 0.1);
}

.analysis-content strong {
    font-weight: 600;
    color: var(--text-dark);
}

.analysis-content em {
    font-style: italic;
}

.analysis-content p {
    margin-bottom: 0.5rem;
    line-height: 1.6;
}

/* Filter dropdown */
.filter-dropdown {
    position: relative;
    display: inline-block;
}

.filter-menu {
    position: absolute;
    top: 100%;
    right: 0;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    padding: 0.5rem;
    min-width: 180px;
    z-index: 100;
    display: none;
}

.filter-menu.active {
    display: block;
}

.filter-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    cursor: pointer;
    border-radius: 4px;
    font-size: 0.875rem;
}

.filter-item:hover {
    background: var(--bg-subtle);
}

.filter-item input[type="checkbox"] {
    accent-color: var(--primary);
    width: 16px;
    height: 16px;
    cursor: pointer;
}

.filter-item.filter-all {
    font-weight: 600;
    color: var(--primary);
}

.filter-divider {
    height: 1px;
    background: var(--border);
    margin: 0.25rem 0;
}

/* Confirmation dialog styles */
.confirm-dialog {
    text-align: center;
    padding: 1rem 0;
}

.confirm-dialog .material-icons {
    font-size: 3rem;
    color: var(--primary);
    margin-bottom: 1rem;
}

.confirm-dialog p {
    margin-bottom: 0.5rem;
}

/* Evidence card improvements */
.evidence-card {
    position: relative;
}

.evidence-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5rem;
}

.evidence-header-left {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.evidence-type-icon {
    border-radius: 8px;
    color: #070429;
    align-items: center;
    justify-content: center;
}

.evidence-type-icon .material-icons {
    font-size: 1.25rem;
}

.evidence-header-info {
    display: flex;
    flex-direction: column;
}

.evidence-location {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-top: 0.5rem;
}

.evidence-location .material-icons {
    font-size: 0.9rem;
}

.evidence-description {
    font-size: 0.85rem;
    color: var(--text-dark);
    margin: 0.5rem 0;
    line-height: 1.5;
}

.evidence-linked-entities {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
    margin-top: 0.5rem;
    padding-top: 0.5rem;
    border-top: 1px dashed var(--border);
}

.evidence-linked-entities .entity-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.2rem 0.5rem;
    background: var(--bg-subtle);
    border-radius: 12px;
    font-size: 0.75rem;
    color: var(--primary);
    border: 1px solid var(--border);
}

.evidence-linked-entities .entity-tag .material-icons {
    font-size: 0.85rem;
}

/* Reliability color classes */
.evidence-card.reliability-high {
    border-left-color: #22c55e;
}

.evidence-card.reliability-medium {
    border-left-color: #f59e0b;
}

.evidence-card.reliability-low {
    border-left-color: #ef4444;
}

.reliability-badge {
    font-size: 0.7rem;
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
    font-weight: 600;
}

.reliability-badge.high {
    background: #dcfce7;
    color: #166534;
}

.reliability-badge.medium {
    background: #fef3c7;
    color: #92400e;
}

.reliability-badge.low {
    background: #fee2e2;
    color: #991b1b;
}

/* Evidence actions */
.evidence-actions {
    display: flex;
    gap: 0.25rem;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
    flex-wrap: wrap;
}

.evidence-actions .btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
}

.evidence-actions .btn .material-icons {
    font-size: 0.9rem;
}

.evidence-actions .btn-danger {
    color: #dc2626;
}

.evidence-actions .btn-danger:hover {
    background: #fee2e2;
}

/* Evidence links modal */
.evidence-links-modal .links-section {
    margin-bottom: 1.5rem;
}

.evidence-links-modal .links-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--primary);
    margin-bottom: 0.75rem;
    font-size: 0.95rem;
}

.evidence-links-modal .links-section h4 .material-icons {
    font-size: 1.1rem;
}

.evidence-links-modal .link-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: var(--bg-light);
    border-radius: 6px;
    margin-bottom: 0.5rem;
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.2s;
}

.evidence-links-modal .link-item:hover {
    background: var(--primary);
    color: white;
}

.evidence-links-modal .link-item .material-icons {
    font-size: 1rem;
    color: var(--primary);
}

.evidence-links-modal .link-item:hover .material-icons {
    color: white;
}

.evidence-links-modal .no-links {
    color: var(--text-muted);
    font-size: 0.85rem;
    font-style: italic;
    padding: 0.5rem;
}

/* Evidence filter dropdown */
.evidence-filter-container {
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.evidence-filter-btn {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.evidence-filter-btn.active {
    background: var(--primary);
    color: white;
}

/* Edit evidence modal form */
.edit-evidence-form .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.edit-evidence-form .entity-checkboxes {
    max-height: 150px;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 0.5rem;
}

.edit-evidence-form .entity-checkbox {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.35rem 0.5rem;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.2s;
}

.edit-evidence-form .entity-checkbox:hover {
    background: var(--bg-subtle);
}

.edit-evidence-form .entity-checkbox input {
    accent-color: var(--primary);
}

.edit-evidence-form .entity-checkbox label {
    cursor: pointer;
    font-size: 0.85rem;
}

/* Graph focus/blur styles */
.graph-reset-btn {
    opacity: 0.8;
    transition: all 0.2s ease;
}

.graph-reset-btn:hover {
    opacity: 1;
    background: var(--primary);
    color: white;
}

/* Node focus info panel */
.graph-info-panel {
    position: absolute;
    top: 10px;
    left: 10px;
    background: white;
    padding: 0.75rem 1rem;
    border-radius: 8px;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
    font-size: 0.85rem;
    max-width: 250px;
    z-index: 10;
}

.graph-info-panel h4 {
    margin: 0 0 0.5rem;
    color: var(--primary);
    font-size: 0.95rem;
}

.graph-info-panel .connections {
    color: var(--text-muted);
    font-size: 0.8rem;
}

.graph-info-panel .connection-item {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    margin-top: 0.25rem;
    padding: 0.25rem 0;
    border-bottom: 1px dotted var(--border);
}

.graph-info-panel .connection-item:last-child {
    border-bottom: none;
}

/* Print styles */
@media print {
    .header, .sidebar, .main-nav, .ai-assistant {
        display: none;
    }

    .workspace {
        margin: 0;
        padding: 1rem;
    }
}

/* =====================================================
   Cross-Case Analysis (Connexions Inter-Affaires)
   ===================================================== */

/* Stats summary */
.cross-case-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 1rem;
}

.cross-case-stat {
    background: var(--bg-subtle);
    padding: 1rem;
    border-radius: 8px;
    text-align: center;
    border: 1px solid var(--border);
}

.cross-case-stat .stat-value {
    display: block;
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--primary);
}

.cross-case-stat .stat-label {
    display: block;
    font-size: 0.75rem;
    color: var(--text-muted);
    margin-top: 0.25rem;
}

/* No results state */
.cross-case-no-results {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    text-align: center;
    color: var(--text-muted);
}

.cross-case-no-results .material-icons {
    font-size: 3rem;
    color: #22c55e;
    margin-bottom: 1rem;
}

/* Match cards */
.cross-case-match {
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 0.75rem;
    cursor: pointer;
    transition: all 0.2s;
}

.cross-case-match:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(30, 58, 95, 0.1);
}

.match-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
}

.match-type-icon {
    color: var(--primary);
    font-size: 1.25rem;
}

.match-type-label {
    font-weight: 600;
    color: var(--text-dark);
    flex: 1;
}

.match-confidence {
    font-size: 0.75rem;
    font-weight: 600;
    color: white;
    padding: 0.2rem 0.5rem;
    border-radius: 12px;
}

.match-description {
    font-size: 0.9rem;
    color: var(--text-muted);
    margin-bottom: 0.75rem;
}

.match-cases {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8rem;
}

.match-case {
    padding: 0.25rem 0.5rem;
    background: var(--bg-subtle);
    border-radius: 4px;
}

.match-case.current {
    background: var(--primary);
    color: white;
}

.match-case.other {
    background: #6366f1;
    color: white;
}

.match-cases .material-icons {
    font-size: 1rem;
    color: var(--text-muted);
}

/* Confidence bar visual */
.match-confidence-bar {
    width: 100%;
    height: 4px;
    background: var(--bg-subtle);
    border-radius: 2px;
    margin-top: 0.5rem;
    overflow: hidden;
}

.match-confidence-bar .bar-fill {
    height: 100%;
    border-radius: 2px;
    transition: width 0.3s ease;
}

.match-confidence-bar .bar-fill.high { background: #10b981; }
.match-confidence-bar .bar-fill.medium { background: #f59e0b; }
.match-confidence-bar .bar-fill.low { background: #ef4444; }

/* Match quick actions */
.match-actions {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
}

.match-actions .match-action-btn {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.35rem 0.6rem;
    font-size: 0.75rem;
    background: var(--bg-subtle);
    border: 1px solid var(--border);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s;
    color: var(--text-dark);
}

.match-actions .match-action-btn:hover {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.match-actions .match-action-btn .material-icons {
    font-size: 14px;
}

/* New badge */
.match-badge-new {
    display: inline-flex;
    align-items: center;
    padding: 0.15rem 0.4rem;
    font-size: 0.65rem;
    font-weight: 600;
    text-transform: uppercase;
    background: #10b981;
    color: white;
    border-radius: 3px;
    margin-left: 0.5rem;
    animation: pulse-new 2s infinite;
}

@keyframes pulse-new {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

/* Grouped matches */
.match-group {
    margin-bottom: 1rem;
}

.match-group-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: var(--primary);
    color: white;
    border-radius: 8px 8px 0 0;
    cursor: pointer;
    transition: background 0.2s;
}

.match-group-header:hover {
    background: var(--primary-dark);
}

.match-group-header .material-icons {
    font-size: 1.25rem;
}

.match-group-header .group-case-name {
    flex: 1;
    font-weight: 600;
}

.match-group-header .group-count {
    background: rgba(255,255,255,0.2);
    padding: 0.2rem 0.5rem;
    border-radius: 12px;
    font-size: 0.8rem;
}

.match-group-header .group-toggle {
    transition: transform 0.2s;
}

.match-group-header.collapsed .group-toggle {
    transform: rotate(-90deg);
}

.match-group-content {
    border: 1px solid var(--border);
    border-top: none;
    border-radius: 0 0 8px 8px;
    padding: 0.5rem;
    background: var(--bg-light);
}

.match-group-content.collapsed {
    display: none;
}

.match-group-content .cross-case-match {
    margin-bottom: 0.5rem;
}

.match-group-content .cross-case-match:last-child {
    margin-bottom: 0;
}

/* Export dropdown */
#export-matches-dropdown {
    position: relative;
}

#export-matches-dropdown .dropdown-menu {
    position: absolute;
    top: 100%;
    right: 0;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    min-width: 150px;
    display: none;
    z-index: 100;
}

#export-matches-dropdown.open .dropdown-menu {
    display: block;
}

#export-matches-dropdown .dropdown-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.6rem 0.75rem;
    cursor: pointer;
    font-size: 0.85rem;
    color: var(--text-dark);
    transition: background 0.2s;
}

#export-matches-dropdown .dropdown-item:hover {
    background: var(--bg-subtle);
}

#export-matches-dropdown .dropdown-item .material-icons {
    font-size: 18px;
    color: var(--primary);
}

/* Group button active state */
#btn-group-matches.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

/* Alert cards */
.cross-case-alert {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 1rem;
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: 8px;
    margin-bottom: 0.5rem;
}

.cross-case-alert .material-icons {
    color: #f59e0b;
    font-size: 1.25rem;
    flex-shrink: 0;
}

.cross-case-alert p {
    margin: 0;
    font-size: 0.9rem;
    color: #92400e;
}

/* Compact alert cards */
.cross-case-alert.cross-case-alert-compact {
    padding: 0.5rem 0.75rem;
    margin-bottom: 0.35rem;
    border-radius: 6px;
}

.cross-case-alert.cross-case-alert-compact .material-icons {
    font-size: 1rem;
}

.cross-case-alert.cross-case-alert-compact span:not(.material-icons) {
    font-size: 0.8rem;
    color: #92400e;
}

/* Details modal */
.cross-case-detail {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.cross-case-detail .detail-section {
    padding: 1rem;
    background: var(--bg-subtle);
    border-radius: 8px;
}

.cross-case-detail .detail-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.5rem;
    font-size: 0.9rem;
    color: var(--primary);
}

.cross-case-detail .detail-section h4 .material-icons {
    font-size: 1.1rem;
}

.cross-case-detail .detail-section p {
    margin: 0.25rem 0;
    font-size: 0.85rem;
}

/* Confidence bar */
.confidence-bar {
    position: relative;
    height: 24px;
    background: var(--border);
    border-radius: 12px;
    overflow: hidden;
}

.confidence-bar .confidence-fill {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: var(--confidence);
    background: linear-gradient(90deg, #22c55e, #16a34a);
    border-radius: 12px;
    transition: width 0.5s ease;
}

.confidence-bar span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-weight: 600;
    font-size: 0.75rem;
    color: var(--text-dark);
    z-index: 1;
}

/* Detail row */
.detail-row {
    display: flex;
    gap: 0.5rem;
    padding: 0.35rem 0;
    border-bottom: 1px dotted var(--border);
    font-size: 0.85rem;
}

.detail-row:last-child {
    border-bottom: none;
}

.detail-key {
    font-weight: 500;
    color: var(--text-muted);
    min-width: 100px;
}

.detail-value {
    color: var(--text-dark);
}

/* Spinning animation for loading states */
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.spinning {
    animation: spin 1s linear infinite;
}

/* Cross-case graph container */
#cross-case-graph-container {
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    flex: 1;
    min-height: 500px;
    height: 100%;
    position: relative;
}

/* Cross-case node popup */
.crosscase-node-popup {
    position: absolute;
    background: white;
    border: 1px solid var(--border);
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    min-width: 280px;
    max-width: 400px;
    max-height: 350px;
    z-index: 1000;
    overflow: hidden;
}

.crosscase-node-popup .popup-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: var(--primary);
    color: white;
}

.crosscase-node-popup .popup-header .material-icons {
    font-size: 1.2rem;
}

.crosscase-node-popup .popup-header strong {
    flex: 1;
    font-size: 0.9rem;
}

.crosscase-node-popup .popup-close {
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    padding: 0;
    display: flex;
    opacity: 0.8;
}

.crosscase-node-popup .popup-close:hover {
    opacity: 1;
}

.crosscase-node-popup .popup-close .material-icons {
    font-size: 1.1rem;
}

.crosscase-node-popup .popup-content {
    padding: 0.75rem 1rem;
    max-height: 280px;
    overflow-y: auto;
}

.crosscase-node-popup .popup-stats {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    background: var(--bg-light);
    border-radius: 6px;
    margin-bottom: 0.75rem;
    font-size: 0.85rem;
    color: var(--text-dark);
}

.crosscase-node-popup .popup-stats .material-icons {
    font-size: 1rem;
    color: var(--primary);
}

.crosscase-node-popup .popup-relations-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.crosscase-node-popup .popup-relation-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    font-size: 0.8rem;
}

.crosscase-node-popup .relation-icon {
    font-size: 1rem;
    color: var(--primary);
}

.crosscase-node-popup .relation-label {
    color: var(--text-muted);
    font-style: italic;
}

.crosscase-node-popup .relation-target {
    flex: 1;
    text-align: right;
    font-weight: 500;
    color: var(--text-dark);
}

.crosscase-node-popup .no-relations {
    color: var(--text-muted);
    font-size: 0.85rem;
    text-align: center;
    padding: 1rem;
}

/* Le 3ème panel (graphe) doit prendre toute la hauteur */
#view-cross-case .panel:nth-child(3) .panel-content {
    display: flex;
    flex-direction: column;
    padding: 0.5rem;
}

/* Filter container */
.cross-case-filter-container {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.cross-case-filter-container .form-select {
    font-size: 0.85rem;
    padding: 0.4rem 0.75rem;
}

/* Cross-Case View Layout - 2 colonnes */
#view-cross-case {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr;
    gap: 1rem;
    height: calc(100vh - 180px);
    overflow: hidden;
    padding-bottom: 1rem;
}

#view-cross-case .panel {
    display: flex;
    flex-direction: column;
    min-height: 0;
    overflow: hidden;
}

/* Premier panel (Connexions Inter-Affaires) */
#view-cross-case .panel:nth-child(1) {
    max-height: 255px;
}

/* Deuxième panel (Correspondances) - prend toute la hauteur restante */
#view-cross-case .panel:nth-child(2) {
    grid-row: span 2;
}

/* Section Suggestions IA intégrée - hauteur limitée */
#cross-case-alerts {
    max-height: 200px;
    overflow-y: auto;
    padding: 0.5rem !important;
}

#cross-case-alerts .alert-item {
    padding: 0.4rem 0.6rem;
    margin-bottom: 0.3rem;
    font-size: 0.8rem;
}

/* Troisième panel (Graphe) - remplit l'espace restant */
#view-cross-case .panel:nth-child(3) {
    flex: 1;
}

#view-cross-case .panel .panel-header {
    flex-shrink: 0;
    flex-wrap: wrap;
    min-height: auto;
}

#view-cross-case .panel .panel-description {
    flex-shrink: 0;
}

#view-cross-case .panel .panel-content {
    flex: 1;
    overflow-y: auto;
    min-height: 0;
}

/* Contrôles du panel Correspondances - une seule ligne horizontale */
#view-cross-case .cross-case-filter-container {
    flex-wrap: nowrap;
    gap: 0.25rem;
    flex-shrink: 0;
}

#view-cross-case .cross-case-filter-container .form-select,
#view-cross-case .cross-case-filter-container .form-input {
    font-size: 0.75rem;
    padding: 0.25rem 0.4rem;
    height: 28px;
}

#view-cross-case .cross-case-filter-container #cross-case-search {
    width: 90px;
    min-width: 90px;
}

#view-cross-case .cross-case-filter-container #cross-case-filter {
    min-width: 100px;
    width: auto;
}

#view-cross-case .cross-case-filter-container #cross-case-sort {
    min-width: 90px;
    width: auto;
}

#view-cross-case .cross-case-filter-container .btn-sm {
    padding: 0.2rem 0.4rem;
    height: 28px;
    min-width: 28px;
}

#view-cross-case .cross-case-filter-container .dropdown {
    flex-shrink: 0;
}

/* Responsive - Cross-Case View */
@media (max-width: 1200px) {
    #view-cross-case {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto 1fr;
    }

    #view-cross-case .panel:nth-child(1) {
        max-height: 200px;
    }

    #view-cross-case .panel:nth-child(2) {
        grid-row: span 1;
        max-height: 400px;
    }

    #view-cross-case .panel:nth-child(3) {
        min-height: 400px;
    }
}

/* Cross-case Graph - Statistics bar */
.crosscase-stats {
    display: flex;
    gap: 1rem;
    padding: 0.75rem 1rem;
    background: var(--bg-subtle);
    border-bottom: 1px solid var(--border);
    flex-wrap: wrap;
}

.crosscase-stats .stat-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: var(--bg-white);
    border-radius: 6px;
    border: 1px solid var(--border);
    font-size: 0.85rem;
}

.crosscase-stats .stat-item .material-icons {
    font-size: 1.1rem;
    color: var(--primary);
}

.crosscase-stats .stat-item .stat-value {
    font-weight: 700;
    color: var(--text-dark);
}

.crosscase-stats .stat-item .stat-label {
    color: var(--text-muted);
    font-size: 0.75rem;
}

/* Cross-case Graph - Filters bar */
.crosscase-filters {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.5rem 1rem;
    background: var(--bg-white);
    border-bottom: 1px solid var(--border);
    flex-wrap: wrap;
}

.crosscase-filters .filter-label {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-muted);
}

.crosscase-filters .filter-checkbox {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    font-size: 0.85rem;
    cursor: pointer;
    padding: 0.35rem 0.6rem;
    border-radius: 4px;
    transition: background 0.2s;
}

.crosscase-filters .filter-checkbox:hover {
    background: var(--bg-subtle);
}

.crosscase-filters .filter-checkbox input {
    margin: 0;
}

.crosscase-filters .filter-icon {
    width: 12px;
    height: 12px;
    border-radius: 3px;
}

/* Cross-case Graph - Legend (only visible in fullscreen) */
.crosscase-legend {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.75rem;
    font-size: 0.75rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    z-index: 10;
    max-width: 180px;
    display: none !important;
}

/* Show legend only in fullscreen mode */
.fullscreen-panel .crosscase-legend {
    display: block !important;
}

.crosscase-legend .legend-title {
    font-weight: 700;
    font-size: 0.8rem;
    margin-bottom: 0.5rem;
    color: var(--text-dark);
    border-bottom: 1px solid var(--border);
    padding-bottom: 0.25rem;
}

.crosscase-legend .legend-section {
    margin-bottom: 0.5rem;
}

.crosscase-legend .legend-section:last-child {
    margin-bottom: 0;
}

.crosscase-legend .legend-subtitle {
    font-weight: 600;
    font-size: 0.7rem;
    color: var(--text-muted);
    margin-bottom: 0.25rem;
    text-transform: uppercase;
}

.crosscase-legend .legend-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.15rem 0;
    color: var(--text-dark);
}

.crosscase-legend .legend-node {
    width: 14px;
    height: 14px;
    border-radius: 3px;
    border: 2px solid;
    flex-shrink: 0;
}

.crosscase-legend .legend-edge {
    width: 20px;
    height: 3px;
    border-radius: 2px;
    flex-shrink: 0;
}

/* =====================================================
   HRM (Hypothetical Reasoning Model) View
   ===================================================== */

/* HRM Status indicator */
.hrm-status {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8rem;
}

.status-indicator {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    display: inline-block;
}

.status-indicator.status-online {
    background: #22c55e;
    box-shadow: 0 0 6px #22c55e;
}

.status-indicator.status-offline {
    background: #ef4444;
}

.status-indicator.status-checking {
    background: #f59e0b;
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
}

/* HRM Question Form */
.hrm-question-form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.hrm-question-form .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

@media (max-width: 768px) {
    .hrm-question-form .form-row {
        grid-template-columns: 1fr;
    }
}

/* HRM Hypothesis List */
.hrm-hypothesis-item {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    margin-bottom: 0.75rem;
    transition: all 0.2s;
}

.hrm-hypothesis-item:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(30, 58, 95, 0.1);
}

.hrm-hypothesis-item .hypothesis-info {
    flex: 1;
}

.hrm-hypothesis-item .hypothesis-title {
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.25rem;
}

.hrm-hypothesis-item .hypothesis-desc {
    font-size: 0.85rem;
    color: var(--text-muted);
}

.hrm-hypothesis-item .hypothesis-confidence {
    font-size: 0.75rem;
    padding: 0.2rem 0.5rem;
    border-radius: 12px;
    font-weight: 600;
}

.hrm-hypothesis-item .hypothesis-confidence.high {
    background: #dcfce7;
    color: #166534;
}

.hrm-hypothesis-item .hypothesis-confidence.medium {
    background: #fef3c7;
    color: #92400e;
}

.hrm-hypothesis-item .hypothesis-confidence.low {
    background: #fee2e2;
    color: #991b1b;
}

.hrm-hypothesis-item .btn-verify {
    white-space: nowrap;
}

/* HRM Results */
.hrm-result-card {
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1.25rem;
    margin-bottom: 1rem;
}

.hrm-result-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--border);
}

.hrm-result-header h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0;
    color: var(--primary);
}

.hrm-result-header h4 .material-icons {
    font-size: 1.25rem;
}

.hrm-confidence-badge {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.85rem;
    font-weight: 600;
}

.hrm-confidence-badge .confidence-value {
    padding: 0.25rem 0.5rem;
    border-radius: 12px;
}

.hrm-confidence-badge .confidence-value.high {
    background: #dcfce7;
    color: #166534;
}

.hrm-confidence-badge .confidence-value.medium {
    background: #fef3c7;
    color: #92400e;
}

.hrm-confidence-badge .confidence-value.low {
    background: #fee2e2;
    color: #991b1b;
}

.hrm-conclusion {
    font-size: 1rem;
    line-height: 1.6;
    color: var(--text-dark);
    margin-bottom: 1rem;
    padding: 1rem;
    background: var(--bg-subtle);
    border-radius: 8px;
    border-left: 4px solid var(--primary);
}

/* Reasoning Chain */
.hrm-reasoning-chain {
    margin-top: 1rem;
}

.hrm-reasoning-chain h5 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    color: var(--text-dark);
    margin-bottom: 0.75rem;
}

.hrm-reasoning-chain h5 .material-icons {
    font-size: 1rem;
    color: var(--primary);
}

.reasoning-step {
    display: flex;
    gap: 1rem;
    padding: 0.75rem 1rem;
    background: var(--bg-light);
    border-radius: 8px;
    margin-bottom: 0.5rem;
    border-left: 3px solid var(--primary);
}

.reasoning-step .step-number {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    background: var(--primary);
    color: white;
    border-radius: 50%;
    font-size: 0.8rem;
    font-weight: 600;
    flex-shrink: 0;
}

.reasoning-step .step-content {
    flex: 1;
}

.reasoning-step .step-premise {
    font-weight: 500;
    color: var(--text-dark);
    margin-bottom: 0.25rem;
}

.reasoning-step .step-inference {
    font-size: 0.85rem;
    color: var(--text-muted);
}

.reasoning-step .step-confidence {
    font-size: 0.75rem;
    color: var(--text-muted);
    margin-top: 0.25rem;
}

/* HRM Warnings */
.hrm-warnings {
    margin-top: 1rem;
    padding: 0.75rem 1rem;
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: 8px;
}

.hrm-warnings h5 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.85rem;
    color: #92400e;
    margin: 0 0 0.5rem;
}

.hrm-warnings h5 .material-icons {
    font-size: 1rem;
}

.hrm-warnings ul {
    margin: 0;
    padding-left: 1.25rem;
    font-size: 0.85rem;
    color: #92400e;
}

/* HRM Contradictions */
.hrm-contradiction-card {
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 0.75rem;
}

.hrm-contradiction-card.severity-critical {
    border-left: 4px solid #dc2626;
    background: #fef2f2;
}

.hrm-contradiction-card.severity-high {
    border-left: 4px solid #f97316;
    background: #fff7ed;
}

.hrm-contradiction-card.severity-medium {
    border-left: 4px solid #f59e0b;
    background: #fffbeb;
}

.hrm-contradiction-card.severity-low {
    border-left: 4px solid #6b7280;
}

.contradiction-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 0.5rem;
}

.contradiction-severity {
    font-size: 0.7rem;
    font-weight: 600;
    padding: 0.2rem 0.5rem;
    border-radius: 12px;
    text-transform: uppercase;
}

.contradiction-severity.critical {
    background: #dc2626;
    color: white;
}

.contradiction-severity.high {
    background: #f97316;
    color: white;
}

.contradiction-severity.medium {
    background: #f59e0b;
    color: white;
}

.contradiction-severity.low {
    background: #6b7280;
    color: white;
}

.contradiction-description {
    font-size: 0.9rem;
    color: var(--text-dark);
    margin-bottom: 0.75rem;
}

.contradiction-statements {
    font-size: 0.85rem;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
}

.contradiction-elements-list {
    margin: 0.5rem 0 0 0;
    padding-left: 0;
    list-style: none;
}

.contradiction-elements-list li {
    padding: 0.5rem 0.75rem;
    margin-bottom: 0.5rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    border-left: 3px solid var(--primary);
    font-size: 0.85rem;
    line-height: 1.4;
}

.contradiction-elements-list li:last-child {
    margin-bottom: 0;
}

.contradiction-suggestions {
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px dashed var(--border);
}

.contradiction-suggestions h6 {
    font-size: 0.8rem;
    color: var(--primary);
    margin: 0 0 0.5rem;
}

.contradiction-suggestions ul {
    margin: 0;
    padding-left: 1.25rem;
    font-size: 0.8rem;
    color: var(--text-dark);
}

/* HRM Consistency Score */
.hrm-consistency-score {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--bg-subtle);
    border-radius: 8px;
    margin-bottom: 1rem;
}

.consistency-bar {
    flex: 1;
    height: 12px;
    background: var(--border);
    border-radius: 6px;
    overflow: hidden;
}

.consistency-fill {
    height: 100%;
    border-radius: 6px;
    transition: width 0.5s ease;
}

.consistency-fill.high {
    background: linear-gradient(90deg, #22c55e, #16a34a);
}

.consistency-fill.medium {
    background: linear-gradient(90deg, #f59e0b, #d97706);
}

.consistency-fill.low {
    background: linear-gradient(90deg, #ef4444, #dc2626);
}

.consistency-value {
    font-weight: 700;
    font-size: 1.1rem;
    min-width: 50px;
    text-align: right;
}

.consistency-value.high {
    color: #16a34a;
}

.consistency-value.medium {
    color: #d97706;
}

.consistency-value.low {
    color: #dc2626;
}

/* HRM Verification Result */
.hrm-verification-result {
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 0.75rem;
}

.hrm-verification-result.supported {
    background: #f0fdf4;
    border: 1px solid #86efac;
}

.hrm-verification-result.not-supported {
    background: #fef2f2;
    border: 1px solid #fecaca;
}

.verification-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.75rem;
}

.verification-icon {
    font-size: 1.5rem;
}

.verification-icon.supported {
    color: #22c55e;
}

.verification-icon.not-supported {
    color: #ef4444;
}

.verification-title {
    flex: 1;
}

.verification-title h4 {
    margin: 0;
    font-size: 1rem;
    color: var(--text-dark);
}

.verification-title .hypothesis-statement {
    font-size: 0.85rem;
    color: var(--text-muted);
}

.verification-details {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.verification-section h5 {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin: 0 0 0.5rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.verification-section ul {
    margin: 0;
    padding-left: 1.25rem;
    font-size: 0.85rem;
}

.verification-section.supporting ul li {
    color: #166534;
}

.verification-section.contradicting ul li {
    color: #991b1b;
}

.verification-recommendation {
    margin-top: 1rem;
    padding: 0.75rem 1rem;
    background: var(--bg-white);
    border-radius: 6px;
    font-size: 0.9rem;
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
}

.verification-recommendation .material-icons {
    color: #eab308;
    font-size: 1.1rem;
    flex-shrink: 0;
}

.verification-recommendation strong {
    color: var(--primary);
}

/* Confidence Update Section - HRM */
.confidence-update-section {
    margin: 1rem 0;
    padding: 1rem;
    background: var(--bg-white);
    border-radius: 8px;
    border: 1px solid var(--border);
}

.confidence-comparison {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1.5rem;
    margin-bottom: 1rem;
}

.confidence-old, .confidence-new {
    text-align: center;
    padding: 0.75rem 1rem;
    border-radius: 8px;
    min-width: 120px;
}

.confidence-old {
    background: var(--bg-subtle);
}

.confidence-new {
    background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
    border: 1px solid #86efac;
}

.confidence-old .label, .confidence-new .label {
    display: block;
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted);
    margin-bottom: 0.25rem;
}

.confidence-old .value, .confidence-new .value {
    display: block;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-dark);
}

.confidence-new .value.high { color: #22c55e; }
.confidence-new .value.medium { color: #eab308; }
.confidence-new .value.low { color: #ef4444; }

.confidence-old .explanation, .confidence-new .explanation {
    display: block;
    font-size: 0.65rem;
    color: var(--text-light);
    margin-top: 0.25rem;
}

.confidence-arrow {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
}

.confidence-arrow .material-icons {
    font-size: 1.5rem;
}

.confidence-arrow .material-icons.positive { color: #22c55e; }
.confidence-arrow .material-icons.negative { color: #ef4444; }
.confidence-arrow .material-icons.neutral { color: var(--text-muted); }

.confidence-arrow .diff {
    font-size: 0.85rem;
    font-weight: 600;
}

.confidence-arrow .diff.positive { color: #22c55e; }
.confidence-arrow .diff.negative { color: #ef4444; }
.confidence-arrow .diff.neutral { color: var(--text-muted); }

.confidence-explanation {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    padding: 0.75rem;
    background: #f0f9ff;
    border-radius: 6px;
    border-left: 3px solid #3b82f6;
}

.confidence-explanation .material-icons {
    color: #3b82f6;
    font-size: 1rem;
    flex-shrink: 0;
    margin-top: 0.1rem;
}

.confidence-explanation p {
    margin: 0;
    font-size: 0.8rem;
    color: var(--text-muted);
    line-height: 1.4;
}

.verification-section h5 {
    display: flex;
    align-items: center;
    gap: 0.35rem;
}

.verification-section h5 .material-icons {
    font-size: 1rem;
}

.verification-section.supporting h5 .material-icons { color: #22c55e; }
.verification-section.contradicting h5 .material-icons { color: #ef4444; }
.verification-section.missing h5 .material-icons { color: #eab308; }

/* HRM View Layout - 2 columns */
#view-hrm {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
    gap: 1rem;
    height: calc(100vh - 180px);
    overflow: hidden;
    padding-bottom: 1rem;
}

#view-hrm .panel {
    display: flex;
    flex-direction: column;
    min-height: 0;
    height: 100%;
    overflow: hidden;
}

#view-hrm .panel .panel-header {
    flex-shrink: 0;
}

#view-hrm .panel .panel-description {
    flex-shrink: 0;
}

#view-hrm .panel .panel-content {
    flex: 1;
    overflow-y: auto;
    min-height: 0;
}

/* Assurer que les panels de vérification et résultats ont la même structure */
#view-hrm .panel:nth-child(2),
#view-hrm .panel:nth-child(4) {
    /* Vérification d'Hypothèses et Résultats du Raisonnement */
}

#view-hrm #hrm-verification-results {
    flex-shrink: 0;
    max-height: 40%;
    overflow-y: auto;
}

@media (max-width: 1024px) {
    #view-hrm {
        grid-template-columns: 1fr;
        grid-template-rows: auto;
        height: auto;
        overflow-y: auto;
    }

    #view-hrm .panel {
        min-height: 300px;
        max-height: 450px;
    }

    #view-hrm .panel .panel-content {
        max-height: 300px;
    }
}

/* Context Menu for Graph */
.context-menu {
    position: fixed;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    min-width: 200px;
    z-index: 1000;
    padding: 0.5rem 0;
    animation: contextMenuFadeIn 0.15s ease-out;
}

@keyframes contextMenuFadeIn {
    from {
        opacity: 0;
        transform: scale(0.95);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

.context-menu-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.6rem 1rem;
    color: var(--text-dark);
    text-decoration: none;
    cursor: pointer;
    transition: background-color 0.15s;
    font-size: 0.875rem;
}

.context-menu-item:hover {
    background-color: var(--bg-subtle);
}

.context-menu-item .material-icons {
    font-size: 1.1rem;
    color: var(--primary);
}

.context-menu-divider {
    height: 1px;
    background: var(--border);
    margin: 0.5rem 0;
}

.context-menu-header {
    display: block;
    padding: 0.4rem 1rem;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--primary-color);
    background: linear-gradient(90deg, var(--bg-subtle), transparent);
}

/* Expansion Cone Styles */
.cone-node {
    border: 3px solid var(--primary) !important;
}

.cone-peripheral {
    opacity: 0.4;
}

/* Path highlight styles */
.path-highlight {
    border: 3px solid #f59e0b !important;
    box-shadow: 0 0 10px rgba(245, 158, 11, 0.5);
}

/* Paths list container */
.paths-list {
    max-height: 300px;
    overflow-y: auto;
}

.path-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.75rem;
    border: 1px solid var(--border);
    border-radius: 6px;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: all 0.2s;
}

.path-item:hover {
    background: var(--bg-subtle);
    border-color: var(--primary);
}

.path-item.active {
    background: var(--bg-subtle);
    border-color: var(--primary);
    border-width: 2px;
}

.path-nodes {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    flex-wrap: wrap;
    font-size: 0.85rem;
}

.path-nodes .path-arrow {
    color: var(--text-muted);
}

.path-actions {
    display: flex;
    gap: 0.25rem;
}

/* Cone depth selector */
.cone-depth-selector {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.cone-depth-selector label {
    font-weight: 500;
    color: var(--text-dark);
}

.cone-depth-selector select {
    padding: 0.4rem 0.75rem;
    border: 1px solid var(--border);
    border-radius: 4px;
    font-size: 0.875rem;
}

/* =============================================
   Inference Panel Styles
   ============================================= */

.inference-panel {
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 400px;
    max-height: 80vh;
    background: var(--bg-white);
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(30, 58, 95, 0.15);
    z-index: 1000;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: box-shadow 0.2s ease;
}

.inference-panel.dragging {
    transition: none;
    box-shadow: 0 8px 30px rgba(30, 58, 95, 0.35);
    opacity: 0.95;
}

.inference-panel-header {
    background: var(--primary);
    color: white;
    padding: 0.875rem 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: move;
}

.inference-panel-header h3 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.95rem;
    font-weight: 600;
    margin: 0;
}

.inference-panel-header .material-icons {
    font-size: 1.1rem;
}

.inference-panel-header .btn-ghost {
    color: white;
}

.inference-panel-actions {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--border);
    background: var(--bg-light);
}

.inference-list {
    flex: 1;
    overflow-y: auto;
    padding: 0.75rem;
    max-height: 400px;
}

.inference-empty {
    text-align: center;
    padding: 2rem 1rem;
    color: var(--text-muted);
}

.inference-empty .material-icons {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    opacity: 0.5;
}

.inference-empty p {
    font-size: 0.85rem;
}

.inference-panel-footer {
    padding: 0.75rem 1rem;
    border-top: 1px solid var(--border);
    background: var(--bg-light);
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.8rem;
    color: var(--text-muted);
}

.inference-count-badge {
    background: var(--primary);
    color: white;
    padding: 0.15rem 0.5rem;
    border-radius: 10px;
    font-weight: 600;
    font-size: 0.75rem;
}

/* Inference Item */
.inference-item {
    padding: 0.875rem;
    border-radius: 8px;
    border: 1px solid var(--border);
    margin-bottom: 0.5rem;
    background: var(--bg-white);
}

.inference-item.type-transitive {
    border-left: 3px solid #3b82f6;
}

.inference-item.type-sibling {
    border-left: 3px solid #22c55e;
}

.inference-item.type-orphan {
    border-left: 3px solid #f59e0b;
}

.inference-item.type-ai {
    border-left: 3px solid #8b5cf6;
}

.inference-item-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.inference-type-badge {
    font-size: 0.7rem;
    padding: 0.15rem 0.5rem;
    border-radius: 10px;
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.inference-type-badge .material-icons {
    font-size: 0.75rem;
}

.inference-type-badge.transitive {
    background: #dbeafe;
    color: #1d4ed8;
}

.inference-type-badge.sibling {
    background: #dcfce7;
    color: #15803d;
}

.inference-type-badge.orphan {
    background: #fef3c7;
    color: #b45309;
}

.inference-type-badge.ai {
    background: #ede9fe;
    color: #6d28d9;
}

.inference-confidence {
    font-size: 0.75rem;
    color: var(--text-muted);
}

.inference-relation {
    font-size: 0.9rem;
    font-weight: 500;
    margin-bottom: 0.35rem;
}

.inference-relation .from-node,
.inference-relation .to-node {
    color: var(--primary);
}

.inference-relation .arrow {
    color: var(--text-muted);
    margin: 0 0.25rem;
}

.inference-reason {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
}

.inference-actions {
    display: flex;
    gap: 0.35rem;
}

.inference-actions .btn {
    padding: 0.3rem 0.6rem;
    font-size: 0.75rem;
}

/* Inference Explanation Styles */
.inference-explanation {
    margin-top: 0.75rem;
    padding: 1rem;
    background: linear-gradient(135deg, #f0f4f8 0%, #e8f0f8 100%);
    border-radius: 8px;
    border-left: 4px solid var(--primary);
    font-size: 0.8rem;
    line-height: 1.5;
}

.inference-explanation .explanation-content h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--primary);
    margin-bottom: 0.75rem;
    font-size: 0.95rem;
}

.inference-explanation .explanation-content h4 .material-icons {
    font-size: 1.1rem;
}

.inference-explanation .explanation-content p {
    margin-bottom: 0.5rem;
    color: var(--text-dark);
}

.inference-explanation .explanation-content ul {
    margin: 0.5rem 0 0.75rem 1.25rem;
    color: var(--text-muted);
}

.inference-explanation .explanation-content li {
    margin-bottom: 0.25rem;
}

.inference-explanation .explanation-chain {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.75rem;
    background: white;
    border-radius: 6px;
    margin: 0.75rem 0;
    flex-wrap: wrap;
}

.inference-explanation .chain-node {
    background: var(--primary);
    color: white;
    padding: 0.35rem 0.75rem;
    border-radius: 4px;
    font-weight: 500;
    font-size: 0.8rem;
}

.inference-explanation .chain-via {
    background: #8b5cf6;
    color: white;
    padding: 0.35rem 0.75rem;
    border-radius: 4px;
    font-weight: 500;
    font-size: 0.75rem;
}

.inference-explanation .chain-arrow {
    color: var(--primary);
    font-weight: bold;
    font-size: 1rem;
}

/* =============================================
   Entity Details Modal Styles
   ============================================= */

.entity-details-modal {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.entity-details-modal .entity-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border);
}

.entity-details-modal .entity-icon {
    font-size: 2.5rem;
    color: var(--primary);
    background: var(--bg-light);
    padding: 0.75rem;
    border-radius: 12px;
}

.entity-details-modal .entity-info h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.25rem;
    color: var(--text-dark);
}

.entity-details-modal .entity-meta {
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.entity-details-modal .entity-type {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.entity-details-modal .detail-section {
    background: var(--bg-light);
    border-radius: 8px;
    padding: 1rem;
}

.entity-details-modal .detail-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.75rem 0;
    font-size: 0.9rem;
    color: var(--primary);
}

.entity-details-modal .detail-section h4 .material-icons {
    font-size: 1.1rem;
}

.entity-details-modal .detail-section p {
    margin: 0;
    color: var(--text-dark);
    line-height: 1.5;
}

.entity-details-modal .detail-row {
    display: flex;
    gap: 0.5rem;
    padding: 0.35rem 0;
    border-bottom: 1px solid var(--border);
}

.entity-details-modal .detail-row:last-child {
    border-bottom: none;
}

.entity-details-modal .detail-label {
    font-weight: 500;
    color: var(--text-muted);
    min-width: 100px;
}

.entity-details-modal .detail-value {
    color: var(--text-dark);
}

.entity-details-modal .relation-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    background: var(--bg-white);
    border-radius: 6px;
    margin-bottom: 0.35rem;
    cursor: pointer;
    transition: all 0.2s;
}

.entity-details-modal .relation-item:hover {
    background: var(--primary);
    color: white;
}

.entity-details-modal .relation-item:hover .material-icons,
.entity-details-modal .relation-item:hover .relation-type,
.entity-details-modal .relation-item:hover .relation-target {
    color: white;
}

.entity-details-modal .relation-item .material-icons {
    font-size: 1rem;
    color: var(--primary);
}

.entity-details-modal .relation-type {
    font-size: 0.8rem;
    color: var(--text-muted);
    background: var(--bg-light);
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
}

.entity-details-modal .relation-target {
    font-weight: 500;
    color: var(--text-dark);
}

.entity-details-modal .link-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    background: var(--bg-white);
    border-radius: 6px;
    margin-bottom: 0.35rem;
    cursor: pointer;
    transition: all 0.2s;
}

.entity-details-modal .link-item:hover {
    background: var(--primary);
    color: white;
}

.entity-details-modal .link-item:hover .material-icons,
.entity-details-modal .link-item:hover .badge {
    color: white;
}

.entity-details-modal .link-item .material-icons {
    font-size: 1rem;
    color: var(--primary);
}

.entity-details-modal .link-item .badge {
    margin-left: auto;
    font-size: 0.7rem;
    background: var(--bg-light);
    color: var(--text-muted);
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
}

.entity-details-modal .modal-actions {
    display: flex;
    gap: 0.75rem;
    margin-top: 0.5rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border);
}

.entity-details-modal .modal-actions .btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.entity-details-modal .empty {
    color: var(--text-muted);
    font-style: italic;
    font-size: 0.85rem;
    padding: 0.5rem;
}

/* =============================================
   Search Panel Styles
   ============================================= */

.search-panel {
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 520px;
    max-height: 80vh;
    background: var(--bg-white);
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(30, 58, 95, 0.15);
    z-index: 1000;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: box-shadow 0.2s ease;
}

.search-panel.dragging {
    transition: none;
    box-shadow: 0 8px 30px rgba(30, 58, 95, 0.35);
    opacity: 0.95;
}

.search-panel-header {
    background: var(--primary);
    color: white;
    padding: 0.875rem 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: move;
}

.search-panel-header h3 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.95rem;
    font-weight: 600;
    margin: 0;
}

.search-panel-header .material-icons {
    font-size: 1.1rem;
}

.search-panel-header .btn-ghost {
    color: white;
}

.search-panel-content {
    padding: 1rem;
    overflow-y: auto;
    max-height: 400px;
}

.search-filter-section {
    margin-bottom: 1rem;
}

.search-filter-section:last-child {
    margin-bottom: 0;
}

.search-filter-section label {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
}

.search-filter-section label .material-icons {
    font-size: 1rem;
    color: var(--text-muted);
}

.filter-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem;
}

.filter-tag {
    padding: 0.35rem 0.75rem;
    border-radius: 20px;
    border: 1px solid var(--border);
    background: var(--bg-light);
    color: var(--text-dark);
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.filter-tag:hover {
    background: var(--bg-subtle);
}

.filter-tag.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.excluded-nodes-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem;
    min-height: 32px;
    padding: 0.5rem;
    background: var(--bg-light);
    border-radius: 6px;
    border: 1px dashed var(--border);
}

.excluded-node-tag {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.2rem 0.5rem;
    background: #fee2e2;
    color: #b91c1c;
    border-radius: 4px;
    font-size: 0.75rem;
}

.excluded-node-tag button {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
    display: flex;
    color: #b91c1c;
}

.excluded-node-tag button:hover {
    color: #7f1d1d;
}

.excluded-node-tag .material-icons {
    font-size: 0.85rem;
}

.search-hint {
    font-size: 0.75rem;
    color: var(--text-muted);
    margin-top: 0.35rem;
    font-style: italic;
}

.search-panel-actions {
    padding: 0.75rem 1rem;
    border-top: 1px solid var(--border);
    background: var(--bg-light);
    display: flex;
    gap: 0.5rem;
}

.search-panel-actions .btn {
    flex: 1;
}

.search-results {
    padding: 0.75rem 1rem;
    border-top: 1px solid var(--border);
    max-height: 150px;
    overflow-y: auto;
}

.search-results-summary {
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
}

.search-results-summary strong {
    color: var(--primary);
}

.search-results-nodes {
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem;
}

.search-result-node {
    padding: 0.2rem 0.5rem;
    background: var(--bg-subtle);
    border-radius: 4px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: background 0.2s ease;
}

.search-result-node:hover {
    background: var(--primary);
    color: white;
}

/* File Upload Zone */
.file-upload-zone {
    border: 2px dashed var(--border-dark);
    border-radius: 8px;
    padding: 1.5rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
    background: var(--bg-light);
}

.file-upload-zone:hover {
    border-color: var(--primary);
    background: var(--bg-subtle);
}

.file-upload-zone.drag-over {
    border-color: var(--primary);
    background: rgba(30, 58, 95, 0.08);
    border-style: solid;
}

.file-upload-zone.processing {
    opacity: 0.7;
    pointer-events: none;
}

.file-upload-zone .material-icons {
    font-size: 2.5rem;
    color: var(--primary);
    margin-bottom: 0.5rem;
}

.file-upload-zone p {
    margin: 0.25rem 0;
    color: var(--text-dark);
    font-size: 0.9rem;
}

.file-upload-zone .file-upload-hint {
    font-size: 0.8rem;
    color: var(--text-muted);
    font-style: italic;
}

.file-upload-status {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    border-radius: 6px;
    margin-top: 0.75rem;
    font-size: 0.875rem;
}

.file-upload-status .material-icons {
    font-size: 1.25rem;
}

.file-upload-status.loading {
    background: rgba(30, 58, 95, 0.08);
    color: var(--primary);
    border: 1px solid rgba(30, 58, 95, 0.2);
}

.file-upload-status.success {
    background: rgba(34, 197, 94, 0.1);
    color: #15803d;
    border: 1px solid rgba(34, 197, 94, 0.3);
}

.file-upload-status.error {
    background: rgba(239, 68, 68, 0.1);
    color: #b91c1c;
    border: 1px solid rgba(239, 68, 68, 0.3);
}

/* Spinning animation for loading icon */
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.spinning {
    animation: spin 1s linear infinite;
}

/* N4L Preview */
.n4l-preview {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 1rem;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 0.8rem;
    line-height: 1.5;
    max-height: 200px;
    overflow-y: auto;
    white-space: pre-wrap;
    word-wrap: break-word;
    color: var(--text-dark);
}

#n4l-preview-container {
    margin-top: 1rem;
}

/* ============================================
   CONFIGURATION PAGE STYLES
   ============================================ */

.config-section {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
}

.config-section-header {
    margin-bottom: 0.75rem;
}

.config-section-header h3 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-dark);
    margin: 0;
}

.config-section-header h3 .material-icons {
    color: var(--primary);
    font-size: 1.25rem;
}

.config-prompts-container {
    display: grid;
    grid-template-columns: 250px 1fr;
    gap: 1rem;
    min-height: 400px;
    max-height: 500px;
    overflow: hidden;
}

.config-prompts-nav {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.5rem;
    max-height: 500px;
    overflow-y: auto;
}

.config-prompt-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    border: none;
    background: transparent;
    border-radius: 6px;
    cursor: pointer;
    text-align: left;
    font-size: 0.875rem;
    color: var(--text-dark);
    transition: all 0.2s ease;
}

.config-prompt-btn:hover {
    background: var(--bg-hover);
}

.config-prompt-btn.active {
    background: var(--primary);
    color: white;
}

.config-prompt-btn .material-icons {
    font-size: 1.125rem;
    opacity: 0.7;
}

.config-prompt-btn.active .material-icons {
    opacity: 1;
}

.config-prompt-editor {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1.25rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    overflow-y: auto;
    max-height: 500px;
}

.config-prompt-editor .form-group {
    margin-bottom: 0;
}

.config-prompt-editor .form-label {
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.config-prompt-editor .form-label .material-icons {
    font-size: 1rem;
    color: var(--primary);
}

.config-prompt-editor .form-textarea {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 0.85rem;
    line-height: 1.6;
    resize: vertical;
    min-height: 100px;
}

.config-prompt-editor .prompt-description {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-top: 0.25rem;
    font-style: italic;
}

.config-prompt-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border);
    margin-bottom: 1rem;
}

.config-prompt-header h4 {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--text-dark);
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.config-prompt-header h4 .material-icons {
    color: var(--primary);
}

.config-prompt-description {
    font-size: 0.875rem;
    color: var(--text-muted);
    padding: 0.75rem 1rem;
    background: var(--bg-light);
    border-radius: 6px;
    border-left: 3px solid var(--primary);
}

/* Section Modèles IA */
.config-section .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.config-section .form-group {
    margin-bottom: 0;
}

.config-section .form-input {
    width: 100%;
    box-sizing: border-box;
}

/* Responsive for config */
@media (max-width: 900px) {
    .config-prompts-container {
        grid-template-columns: 1fr;
    }

    .config-prompts-nav {
        flex-direction: row;
        flex-wrap: wrap;
        max-height: none;
    }

    .config-prompt-btn {
        flex: 1;
        min-width: 150px;
        justify-content: center;
    }

    .config-section .form-row {
        grid-template-columns: 1fr;
    }
}

/* ==================== INVESTIGATION MODE ==================== */

.investigation-steps {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.investigation-step {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.investigation-step:hover {
    border-color: var(--primary);
    background: var(--bg-light);
}

.investigation-step.active {
    border-color: var(--primary);
    background: var(--bg-subtle);
    box-shadow: 0 0 0 2px rgba(30, 58, 95, 0.1);
}

.investigation-step.completed {
    border-left: 3px solid #059669;
}

.investigation-step.in_progress {
    border-left: 3px solid #f59e0b;
}

.investigation-step-icon {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-subtle);
    border-radius: 50%;
    color: var(--primary);
    flex-shrink: 0;
}

.investigation-step.completed .investigation-step-icon {
    background: #d1fae5;
    color: #059669;
}

.investigation-step.in_progress .investigation-step-icon {
    background: #fef3c7;
    color: #d97706;
}

.investigation-step-content {
    flex: 1;
    min-width: 0;
}

.investigation-step-name {
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.25rem;
}

.investigation-step-description {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.investigation-step-status {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    background: var(--bg-subtle);
    color: var(--text-muted);
}

.investigation-step.completed .investigation-step-status {
    background: #d1fae5;
    color: #059669;
}

.investigation-step.in_progress .investigation-step-status {
    background: #fef3c7;
    color: #d97706;
}

/* Investigation Current Step */
.investigation-step-detail {
    padding: 1rem;
}

.investigation-step-detail h3 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.1rem;
    color: var(--primary);
    margin-bottom: 1rem;
}

.investigation-step-detail h3 .material-icons {
    font-size: 1.5rem;
}

.investigation-questions {
    margin-top: 1rem;
}

.investigation-questions h4 {
    font-size: 0.875rem;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.investigation-questions ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.investigation-questions li {
    padding: 0.5rem 0;
    padding-left: 1.5rem;
    position: relative;
    color: var(--text-muted);
    border-bottom: 1px solid var(--border);
}

.investigation-questions li:last-child {
    border-bottom: none;
}

.investigation-questions li::before {
    content: "?";
    position: absolute;
    left: 0;
    color: var(--primary);
    font-weight: 600;
}

/* Investigation Insights */
.investigation-insight {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    margin-bottom: 0.5rem;
    border-left: 3px solid var(--primary);
}

.investigation-insight .material-icons {
    color: var(--primary);
    font-size: 1.25rem;
    flex-shrink: 0;
}

.investigation-insight-text {
    font-size: 0.875rem;
    color: var(--text-dark);
    flex: 1;
    overflow-x: auto;
}

.investigation-insight-text table {
    width: 100%;
    border-collapse: collapse;
    margin: 0.5rem 0;
    font-size: 0.8rem;
}

.investigation-insight-text th,
.investigation-insight-text td {
    padding: 0.5rem;
    border: 1px solid var(--border-color);
    text-align: left;
}

.investigation-insight-text th {
    background: var(--primary);
    color: white;
    font-weight: 600;
}

.investigation-insight-text td {
    color: var(--text-dark);
}

.investigation-insight-text tr:nth-child(even) {
    background: rgba(0, 0, 0, 0.02);
}

.investigation-insight-text h3,
.investigation-insight-text h4,
.investigation-insight-text h5 {
    margin-top: 0.75rem;
    margin-bottom: 0.5rem;
    color: var(--primary);
}

.investigation-insight-text p {
    margin-bottom: 0.5rem;
    color: var(--text-dark);
}

.investigation-insight-text li {
    color: var(--text-dark);
}

.investigation-insight-text strong {
    color: var(--primary);
}

.investigation-recommendation {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 0.75rem;
    background: #fef3c7;
    border-radius: 6px;
    margin-bottom: 0.5rem;
    border-left: 3px solid #f59e0b;
}

.investigation-recommendation .material-icons {
    color: #d97706;
    font-size: 1.25rem;
    flex-shrink: 0;
}

.investigation-recommendation-text {
    font-size: 0.875rem;
    color: var(--text-dark);
}

/* Analysis Modal Content */
.analysis-modal-content {
    max-height: 65vh;
    overflow-y: auto;
    padding: 1rem;
    line-height: 1.6;
    color: var(--text-dark);
}

.analysis-modal-content h2,
.analysis-modal-content h3,
.analysis-modal-content h4 {
    color: var(--primary);
    margin: 1rem 0 0.5rem;
}

.analysis-modal-content h2:first-child,
.analysis-modal-content h3:first-child,
.analysis-modal-content h4:first-child {
    margin-top: 0;
}

.analysis-modal-content table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
    font-size: 0.85rem;
}

.analysis-modal-content th {
    background: var(--primary);
    color: white;
    padding: 0.75rem 0.5rem;
    text-align: left;
    font-weight: 600;
    border: 1px solid var(--primary);
}

.analysis-modal-content td {
    padding: 0.625rem 0.5rem;
    border: 1px solid var(--border-color);
    color: var(--text-dark);
    vertical-align: top;
}

.analysis-modal-content tr:nth-child(even) {
    background: var(--bg-subtle);
}

.analysis-modal-content tr:hover {
    background: rgba(30, 58, 95, 0.05);
}

.analysis-modal-content strong {
    color: var(--primary);
}

.analysis-modal-content ul,
.analysis-modal-content ol {
    margin: 0.5rem 0;
    padding-left: 1.5rem;
}

.analysis-modal-content li {
    margin-bottom: 0.375rem;
    color: var(--text-dark);
}

.analysis-modal-content p {
    margin-bottom: 0.75rem;
    color: var(--text-dark);
}

/* ==================== GRAPH ANALYSIS ==================== */

.graph-analysis-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.graph-analysis-card {
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    transition: all 0.2s ease;
}

.graph-analysis-card:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(30, 58, 95, 0.1);
}

.graph-analysis-card-icon {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-subtle);
    border-radius: 50%;
    margin: 0 auto 0.75rem;
    color: var(--primary);
}

.graph-analysis-card-icon .material-icons {
    font-size: 1.5rem;
}

.graph-analysis-card-value {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--primary);
    margin-bottom: 0.25rem;
}

.graph-analysis-card-label {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.graph-analysis-card.success .graph-analysis-card-icon {
    background: #d1fae5;
    color: #059669;
}

.graph-analysis-card.success .graph-analysis-card-value {
    color: #059669;
}

.graph-analysis-card.warning .graph-analysis-card-icon {
    background: #fef3c7;
    color: #d97706;
}

.graph-analysis-card.warning .graph-analysis-card-value {
    color: #d97706;
}

.graph-analysis-card.danger .graph-analysis-card-icon {
    background: #fee2e2;
    color: #dc2626;
}

.graph-analysis-card.danger .graph-analysis-card-value {
    color: #dc2626;
}

/* Clusters */
.cluster-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.cluster-item:hover {
    border-color: var(--primary);
    background: var(--bg-light);
}

.cluster-icon {
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-subtle);
    border-radius: 50%;
    color: var(--primary);
    flex-shrink: 0;
}

.cluster-content {
    flex: 1;
    min-width: 0;
}

.cluster-name {
    font-weight: 600;
    color: var(--text-dark);
}

.cluster-info {
    font-size: 0.75rem;
    color: var(--text-muted);
    display: flex;
    gap: 1rem;
    margin-top: 0.25rem;
}

.cluster-density {
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
}

.cluster-density.high {
    background: #d1fae5;
    color: #059669;
}

.cluster-density.medium {
    background: #fef3c7;
    color: #d97706;
}

.cluster-density.low {
    background: #fee2e2;
    color: #dc2626;
}

/* Density Map */
.density-zone {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem;
    border-radius: 8px;
    margin-bottom: 0.5rem;
}

.density-zone.explored {
    background: #d1fae5;
    border: 1px solid #a7f3d0;
}

.density-zone.partial {
    background: #fef3c7;
    border: 1px solid #fcd34d;
}

.density-zone.unexplored {
    background: #fee2e2;
    border: 1px solid #fecaca;
}

.density-zone-icon {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.density-zone.explored .density-zone-icon {
    background: #059669;
    color: white;
}

.density-zone.partial .density-zone-icon {
    background: #d97706;
    color: white;
}

.density-zone.unexplored .density-zone-icon {
    background: #dc2626;
    color: white;
}

.density-zone-content {
    flex: 1;
}

.density-zone-name {
    font-weight: 600;
    color: var(--text-dark);
}

.density-zone-info {
    font-size: 0.75rem;
    color: var(--text-muted);
}

.density-zone-value {
    font-size: 1.25rem;
    font-weight: 700;
}

.density-zone.explored .density-zone-value {
    color: #059669;
}

.density-zone.partial .density-zone-value {
    color: #d97706;
}

.density-zone.unexplored .density-zone-value {
    color: #dc2626;
}

/* Consistency Result */
.consistency-status {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
}

.consistency-status.consistent {
    background: #d1fae5;
    border: 1px solid #a7f3d0;
}

.consistency-status.inconsistent {
    background: #fee2e2;
    border: 1px solid #fecaca;
}

.consistency-status .material-icons {
    font-size: 2rem;
}

.consistency-status.consistent .material-icons {
    color: #059669;
}

.consistency-status.inconsistent .material-icons {
    color: #dc2626;
}

.consistency-status-text {
    font-weight: 600;
}

.consistency-status.consistent .consistency-status-text {
    color: #059669;
}

.consistency-status.inconsistent .consistency-status-text {
    color: #dc2626;
}

.consistency-issues {
    margin-top: 1rem;
}

.consistency-issue {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    margin-bottom: 0.5rem;
    border-left: 3px solid var(--text-muted);
}

.consistency-issue.warning {
    border-left-color: #f59e0b;
    background: #fef3c7;
}

.consistency-issue.error {
    border-left-color: #dc2626;
    background: #fee2e2;
}

.consistency-issue .material-icons {
    font-size: 1.25rem;
    flex-shrink: 0;
}

.consistency-issue.warning .material-icons {
    color: #d97706;
}

.consistency-issue.error .material-icons {
    color: #dc2626;
}

/* Temporal Patterns */
.temporal-pattern {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    margin-bottom: 0.5rem;
}

.temporal-pattern-icon {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    flex-shrink: 0;
}

.temporal-pattern.sequence .temporal-pattern-icon {
    background: #dbeafe;
    color: #1e40af;
}

.temporal-pattern.cycle .temporal-pattern-icon {
    background: #fef3c7;
    color: #d97706;
}

.temporal-pattern.gap .temporal-pattern-icon {
    background: #fee2e2;
    color: #dc2626;
}

.temporal-pattern.cluster .temporal-pattern-icon {
    background: #f3e8ff;
    color: #7c3aed;
}

.temporal-pattern-content {
    flex: 1;
}

.temporal-pattern-type {
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.25rem;
}

.temporal-pattern.sequence .temporal-pattern-type {
    color: #1e40af;
}

.temporal-pattern.cycle .temporal-pattern-type {
    color: #d97706;
}

.temporal-pattern.gap .temporal-pattern-type {
    color: #dc2626;
}

.temporal-pattern.cluster .temporal-pattern-type {
    color: #7c3aed;
}

.temporal-pattern-description {
    font-size: 0.875rem;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
}

.temporal-pattern-nodes {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
}

.temporal-pattern-node {
    font-size: 0.7rem;
    padding: 0.15rem 0.4rem;
    background: var(--bg-subtle);
    border-radius: 4px;
    color: var(--text-muted);
}

.temporal-pattern-confidence {
    font-size: 0.75rem;
    color: var(--text-muted);
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

/* Graph Analysis Tabs */
.graph-analysis-tabs {
    display: flex;
    gap: 0.25rem;
    padding: 0.5rem;
    background: var(--bg-subtle);
    border-radius: 8px;
    width: 100%;
}

.graph-analysis-tab {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.625rem 1rem;
    background: transparent;
    border: none;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
    flex: 1;
    justify-content: center;
}

.graph-analysis-tab:hover {
    background: var(--bg-white);
    color: var(--primary);
}

.graph-analysis-tab.active {
    background: var(--primary);
    color: white;
    box-shadow: 0 2px 4px rgba(30, 58, 95, 0.2);
}

.graph-analysis-tab .material-icons {
    font-size: 1.125rem;
}

.graph-analysis-tab-content {
    display: none;
    padding-top: 1rem;
}

.graph-analysis-tab-content.active {
    display: block;
}

.tab-description {
    font-size: 0.8rem;
    color: var(--text-muted);
    padding: 0.75rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.tab-description .material-icons {
    font-size: 1rem;
    color: var(--primary);
}

/* ==================== CLUSTERS WITH MINI-GRAPH ==================== */
.clusters-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    min-height: 350px;
}

.clusters-list-panel {
    overflow-y: auto;
    max-height: 400px;
}

.cluster-preview-panel {
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--bg-white);
    overflow: hidden;
}

.cluster-preview-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem;
    background: var(--primary);
    color: white;
    font-weight: 600;
    font-size: 0.875rem;
}

.cluster-preview-header .material-icons {
    font-size: 1.125rem;
}

.cluster-mini-graph {
    height: 320px;
    background: var(--bg-subtle);
}

.cluster-item {
    cursor: pointer;
    transition: all 0.2s ease;
}

.cluster-item:hover {
    transform: translateX(4px);
}

.cluster-item.selected {
    border-color: var(--primary);
    background: rgba(30, 58, 95, 0.05);
}

/* ==================== CENTRALITY & SUSPICION ==================== */
.centrality-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
}

.centrality-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--primary);
    margin-bottom: 1rem;
    font-size: 1rem;
}

.centrality-section h4 .material-icons {
    font-size: 1.25rem;
}

.section-description {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-bottom: 1rem;
}

.centrality-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--bg-subtle);
    border-radius: 8px;
    margin-bottom: 0.5rem;
    transition: all 0.2s ease;
}

.centrality-item:hover {
    background: rgba(30, 58, 95, 0.08);
}

.centrality-rank {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--primary);
    color: white;
    border-radius: 50%;
    font-weight: 700;
    font-size: 0.875rem;
}

.centrality-rank.gold {
    background: #f59e0b;
}

.centrality-rank.silver {
    background: #94a3b8;
}

.centrality-rank.bronze {
    background: #cd7f32;
}

.centrality-info {
    flex: 1;
}

.centrality-name {
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.125rem;
}

.centrality-type {
    font-size: 0.75rem;
    color: var(--text-muted);
}

.centrality-score {
    font-weight: 700;
    color: var(--primary);
    font-size: 1rem;
}

.centrality-bar {
    width: 80px;
    height: 8px;
    background: var(--border);
    border-radius: 4px;
    overflow: hidden;
}

.centrality-bar-fill {
    height: 100%;
    background: var(--primary);
    border-radius: 4px;
    transition: width 0.3s ease;
}

/* Suspicion Score */
.suspicion-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.875rem;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    margin-bottom: 0.5rem;
    transition: all 0.2s ease;
}

.suspicion-item:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(30, 58, 95, 0.1);
}

.suspicion-avatar {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg-subtle);
    border-radius: 50%;
    color: var(--primary);
}

.suspicion-info {
    flex: 1;
}

.suspicion-name {
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.25rem;
}

.suspicion-factors {
    display: flex;
    flex-wrap: wrap;
    gap: 0.375rem;
}

.suspicion-factor {
    font-size: 0.7rem;
    padding: 0.125rem 0.5rem;
    background: var(--bg-subtle);
    border-radius: 10px;
    color: var(--text-muted);
}

.suspicion-factor.high {
    background: #fef2f2;
    color: #dc2626;
}

.suspicion-factor.medium {
    background: #fef3c7;
    color: #d97706;
}

.suspicion-score-badge {
    min-width: 50px;
    padding: 0.5rem;
    text-align: center;
    border-radius: 8px;
    font-weight: 700;
}

.suspicion-score-badge.high {
    background: #fef2f2;
    color: #dc2626;
    border: 1px solid #fecaca;
}

.suspicion-score-badge.medium {
    background: #fef3c7;
    color: #d97706;
    border: 1px solid #fde68a;
}

.suspicion-score-badge.low {
    background: #f0fdf4;
    color: #16a34a;
    border: 1px solid #bbf7d0;
}

/* ==================== ALIBIS TIMELINE ==================== */
.alibis-container {
    background: var(--bg-white);
    border-radius: 8px;
    padding: 1rem;
}

.alibis-legend {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border);
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8rem;
    color: var(--text-muted);
}

.legend-color {
    width: 16px;
    height: 16px;
    border-radius: 4px;
}

.legend-color.alibi-verified {
    background: #22c55e;
}

.legend-color.alibi-unverified {
    background: #f59e0b;
}

.legend-color.alibi-opportunity {
    background: #ef4444;
}

.legend-color.alibi-crime {
    background: #1e3a5f;
}

.alibi-row {
    display: flex;
    align-items: stretch;
    margin-bottom: 1rem;
    min-height: 60px;
}

.alibi-person {
    width: 150px;
    flex-shrink: 0;
    padding: 0.5rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
    border-right: 2px solid var(--border);
}

.alibi-person-name {
    font-weight: 600;
    color: var(--text-dark);
    font-size: 0.875rem;
}

.alibi-person-role {
    font-size: 0.75rem;
    color: var(--text-muted);
}

.alibi-timeline-track {
    flex: 1;
    position: relative;
    background: var(--bg-subtle);
    border-radius: 4px;
    margin-left: 1rem;
    min-height: 40px;
}

.alibi-block {
    position: absolute;
    top: 4px;
    height: calc(100% - 8px);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    color: white;
    font-weight: 500;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    padding: 0 0.5rem;
    cursor: pointer;
    transition: opacity 0.2s ease;
}

.alibi-block:hover {
    opacity: 0.9;
}

.alibi-block.verified {
    background: #22c55e;
}

.alibi-block.unverified {
    background: #f59e0b;
}

.alibi-block.opportunity {
    background: repeating-linear-gradient(
        45deg,
        #ef4444,
        #ef4444 10px,
        #dc2626 10px,
        #dc2626 20px
    );
}

.alibi-crime-marker {
    position: absolute;
    top: -8px;
    bottom: -8px;
    width: 3px;
    background: #1e3a5f;
    z-index: 10;
}

.alibi-crime-marker::before {
    content: 'Crime';
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.65rem;
    font-weight: 600;
    color: #1e3a5f;
    white-space: nowrap;
}

.alibi-time-axis {
    display: flex;
    margin-left: 166px;
    border-top: 1px solid var(--border);
    padding-top: 0.5rem;
    margin-top: 0.5rem;
}

.alibi-time-label {
    flex: 1;
    text-align: center;
    font-size: 0.7rem;
    color: var(--text-muted);
}

/* Responsive for graph analysis */
@media (max-width: 900px) {
    .graph-analysis-cards {
        grid-template-columns: repeat(2, 1fr);
    }

    .graph-analysis-tabs {
        flex-wrap: wrap;
    }

    .graph-analysis-tab {
        flex: 1 1 45%;
        min-width: 120px;
    }
}

@media (max-width: 600px) {
    .graph-analysis-cards {
        grid-template-columns: 1fr;
    }

    .graph-analysis-tab {
        flex: 1 1 100%;
    }
}

/* Checkbox label */
.checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 0.875rem;
    color: var(--text-dark);
}

.checkbox-label input[type="checkbox"] {
    width: 18px;
    height: 18px;
    accent-color: var(--primary);
    cursor: pointer;
}

/* ==================== NOTEBOOK STYLES ==================== */

/* Note card */
.note-card {
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    transition: all 0.2s;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.note-card:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(30, 58, 95, 0.1);
}

.note-card.pinned {
    border-left: 3px solid #f59e0b;
    background: linear-gradient(to right, rgba(245, 158, 11, 0.05), transparent);
}

.note-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.note-card-type {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.75rem;
    color: var(--text-muted);
    background: var(--bg-subtle);
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
}

.note-card-type .material-icons {
    font-size: 0.875rem;
}

.note-card-actions {
    display: flex;
    gap: 0.15rem;
    opacity: 0;
    transition: opacity 0.2s;
}

.note-card:hover .note-card-actions {
    opacity: 1;
}

.note-card-title {
    font-weight: 600;
    color: var(--text-dark);
    font-size: 0.95rem;
    line-height: 1.3;
}

.note-card-preview {
    font-size: 0.85rem;
    color: var(--text-muted);
    line-height: 1.5;
    flex: 1;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
}

.note-card-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem;
}

.note-tag {
    font-size: 0.7rem;
    padding: 0.15rem 0.4rem;
    background: #e0f2fe;
    color: #0369a1;
    border-radius: 4px;
}

.note-card-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.75rem;
    color: var(--text-muted);
    padding-top: 0.5rem;
    border-top: 1px solid var(--border);
}

.note-card-date {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.note-card-context {
    font-style: italic;
    color: var(--primary);
}

/* Note detail view */
.note-detail {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.note-detail-meta {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex-wrap: wrap;
}

.note-detail-type {
    font-size: 0.8rem;
    padding: 0.25rem 0.6rem;
    background: var(--primary);
    color: white;
    border-radius: 4px;
}

.note-detail-date {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.note-detail-context {
    font-size: 0.85rem;
    color: var(--text-muted);
    padding: 0.5rem;
    background: var(--bg-subtle);
    border-radius: 4px;
}

.note-detail-tags {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.note-detail-content {
    padding: 1rem;
    background: var(--bg-light);
    border-radius: 8px;
    line-height: 1.6;
}

/* Stats badge */
.stat-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.3rem 0.6rem;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 500;
}

.stat-badge-clickable {
    cursor: pointer;
    transition: transform 0.15s, box-shadow 0.15s, opacity 0.15s;
}

.stat-badge-clickable:hover {
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

.stat-badge-clickable.active {
    box-shadow: 0 0 0 2px var(--primary), 0 2px 8px rgba(0,0,0,0.2);
}

/* Button icon small */
.btn-icon-sm {
    padding: 0.25rem;
    min-width: auto;
}

.btn-icon-sm .material-icons {
    font-size: 1rem;
}

/* Ghost button */
.btn-ghost {
    background: transparent;
    border: none;
    color: var(--text-muted);
}

.btn-ghost:hover {
    background: var(--bg-subtle);
    color: var(--text-dark);
}

/* Responsive notebook */
@media (max-width: 768px) {
    .notebook-notes-list {
        grid-template-columns: 1fr !important;
    }

    .note-card-actions {
        opacity: 1;
    }
}

/* ============================================ */
/* Social Network Analysis Module Styles */
/* ============================================ */

/* Panel principal */
.social-network-panel {
    position: fixed;
    top: 0;
    right: -50%;
    width: 50%;
    height: 100vh;
    background: var(--bg-white);
    box-shadow: -4px 0 30px rgba(0, 0, 0, 0.15);
    z-index: 1001;
    transition: right 0.3s ease;
    display: flex;
    flex-direction: column;
}

.social-network-panel.active {
    right: 0;
}

.social-network-panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    background: var(--primary);
    color: white;
}

.social-network-panel-header h2 {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1.25rem;
    font-weight: 600;
    margin: 0;
}

.social-network-panel-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.social-network-panel-actions .btn-icon {
    color: white;
    opacity: 0.8;
}

.social-network-panel-actions .btn-icon:hover {
    opacity: 1;
    background: rgba(255, 255, 255, 0.15);
}

.social-network-panel-content {
    flex: 1;
    overflow-y: auto;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
}

/* Loading state */
.social-network-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 200px;
    color: var(--text-muted);
}

.social-network-loading .spinner {
    width: 40px;
    height: 40px;
    border: 3px solid var(--border);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Vue d'ensemble */
.sn-overview {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    flex: 1;
    min-height: 0;
}

/* Grille de métriques */
.sn-metrics-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
}

.sn-metric-card {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.sn-metric-card .material-icons {
    font-size: 1.5rem;
    color: var(--primary);
    margin-bottom: 0.5rem;
}

.sn-metric-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--primary);
}

.sn-metric-label {
    font-size: 0.75rem;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Grille d'actions */
.sn-actions-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
}

.sn-action-btn {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: var(--bg-white);
    border: 2px solid var(--border);
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text-dark);
}

.sn-action-btn:hover {
    border-color: var(--primary);
    background: var(--bg-light);
}

.sn-action-btn .material-icons {
    font-size: 1.5rem;
    color: var(--primary);
}

/* Layout 2 colonnes */
.sn-two-columns {
    display: grid;
    grid-template-columns: 1fr 400px;
    gap: 1.5rem;
    flex: 1;
    min-height: 0;
}

.sn-column-left {
    min-height: 0;
    display: flex;
    flex-direction: column;
}

.sn-column-right {
    min-height: 0;
    overflow-y: auto;
}

@media (max-width: 1200px) {
    .sn-two-columns {
        grid-template-columns: 1fr;
    }

    .sn-column-left {
        min-height: 400px;
    }

    .sn-column-right {
        min-height: 300px;
        max-height: 400px;
    }
}

/* Conteneur du graphe */
.sn-graph-container {
    width: 100%;
    flex: 1;
    min-height: 400px;
    border: 1px solid var(--border);
    border-radius: 10px;
    background: var(--bg-light);
}

/* Conteneur des résultats */
.sn-results-container {
    flex: 1;
    overflow-y: auto;
    background: var(--bg-secondary);
    border-radius: 10px;
    padding: 1rem;
}

.sn-results-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    min-height: 200px;
    color: var(--text-muted);
    text-align: center;
}

.sn-results-placeholder .material-icons {
    font-size: 3rem;
    opacity: 0.5;
    margin-bottom: 1rem;
}

.sn-results-placeholder p {
    font-size: 0.9rem;
}

/* Sections */
.sn-section {
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 1.25rem;
}

.sn-section h3 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.1rem;
    color: var(--primary);
    margin-bottom: 1rem;
}

.sn-section h3 .material-icons {
    font-size: 1.25rem;
}

.sn-section-desc {
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-bottom: 1rem;
}

/* Liste des communautés */
.sn-communities-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.sn-community-card {
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    transition: all 0.2s ease;
}

.sn-community-card:hover {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.sn-community-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
}

.sn-community-badge {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    color: white;
    font-weight: 600;
    font-size: 0.85rem;
}

.sn-community-size {
    font-size: 0.85rem;
    color: var(--text-muted);
}

.sn-community-members {
    font-size: 0.9rem;
    color: var(--text-dark);
    line-height: 1.5;
    margin-bottom: 0.75rem;
}

.sn-community-actions {
    display: flex;
    gap: 0.5rem;
}

/* Liste des brokers */
.sn-brokers-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.sn-broker-card {
    display: flex;
    align-items: center;
    gap: 1rem;
    background: var(--bg-light);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.75rem 1rem;
}

.sn-broker-rank {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--primary);
    min-width: 30px;
}

.sn-broker-info {
    flex: 1;
}

.sn-broker-name {
    font-weight: 600;
    color: var(--text-dark);
}

.sn-broker-type {
    font-size: 0.75rem;
    color: var(--text-muted);
}

.sn-broker-score {
    width: 100px;
    height: 8px;
    background: var(--bg-subtle);
    border-radius: 4px;
    overflow: hidden;
    position: relative;
}

.sn-score-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--primary), #3b82f6);
    border-radius: 4px;
    transition: width 0.3s ease;
}

.sn-score-value {
    position: absolute;
    right: -40px;
    top: -4px;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--primary);
}

.sn-broker-actions {
    display: flex;
    gap: 0.25rem;
}

.sn-no-results {
    color: var(--text-muted);
    font-style: italic;
    padding: 1rem;
    text-align: center;
}

/* Analyse des flux */
.sn-flow-selector {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}

.sn-flow-selector label {
    font-weight: 500;
    color: var(--text-dark);
}

.sn-flow-summary {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.sn-flow-card {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--bg-light);
    border: 2px solid var(--border);
    border-radius: 8px;
}

.sn-flow-card .material-icons {
    font-size: 1.5rem;
}

.sn-flow-info {
    flex: 1;
}

.sn-flow-type {
    font-weight: 600;
    font-size: 0.85rem;
}

.sn-flow-count {
    font-size: 0.75rem;
    color: var(--text-muted);
}

.sn-flow-details {
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.75rem;
    margin-bottom: 1rem;
}

.sn-flow-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.sn-flow-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    background: var(--bg-subtle);
    border-radius: 4px;
    font-size: 0.85rem;
}

.sn-flow-arrow {
    font-weight: 500;
}

.sn-hint {
    color: var(--text-muted);
    font-size: 0.85rem;
    text-align: center;
    padding: 1rem;
}

/* Évolution temporelle */
.sn-temporal-controls {
    background: var(--bg-light);
    border-radius: 10px;
    padding: 1.25rem;
    margin-bottom: 1rem;
}

.sn-temporal-slider {
    width: 100%;
    height: 6px;
    -webkit-appearance: none;
    background: var(--border);
    border-radius: 3px;
    outline: none;
    margin-bottom: 1rem;
}

.sn-temporal-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    background: var(--primary);
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
}

.sn-temporal-slider::-moz-range-thumb {
    width: 18px;
    height: 18px;
    background: var(--primary);
    border-radius: 50%;
    cursor: pointer;
    border: none;
}

.sn-temporal-info {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
    margin-bottom: 1rem;
}

.sn-temporal-date {
    font-size: 0.85rem;
    color: var(--text-muted);
}

.sn-temporal-event {
    font-weight: 600;
    color: var(--primary);
    text-align: center;
}

.sn-temporal-buttons {
    display: flex;
    justify-content: center;
    gap: 0.5rem;
}

.sn-temporal-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
}

.sn-temporal-stat {
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
}

.sn-stat-value {
    display: block;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--primary);
}

.sn-stat-label {
    font-size: 0.75rem;
    color: var(--text-muted);
    text-transform: uppercase;
}

/* Responsive Social Network */
@media (max-width: 1024px) {
    .social-network-panel {
        width: 70%;
        right: -70%;
    }

    .sn-metrics-grid {
        grid-template-columns: repeat(2, 1fr);
    }

    .sn-flow-summary {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 768px) {
    .social-network-panel {
        width: 100%;
        right: -100%;
    }

    .sn-metrics-grid {
        grid-template-columns: repeat(2, 1fr);
    }

    .sn-actions-grid {
        grid-template-columns: 1fr;
    }

    .sn-broker-score {
        display: none;
    }

    .sn-broker-actions {
        flex-direction: column;
    }
}

/* ========================================
   JavaScript Tooltips - Fixed position, escapes all containers
   ======================================== */

.js-tooltip {
    position: fixed;
    z-index: 999999;
    pointer-events: none;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.15s ease-in-out, visibility 0.15s ease-in-out;
}

.js-tooltip.visible {
    visibility: visible;
}

.js-tooltip-content {
    padding: 0.75rem 1rem;
    background: var(--primary-dark);
    color: white;
    font-size: 0.875rem;
    font-weight: 500;
    line-height: 1.5;
    max-width: 320px;
    min-width: 120px;
    white-space: normal;
    text-align: center;
    border-radius: 8px;
    box-shadow: 0 6px 16px rgba(30, 58, 95, 0.3);
}

.js-tooltip-arrow {
    position: absolute;
    width: 0;
    height: 0;
    border: 6px solid transparent;
}

/* Arrow pointing down (tooltip above target) */
.js-tooltip-arrow.arrow-bottom {
    bottom: -12px;
    border-top-color: var(--primary-dark);
    border-bottom: none;
}

/* Arrow pointing up (tooltip below target) */
.js-tooltip-arrow.arrow-top {
    top: -6px;
    border-bottom-color: var(--primary-dark);
    border-top: none;
}

/* Arrow pointing right (tooltip left of target) */
.js-tooltip-arrow.arrow-right {
    right: -12px;
    top: 50%;
    transform: translateY(-50%);
    border-left-color: var(--primary-dark);
    border-right: none;
}

/* Arrow pointing left (tooltip right of target) */
.js-tooltip-arrow.arrow-left {
    left: -6px;
    top: 50%;
    transform: translateY(-50%);
    border-right-color: var(--primary-dark);
    border-left: none;
}

/* ========================================
   Geographic Map Styles
   ======================================== */

.geo-map-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    gap: 1rem;
}

.geo-map-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1rem;
    background: var(--bg-secondary);
    border-radius: 8px;
    flex-wrap: wrap;
    gap: 1rem;
}

.geo-map-controls {
    display: flex;
    gap: 1.5rem;
    align-items: center;
    flex-wrap: wrap;
}

.geo-control-group {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.geo-control-group label {
    font-size: 0.8rem;
    color: var(--text-secondary);
    font-weight: 500;
}

.geo-toggle-buttons {
    display: flex;
    gap: 0.25rem;
    background: var(--bg-primary);
    padding: 0.25rem;
    border-radius: 6px;
}

.geo-toggle-btn {
    padding: 0.4rem 0.6rem;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.geo-toggle-btn:hover {
    background: var(--bg-hover);
    color: var(--primary);
}

.geo-toggle-btn.active {
    background: var(--primary);
    color: white;
}

.geo-toggle-btn .material-icons {
    font-size: 1.1rem;
}

.geo-control-group select {
    padding: 0.4rem 0.75rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 0.85rem;
    cursor: pointer;
}

.geo-control-group input[type="checkbox"] {
    accent-color: var(--primary);
}

.geo-map-stats {
    display: flex;
    gap: 1rem;
}

.geo-stat {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.85rem;
    color: var(--text-secondary);
    background: var(--bg-primary);
    padding: 0.35rem 0.75rem;
    border-radius: 20px;
}

.geo-stat .material-icons {
    font-size: 1rem;
    color: var(--primary);
}

.geo-map-wrapper {
    position: relative;
    flex: 1;
    min-height: 400px;
    border-radius: 12px;
    overflow: hidden;
    border: 1px solid var(--border-color);
}

.geo-map {
    width: 100%;
    height: 100%;
    min-height: 400px;
    background: var(--bg-secondary);
    z-index: 1;
}

.geo-map-legend {
    position: absolute;
    bottom: 1rem;
    right: 1rem;
    background: white;
    padding: 0.75rem 1rem;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    z-index: 1000;
}

.geo-map-legend h4 {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-secondary);
    margin: 0 0 0.5rem 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8rem;
    color: var(--text-primary);
    padding: 0.2rem 0;
}

.legend-color {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.geo-map-empty {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    color: var(--text-secondary);
    z-index: 500;
    background: rgba(255, 255, 255, 0.9);
    padding: 2rem;
    border-radius: 12px;
}

.geo-map-empty .material-icons {
    font-size: 3rem;
    opacity: 0.5;
    margin-bottom: 0.5rem;
}

.geo-map-empty p {
    font-weight: 500;
    margin: 0.5rem 0;
}

.geo-map-empty small {
    font-size: 0.8rem;
    opacity: 0.7;
}

/* Two Columns Layout */
.geo-map-two-columns {
    display: grid;
    grid-template-columns: 1fr 400px;
    gap: 1.5rem;
    min-height: 500px;
}

.geo-map-column-left {
    display: flex;
    flex-direction: column;
    position: relative;
}

.geo-map-column-left .geo-map-wrapper {
    flex: 1;
    min-height: 500px;
}

.geo-map-column-right {
    display: flex;
    flex-direction: column;
    max-height: 600px;
    overflow: hidden;
}

.geo-map-column-right .geo-locations-list {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.geo-map-column-right #locations-list-content {
    flex: 1;
    overflow-y: auto;
    padding-right: 0.5rem;
}

/* Responsive: stack on smaller screens */
@media (max-width: 1200px) {
    .geo-map-two-columns {
        grid-template-columns: 1fr;
    }

    .geo-map-column-right {
        max-height: none;
    }
}

/* Locations List */
.geo-locations-list {
    background: var(--bg-secondary);
    border-radius: 12px;
    padding: 1rem;
}

.geo-locations-list h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0 0 1rem 0;
}

.geo-locations-list h4 .material-icons {
    font-size: 1.1rem;
    color: var(--primary);
}

/* Locations Header with Filter */
.locations-header {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.locations-header h4 {
    margin: 0;
}

.locations-filter-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.locations-filter-buttons .filter-btn {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.4rem 0.75rem;
    background: white;
    border: 1px solid var(--border);
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
}

.locations-filter-buttons .filter-btn .material-icons {
    font-size: 1rem;
}

.locations-filter-buttons .filter-btn:hover {
    background: var(--bg-secondary);
    border-color: var(--primary);
    color: var(--primary);
}

.locations-filter-buttons .filter-btn.active {
    background: var(--primary);
    border-color: var(--primary);
    color: white;
}

.locations-filter-buttons .filter-btn.active .material-icons {
    color: white;
}

/* Filter button colors on hover */
.locations-filter-buttons .filter-btn[data-filter="lieu"]:hover .material-icons { color: #6366f1; }
.locations-filter-buttons .filter-btn[data-filter="suspect"]:hover .material-icons { color: #f59e0b; }
.locations-filter-buttons .filter-btn[data-filter="victime"]:hover .material-icons { color: #ef4444; }
.locations-filter-buttons .filter-btn[data-filter="temoin"]:hover .material-icons { color: #22c55e; }
.locations-filter-buttons .filter-btn[data-filter="preuve"]:hover .material-icons { color: #8b5cf6; }

.locations-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 0.75rem;
}

.location-card {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--bg-primary);
    border-radius: 8px;
    border: 1px solid var(--border-color);
    cursor: pointer;
    transition: all 0.2s;
}

.location-card:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(30, 58, 95, 0.1);
    transform: translateY(-1px);
}

.location-icon {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    background: color-mix(in srgb, var(--marker-color, var(--primary)) 15%, transparent);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.location-icon .material-icons {
    font-size: 1.25rem;
    color: var(--loc-color, var(--primary));
}

.location-info {
    flex: 1;
    min-width: 0;
}

.location-name {
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.location-address {
    font-size: 0.75rem;
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.location-events {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.7rem;
    color: var(--primary);
    margin-top: 0.25rem;
}

.location-events .material-icons {
    font-size: 0.85rem;
}

.location-coords {
    font-size: 0.7rem;
    color: var(--text-muted);
    font-family: monospace;
    white-space: nowrap;
}

/* Marker Styles */
.geo-marker-container {
    background: transparent;
    border: none;
}

.geo-marker {
    width: 36px;
    height: 36px;
    background: var(--marker-color, var(--primary));
    border-radius: 50% 50% 50% 0;
    transform: rotate(-45deg);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
    border: 2px solid white;
}

.geo-marker .material-icons {
    transform: rotate(45deg);
    font-size: 1rem;
    color: white;
}

/* Popup Styles */
.geo-popup {
    min-width: 220px;
    max-width: 300px;
}

.geo-popup-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding-bottom: 0.5rem;
    margin-bottom: 0.5rem;
    border-bottom: 2px solid var(--primary);
}

.geo-popup-header .material-icons {
    font-size: 1.25rem;
}

.geo-popup-header h4 {
    margin: 0;
    font-size: 1rem;
    font-weight: 600;
}

.geo-popup-content {
    font-size: 0.85rem;
}

.geo-popup-address {
    display: flex;
    align-items: flex-start;
    gap: 0.35rem;
    color: #666;
    margin: 0.25rem 0;
}

.geo-popup-address .material-icons {
    font-size: 1rem;
    flex-shrink: 0;
}

.geo-popup-desc {
    margin: 0.5rem 0;
    color: #333;
    line-height: 1.4;
}

.geo-popup-events {
    margin-top: 0.75rem;
    padding-top: 0.5rem;
    border-top: 1px solid #eee;
}

.geo-popup-events strong {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.8rem;
    color: var(--primary);
}

.geo-popup-events .material-icons {
    font-size: 1rem;
}

.geo-popup-events ul {
    list-style: none;
    margin: 0.5rem 0 0 0;
    padding: 0;
}

.geo-popup-events li {
    font-size: 0.8rem;
    padding: 0.25rem 0;
    border-bottom: 1px solid #f0f0f0;
}

.geo-popup-events li:last-child {
    border-bottom: none;
}

.geo-popup-events .event-time {
    font-size: 0.7rem;
    color: #888;
    margin-right: 0.5rem;
}

.geo-popup-events .more-events {
    color: var(--primary);
    font-style: italic;
}

.geo-popup-actions {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.75rem;
    padding-top: 0.5rem;
    border-top: 1px solid #eee;
}

.geo-popup-actions .btn {
    flex: 1;
    font-size: 0.75rem;
    padding: 0.35rem 0.5rem;
}

/* Route Popup */
.route-popup {
    text-align: center;
    padding: 0.25rem;
}

.route-popup strong {
    font-size: 0.85rem;
}

.route-popup .material-icons {
    font-size: 1rem;
    vertical-align: middle;
    margin: 0 0.25rem;
    color: var(--primary);
}

.route-popup p {
    margin: 0.5rem 0 0 0;
    font-size: 0.75rem;
    color: #666;
}

/* Enhanced Route Popup */
.route-popup-enhanced {
    min-width: 220px;
    padding: 0.5rem;
}

.route-popup-enhanced .route-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding-bottom: 0.75rem;
    margin-bottom: 0.75rem;
    border-bottom: 1px solid var(--border);
}

.route-popup-enhanced .route-header .route-number-badge {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: var(--primary);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 0.85rem;
}

.route-popup-enhanced .route-header span:last-child {
    font-weight: 600;
    color: var(--text-primary);
}

.route-popup-enhanced .route-details {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.route-popup-enhanced .route-popup-from,
.route-popup-enhanced .route-popup-to {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
}

.route-popup-enhanced .route-popup-from .material-icons {
    color: #22c55e;
    font-size: 1.25rem;
}

.route-popup-enhanced .route-popup-to .material-icons {
    color: #ef4444;
    font-size: 1.25rem;
}

.route-popup-enhanced .route-popup-from div,
.route-popup-enhanced .route-popup-to div {
    flex: 1;
}

.route-popup-enhanced .route-popup-from strong,
.route-popup-enhanced .route-popup-to strong {
    display: block;
    font-size: 0.85rem;
    color: var(--text-primary);
}

.route-popup-enhanced .route-popup-from small,
.route-popup-enhanced .route-popup-to small {
    display: block;
    font-size: 0.75rem;
    color: var(--text-secondary);
}

.route-popup-enhanced .route-time {
    color: var(--primary) !important;
    font-weight: 500;
}

.route-popup-enhanced .route-popup-arrow {
    display: flex;
    justify-content: center;
    padding: 0.25rem 0;
}

.route-popup-enhanced .route-popup-arrow .material-icons {
    color: var(--text-secondary);
    font-size: 1.25rem;
}

/* Route Number Marker */
.route-number-marker {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    font-weight: 700;
    font-size: 0.75rem;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    border: 2px solid white;
}

/* Locations Grouped List - single column in sidebar */
.locations-grouped {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.locations-group {
    background: var(--bg-secondary);
    border-radius: 8px;
    padding: 0.75rem;
}

.locations-group-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding-bottom: 0.5rem;
    margin-bottom: 0.5rem;
    border-bottom: 1px solid var(--border);
}

.locations-group-header .material-icons {
    font-size: 1.25rem;
    color: var(--primary);
}

.locations-group-header span:last-child {
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--text-primary);
}

.locations-group-items {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

/* Location Card */
.location-card {
    display: flex;
    flex-direction: column;
    padding: 0.75rem;
    background: white;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid var(--border);
}

.location-card:hover {
    border-color: var(--primary);
    box-shadow: 0 2px 8px rgba(30, 58, 95, 0.15);
}

.location-card-main {
    flex: 1;
}

.location-card .location-name {
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--text-primary);
    margin-bottom: 0.35rem;
    word-wrap: break-word;
}

.location-card .location-address {
    display: flex;
    align-items: flex-start;
    gap: 0.35rem;
    font-size: 0.8rem;
    color: var(--text-secondary);
    margin-bottom: 0.35rem;
    line-height: 1.4;
}

.location-card .location-address .material-icons {
    font-size: 0.9rem;
    color: var(--primary);
    flex-shrink: 0;
    margin-top: 0.1rem;
}

.location-card .location-desc {
    font-size: 0.8rem;
    color: var(--text-secondary);
    line-height: 1.4;
    margin-top: 0.25rem;
}

.location-card-meta {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.5rem;
    padding-top: 0.5rem;
    border-top: 1px solid var(--border);
}

.location-badge {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.75rem;
    color: var(--text-secondary);
    background: var(--bg-secondary);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
}

.location-badge .material-icons {
    font-size: 0.85rem;
}

.location-badge.events {
    color: var(--primary);
}

.location-badge.coords {
    margin-left: auto;
    cursor: pointer;
}

.location-badge.coords:hover {
    background: var(--primary);
    color: white;
}

/* Group colors */
.locations-group[data-type="lieu"] .locations-group-header .material-icons { color: #6366f1; }
.locations-group[data-type="victime"] .locations-group-header .material-icons { color: #ef4444; }
.locations-group[data-type="suspect"] .locations-group-header .material-icons { color: #f59e0b; }
.locations-group[data-type="temoin"] .locations-group-header .material-icons { color: #22c55e; }
.locations-group[data-type="preuve"] .locations-group-header .material-icons { color: #8b5cf6; }

.no-locations {
    grid-column: 1 / -1;
    text-align: center;
    color: var(--text-secondary);
    padding: 2rem;
}

/* Leaflet Overrides */
.leaflet-popup-content-wrapper {
    border-radius: 10px;
    padding: 0;
}

.leaflet-popup-content {
    margin: 0.75rem;
}

.leaflet-popup-close-button {
    color: var(--text-secondary) !important;
}

.leaflet-container {
    font-family: 'Inter', sans-serif;
}

/* ===== GEO-MAP TIMELINE SLIDER ===== */
.geo-timeline-slider {
    background: white;
    border-radius: 8px;
    padding: 1rem;
    margin-top: 1rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border: 1px solid var(--border);
}

.timeline-slider-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.75rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--border);
}

.timeline-slider-header h4 {
    margin: 0;
    font-size: 0.9rem;
    color: var(--text-dark);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.timeline-slider-header h4 .material-icons {
    font-size: 1.1rem;
    color: var(--primary);
}

.timeline-events-count {
    font-size: 0.8rem;
    color: var(--text-muted);
    background: var(--bg-light);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
}

.timeline-slider-controls {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.timeline-date-range {
    display: flex;
    justify-content: space-between;
    font-size: 0.85rem;
    color: var(--text-secondary);
}

.timeline-date-range .date-start,
.timeline-date-range .date-end {
    background: var(--bg-subtle);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-weight: 500;
}

.slider-container {
    position: relative;
    height: 40px;
    display: flex;
    align-items: center;
}

.slider-track {
    position: absolute;
    width: 100%;
    height: 6px;
    background: var(--bg-subtle);
    border-radius: 3px;
}

.slider-range {
    position: absolute;
    height: 6px;
    background: linear-gradient(135deg, var(--primary), var(--info));
    border-radius: 3px;
    pointer-events: none;
}

.timeline-slider-controls input[type="range"] {
    position: absolute;
    width: 100%;
    height: 6px;
    -webkit-appearance: none;
    appearance: none;
    background: transparent;
    pointer-events: none;
    margin: 0;
}

.timeline-slider-controls input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: white;
    border: 3px solid var(--primary);
    cursor: pointer;
    pointer-events: auto;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    transition: transform 0.15s ease, box-shadow 0.15s ease;
}

.timeline-slider-controls input[type="range"]::-webkit-slider-thumb:hover {
    transform: scale(1.15);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
}

.timeline-slider-controls input[type="range"]::-moz-range-thumb {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: white;
    border: 3px solid var(--primary);
    cursor: pointer;
    pointer-events: auto;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
}

.timeline-selected-range {
    text-align: center;
    font-size: 0.85rem;
    color: var(--text-dark);
    background: var(--bg-light);
    padding: 0.5rem;
    border-radius: 6px;
    margin-top: 0.25rem;
}

.timeline-selected-range strong {
    color: var(--primary);
}

/* Animation for slider appearance */
.geo-timeline-slider {
    animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ============================================
   Advanced Graph Analysis - SSTorytime Features
   ============================================ */

/* Control sections for SSTorytime features */
.cone-search-controls,
.appointed-controls,
.eigenvector-controls,
.sttypes-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: flex-end;
    padding: 1rem;
    background: var(--bg-subtle);
    border-radius: 8px;
    margin-bottom: 1rem;
}

.cone-search-controls .form-group,
.appointed-controls .form-group,
.eigenvector-controls .form-group {
    margin-bottom: 0;
    flex: 1;
    min-width: 150px;
}

.cone-search-controls label,
.appointed-controls label,
.eigenvector-controls label,
.sttypes-controls label {
    display: block;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-muted);
    margin-bottom: 0.375rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.cone-search-controls .form-select,
.cone-search-controls .form-input,
.appointed-controls .form-input,
.eigenvector-controls .form-input {
    padding: 0.5rem 0.75rem;
    font-size: 0.875rem;
}

.cone-search-controls .btn,
.appointed-controls .btn,
.eigenvector-controls .btn,
.sttypes-controls .btn {
    white-space: nowrap;
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
}

/* Cone Search */
.cone-search-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    background: var(--bg-subtle);
    border-radius: 8px;
    margin-bottom: 1rem;
}

.cone-search-info {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: nowrap;
}

.cone-search-info > * {
    flex-shrink: 0;
}

.cone-search-info .cone-node-name {
    white-space: nowrap;
    color: var(--text-primary);
    font-weight: 600;
    margin-right: 0.5rem;
}

.cone-search-info .cone-separator {
    color: var(--text-muted);
    font-size: 0.875rem;
    margin: 0 0.25rem;
}

.cone-search-info .material-icons {
    color: var(--primary);
}

.cone-direction.badge {
    display: inline-flex;
    width: auto !important;
    height: auto !important;
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    font-size: 0.75rem;
    text-transform: uppercase;
    flex-shrink: 0;
    white-space: nowrap;
}

.cone-direction.forward { background: #dbeafe; color: #1e40af; }
.cone-direction.backward { background: #fce7f3; color: #9d174d; }
.cone-direction.bidirectional { background: #d1fae5; color: #065f46; }

.cone-stats {
    display: flex;
    gap: 1rem;
}

.cone-stats .stat {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.875rem;
    color: var(--text-muted);
}

.cone-stats .stat .material-icons {
    font-size: 1rem;
}

.cone-levels {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.cone-level {
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
}

.cone-level-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 1rem;
    background: var(--bg-subtle);
    border-bottom: 1px solid var(--border);
}

.level-badge {
    background: var(--primary);
    color: white;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 600;
}

.level-count {
    font-size: 0.75rem;
    color: var(--text-muted);
}

.cone-level-nodes {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    padding: 0.75rem;
}

.cone-node {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.35rem 0.65rem;
    background: white;
    border: 1px solid var(--border);
    border-radius: 6px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s ease;
}

.cone-node:hover {
    background: var(--bg-subtle);
    border-color: var(--primary);
}

.cone-node .node-type-icon .material-icons {
    font-size: 0.9rem;
    color: var(--text-muted);
}

.cone-suggestions {
    margin-top: 1rem;
    padding: 1rem;
    background: #fef3c7;
    border-radius: 8px;
}

.cone-suggestions h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.5rem 0;
    font-size: 0.875rem;
    color: #92400e;
}

.cone-suggestions ul {
    margin: 0;
    padding-left: 1.5rem;
}

.cone-suggestions li {
    font-size: 0.8rem;
    color: #78350f;
    margin-bottom: 0.25rem;
}

.cone-paths {
    margin-top: 1rem;
}

.cone-paths h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.5rem 0;
    font-size: 0.875rem;
}

.paths-list {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
}

.path-item {
    padding: 0.5rem 0.75rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    font-size: 0.8rem;
    font-family: monospace;
}

/* Appointed Nodes */
.appointed-header {
    margin-bottom: 1rem;
}

.appointed-stats {
    display: flex;
    gap: 1.5rem;
}

.appointed-stats .stat {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.875rem;
    color: var(--text-dark);
}

.appointed-stats .stat .material-icons {
    font-size: 1.1rem;
    color: var(--primary);
}

.appointed-insights {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.insight-item {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    padding: 0.65rem 0.85rem;
    background: #fef3c7;
    border-radius: 6px;
    font-size: 0.8rem;
    color: #92400e;
}

.insight-item .material-icons {
    font-size: 1rem;
    color: #f59e0b;
}

.appointed-nodes {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.appointed-node {
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.85rem;
    transition: all 0.2s ease;
}

.appointed-node:hover {
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

.appointed-node.danger {
    border-left: 3px solid #ef4444;
}

.appointed-node.warning {
    border-left: 3px solid #f59e0b;
}

.appointed-node-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
}

.appointed-node-header .node-label {
    font-weight: 600;
    color: var(--text-dark);
}

.appointed-node-header .node-type {
    font-size: 0.65rem;
    padding: 0.15rem 0.4rem;
}

.appointed-node-header .pointer-count {
    margin-left: auto;
    font-size: 0.75rem;
    color: var(--text-muted);
    background: var(--bg-subtle);
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
}

.appointed-node-sources {
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem;
    margin-bottom: 0.5rem;
}

.source-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.2rem 0.5rem;
    background: var(--bg-subtle);
    border-radius: 4px;
    font-size: 0.7rem;
}

.source-tag .arrow-type {
    color: var(--primary);
    font-weight: 600;
}

.more-sources {
    font-size: 0.7rem;
    color: var(--text-muted);
    font-style: italic;
}

.correlation-bar {
    position: relative;
    height: 6px;
    background: var(--bg-subtle);
    border-radius: 3px;
    overflow: hidden;
}

.correlation-fill {
    height: 100%;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6);
    border-radius: 3px;
    transition: width 0.3s ease;
}

.correlation-value {
    position: absolute;
    right: 0;
    top: -18px;
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--primary);
}

/* Eigenvector Centrality */
.eigenvector-header {
    margin-bottom: 1rem;
}

.eigenvector-status {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.35rem 0.75rem;
    border-radius: 6px;
    font-size: 0.8rem;
}

.eigenvector-status.success {
    background: #d1fae5;
    color: #065f46;
}

.eigenvector-status.warning {
    background: #fef3c7;
    color: #92400e;
}

.eigenvector-status .material-icons {
    font-size: 1rem;
}

.eigenvector-insights {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.eigenvector-ranking {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.eigenvector-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.65rem 0.85rem;
    border: 1px solid var(--border);
    border-radius: 8px;
    transition: all 0.2s ease;
}

.eigenvector-item:hover {
    background: var(--bg-subtle);
}

.eigenvector-item.high {
    border-left: 3px solid #ef4444;
    background: rgba(239, 68, 68, 0.03);
}

.eigenvector-item.medium {
    border-left: 3px solid #f59e0b;
}

.eigenvector-item .rank {
    font-weight: 700;
    font-size: 0.9rem;
    color: var(--primary);
    min-width: 30px;
}

.eigenvector-item .item-info {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.eigenvector-item .item-label {
    font-weight: 500;
}

.eigenvector-item .item-type {
    font-size: 0.65rem;
    padding: 0.15rem 0.4rem;
}

.eigenvector-item .score-bar {
    width: 100px;
    height: 6px;
    background: var(--bg-subtle);
    border-radius: 3px;
    overflow: hidden;
}

.eigenvector-item .score-fill {
    height: 100%;
    background: linear-gradient(90deg, #10b981, #3b82f6);
    border-radius: 3px;
}

.eigenvector-item .score-value {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-dark);
    min-width: 45px;
    text-align: right;
}

/* ST Type Analysis */
.sttype-analysis-content {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.sttype-distribution h4,
.sttype-chains h4,
.sttype-containers h4,
.sttype-insights h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.75rem 0;
    font-size: 0.9rem;
    color: var(--text-dark);
}

.sttype-bars {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.sttype-bar-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.sttype-info {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    min-width: 140px;
}

.sttype-symbol {
    font-size: 1.25rem;
    font-weight: 700;
    width: 24px;
    text-align: center;
}

.sttype-name {
    font-size: 0.8rem;
    font-weight: 500;
}

.sttype-code {
    font-size: 0.65rem;
    color: var(--text-muted);
    background: var(--bg-subtle);
    padding: 0.1rem 0.3rem;
    border-radius: 3px;
}

.sttype-bar {
    flex: 1;
    height: 8px;
    background: var(--bg-subtle);
    border-radius: 4px;
    overflow: hidden;
}

.sttype-bar-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.3s ease;
}

.sttype-count {
    font-size: 0.75rem;
    color: var(--text-muted);
    min-width: 70px;
    text-align: right;
}

.chains-list,
.containers-list {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
}

.chain-item {
    padding: 0.5rem 0.75rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    font-size: 0.8rem;
    font-family: monospace;
}

.container-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: var(--bg-subtle);
    border-radius: 6px;
    font-size: 0.8rem;
}

.container-name {
    font-weight: 600;
    color: var(--primary);
}

.contains-icon {
    color: #10b981;
    font-size: 1.1rem;
}

.contained-items {
    color: var(--text-muted);
}

/* Advanced Summary Cards */
.advanced-summary-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 0.75rem;
}

.summary-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem;
    background: var(--bg-subtle);
    border-radius: 8px;
    text-align: center;
}

.summary-card .material-icons {
    font-size: 1.5rem;
    color: var(--primary);
    margin-bottom: 0.35rem;
}

.summary-card .value {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-dark);
}

.summary-card .label {
    font-size: 0.7rem;
    color: var(--text-muted);
    text-transform: uppercase;
}

.summary-card.success {
    background: #d1fae5;
}

.summary-card.success .material-icons {
    color: #065f46;
}

.summary-card.warning {
    background: #fef3c7;
}

.summary-card.warning .material-icons {
    color: #92400e;
}

/* Rotating animation for loading */
@keyframes rotating {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.rotating {
    animation: rotating 1s linear infinite;
}

/* ============================================
   SSTorytime Advanced Features
   ============================================ */

/* SSTorytime Section */
.sstorytime-section {
    background: var(--bg-light);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
    border: 1px solid var(--border-color);
}

.sstorytime-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.5rem 0;
    color: var(--text-dark);
    font-size: 1rem;
}

.sstorytime-section h4 .material-icons {
    color: var(--primary);
}

.sstorytime-section .section-description {
    color: var(--text-muted);
    font-size: 0.85rem;
    margin-bottom: 1rem;
}

/* Contrawave Controls */
.contrawave-controls .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr auto;
    gap: 1rem;
    margin-bottom: 1rem;
}

.contrawave-controls select[multiple] {
    min-height: 100px;
}

/* Contrawave Results */
.contrawave-results {
    margin-top: 1rem;
}

.contrawave-summary {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
}

.contrawave-summary .summary-stat,
.supernodes-summary .summary-stat,
.betweenness-summary .summary-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: white;
    padding: 0.75rem 1rem;
    border-radius: 8px;
    border: 1px solid var(--border-color);
    min-width: 100px;
}

.contrawave-summary .summary-stat .material-icons,
.supernodes-summary .summary-stat .material-icons,
.betweenness-summary .summary-stat .material-icons {
    color: var(--primary);
    font-size: 1.25rem;
    margin-bottom: 0.25rem;
}

.contrawave-summary .summary-stat .value,
.supernodes-summary .summary-stat .value,
.betweenness-summary .summary-stat .value {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-dark);
}

.contrawave-summary .summary-stat .label,
.supernodes-summary .summary-stat .label,
.betweenness-summary .summary-stat .label {
    font-size: 0.7rem;
    color: var(--text-muted);
    text-transform: uppercase;
}

/* Collision Nodes */
.collision-nodes,
.supernode-groups,
.betweenness-ranking {
    margin-top: 1rem;
}

.collision-nodes h4,
.supernode-groups h4,
.betweenness-ranking h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
    color: var(--text-dark);
    font-size: 0.9rem;
}

.collision-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.collision-item {
    background: white;
    border-radius: 8px;
    padding: 0.75rem;
    border: 1px solid var(--border-color);
    border-left: 3px solid var(--primary);
}

.collision-item .collision-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex-wrap: wrap;
    margin-bottom: 0.5rem;
}

.collision-item .collision-header > * {
    margin-right: 0.25rem;
}

.collision-item .node-label {
    font-weight: 600;
    color: var(--text-dark);
}

.collision-item .node-type.badge {
    font-size: 0.7rem;
    padding: 0.15rem 0.5rem;
    background: var(--bg-light);
    border-radius: 4px;
    color: var(--text-muted);
}

.criticality-badge {
    font-size: 0.7rem;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    font-weight: 600;
}

.criticality-badge.high {
    background: #fee2e2;
    color: #991b1b;
}

.criticality-badge.medium {
    background: #fef3c7;
    color: #92400e;
}

.criticality-badge.low {
    background: #d1fae5;
    color: #065f46;
}

.collision-item .collision-details {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.collision-item .collision-details .detail {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.8rem;
    color: var(--text-muted);
}

.collision-item .collision-details .detail .material-icons {
    font-size: 0.9rem;
}

/* Super-Nodes Styles */
.supernodes-summary {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
}

.supernode-group {
    background: white;
    border-radius: 8px;
    padding: 0.75rem;
    margin-bottom: 0.5rem;
    border: 1px solid var(--border-color);
}

.supernode-group.replaceable {
    border-left: 3px solid #059669;
}

.supernode-group .group-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
    margin-bottom: 0.5rem;
}

.supernode-group .group-id {
    font-weight: 600;
    color: var(--text-dark);
    font-size: 0.85rem;
}

.supernode-group .equivalence-badge {
    font-size: 0.65rem;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    text-transform: uppercase;
    font-weight: 600;
}

.supernode-group .equivalence-badge.structural {
    background: #dbeafe;
    color: #1e40af;
}

.supernode-group .equivalence-badge.role {
    background: #fae8ff;
    color: #86198f;
}

.supernode-group .equivalence-badge.flow {
    background: #d1fae5;
    color: #065f46;
}

.supernode-group .size-badge {
    font-size: 0.7rem;
    color: var(--text-muted);
}

.supernode-group .replaceable-badge {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.7rem;
    color: #059669;
}

.supernode-group .replaceable-badge .material-icons {
    font-size: 0.9rem;
}

.supernode-group .group-nodes {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
}

.supernode-item {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    background: var(--bg-light);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.8rem;
}

.supernode-item .node-label {
    font-weight: 500;
}

.supernode-item .node-type {
    color: var(--text-muted);
    font-size: 0.7rem;
}

.supernode-item .similarity {
    color: var(--primary);
    font-weight: 600;
    font-size: 0.7rem;
}

.supernode-group .group-description {
    font-size: 0.8rem;
    color: var(--text-muted);
    font-style: italic;
}

/* Betweenness Styles */
.betweenness-summary {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
}

.ranking-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.ranking-item {
    display: grid;
    grid-template-columns: 40px 1fr 120px auto;
    align-items: center;
    gap: 0.75rem;
    background: white;
    border-radius: 8px;
    padding: 0.5rem 0.75rem;
    border: 1px solid var(--border-color);
}

.ranking-item.bridge {
    border-left: 3px solid #dc2626;
}

.ranking-item.hub {
    border-left: 3px solid #f59e0b;
}

.ranking-item.peripheral {
    border-left: 3px solid var(--border-color);
}

.ranking-item .rank {
    font-weight: 700;
    color: var(--text-muted);
    font-size: 0.85rem;
}

.ranking-item .node-info {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.ranking-item .node-label {
    font-weight: 600;
    color: var(--text-dark);
}

.ranking-item .node-type.badge {
    font-size: 0.65rem;
    padding: 0.1rem 0.35rem;
    background: var(--bg-light);
    border-radius: 4px;
    color: var(--text-muted);
}

.betweenness-bar-container {
    background: var(--bg-light);
    border-radius: 4px;
    height: 8px;
    overflow: hidden;
}

.betweenness-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--primary) 0%, #3b82f6 100%);
    border-radius: 4px;
    transition: width 0.3s ease;
}

.ranking-item .role-badge {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.7rem;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    white-space: nowrap;
}

.ranking-item .role-badge .material-icons {
    font-size: 0.85rem;
}

.ranking-item .role-badge.bridge {
    background: #fee2e2;
    color: #991b1b;
}

.ranking-item .role-badge.hub {
    background: #fef3c7;
    color: #92400e;
}

.ranking-item .role-badge.peripheral {
    background: var(--bg-light);
    color: var(--text-muted);
}

/* SSTorytime Complete Summary */
.sstorytime-complete-summary {
    background: white;
    border-radius: 8px;
    padding: 1rem;
    margin-top: 1rem;
    border: 1px solid var(--border-color);
}

.sstorytime-complete-summary h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 1rem 0;
    color: var(--text-dark);
}

.sstorytime-complete-summary h4 .material-icons {
    color: var(--primary);
}

.sstorytime-complete-summary .summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 0.75rem;
}

/* Insights Styles for all SSTorytime features */
.contrawave-insights,
.supernodes-insights,
.betweenness-insights {
    margin-top: 1rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border-color);
}

.contrawave-insights h4,
.supernodes-insights h4,
.betweenness-insights h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
    color: var(--text-dark);
    font-size: 0.9rem;
}

.contrawave-insights .insight-item,
.supernodes-insights .insight-item,
.betweenness-insights .insight-item {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    padding: 0.5rem;
    background: #f0f9ff;
    border-radius: 6px;
    margin-bottom: 0.5rem;
    font-size: 0.85rem;
    color: var(--text-dark);
}

.contrawave-insights .insight-item .material-icons,
.supernodes-insights .insight-item .material-icons,
.betweenness-insights .insight-item .material-icons {
    color: #0284c7;
    font-size: 1rem;
    flex-shrink: 0;
}

/* ============================================
   Chemins Contraints Styles
   ============================================ */
.constrained-controls .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1rem;
}

.constrained-paths-summary {
    background: linear-gradient(135deg, #faf5ff, #f3e8ff);
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
}

.constrained-paths-summary h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.75rem;
    color: #7c3aed;
}

.constrained-paths-summary .stats-row {
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
}

.constrained-paths-summary .stat {
    font-size: 0.85rem;
    color: var(--text-dark);
}

.used-types {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
    margin-bottom: 1rem;
}

.used-types .label {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.type-badge {
    background: #ede9fe;
    color: #6d28d9;
    padding: 0.2rem 0.6rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 500;
}

.paths-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.path-item {
    background: white;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 0.75rem;
}

.path-item .path-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
}

.path-item .path-number {
    background: #7c3aed;
    color: white;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 600;
}

.path-item .path-length {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.path-item .path-nodes {
    font-size: 0.85rem;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
}

.path-item .path-relations {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.relation-badge {
    background: #fef3c7;
    color: #b45309;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 500;
}

.no-results {
    text-align: center;
    padding: 2rem;
    color: var(--text-muted);
    font-style: italic;
}

/* ============================================
   Notation Dirac Styles
   ============================================ */
.dirac-controls .form-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin-bottom: 1rem;
}

.dirac-controls .form-group-wide {
    grid-column: span 2;
}

.form-help {
    display: block;
    font-size: 0.75rem;
    color: var(--text-muted);
    margin-top: 0.25rem;
}

/* Dirac Examples */
.dirac-examples {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.dirac-examples .example-label {
    font-size: 0.7rem;
    color: var(--text-muted);
    margin-right: 0.25rem;
    align-self: center;
}

.dirac-example {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.5rem;
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    font-size: 0.75rem;
    font-family: monospace;
    color: var(--primary-color);
    cursor: pointer;
    transition: all 0.2s ease;
}

.dirac-example:hover {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
    transform: translateY(-1px);
}

.dirac-example .example-type {
    font-size: 0.65rem;
    color: var(--text-muted);
    margin-left: 0.4rem;
    font-family: var(--font-sans);
}

.dirac-example:hover .example-type {
    color: rgba(255, 255, 255, 0.8);
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 0.85rem;
}

.dirac-summary {
    background: linear-gradient(135deg, #ecfdf5, #d1fae5);
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
}

.dirac-summary h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.75rem;
    color: #059669;
}

.dirac-equation {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.25rem;
    font-family: 'Courier New', monospace;
    font-size: 1.25rem;
    font-weight: 600;
    padding: 0.75rem;
    background: white;
    border-radius: 6px;
    margin-bottom: 0.75rem;
}

.dirac-equation .bra {
    color: #7c3aed;
}

.dirac-equation .pipe {
    color: var(--text-muted);
}

.dirac-equation .ket {
    color: #059669;
}

.dirac-stats {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
}

.dirac-stats .stat {
    font-size: 0.85rem;
    color: var(--text-dark);
}

.dirac-paths-section {
    margin-bottom: 1rem;
}

.dirac-paths-section h5 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.75rem;
    font-size: 0.9rem;
    color: var(--text-dark);
}

.symmetry-analysis {
    background: #f0f9ff;
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
}

.symmetry-analysis h5 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.75rem;
    font-size: 0.9rem;
    color: #0369a1;
}

.symmetry-stats {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.symmetry-stats .stat {
    font-size: 0.85rem;
    padding: 0.25rem 0.75rem;
    background: white;
    border-radius: 4px;
}

.symmetry-stats .stat.success {
    background: #d1fae5;
    color: #065f46;
}

/* ============================================
   Orbites Styles
   ============================================ */
.orbits-controls .form-row {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 1rem;
    margin-bottom: 1rem;
}

.orbits-summary {
    background: linear-gradient(135deg, #fff7ed, #fed7aa);
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
}

.orbits-summary h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.75rem;
    color: #c2410c;
}

.orbit-stats {
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
}

.orbit-stats .stat {
    font-size: 0.85rem;
    color: var(--text-dark);
}

.expansion-pattern {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    margin-bottom: 1rem;
    font-size: 0.85rem;
}

.expansion-pattern.expansion {
    background: #d1fae5;
    color: #065f46;
}

.expansion-pattern.contraction {
    background: #fee2e2;
    color: #991b1b;
}

.expansion-pattern.stable {
    background: #e0e7ff;
    color: #3730a3;
}

.orbits-visualization {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.orbit-level {
    background: white;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 0.75rem;
    position: relative;
}

.orbit-level::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 4px;
    border-radius: 8px 0 0 8px;
}

.orbit-level.level-1::before { background: #f97316; }
.orbit-level.level-2::before { background: #fb923c; }
.orbit-level.level-3::before { background: #fdba74; }
.orbit-level.level-4::before { background: #fed7aa; }

.orbit-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
    flex-wrap: wrap;
}

.level-badge {
    background: #ea580c;
    color: white;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 600;
}

.node-count {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.density {
    font-size: 0.75rem;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
}

.density.density-high {
    background: #d1fae5;
    color: #065f46;
}

.density.density-medium {
    background: #fef3c7;
    color: #92400e;
}

.density.density-low {
    background: #fee2e2;
    color: #991b1b;
}

.orbit-nodes {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
}

.orbit-node {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    background: #f8fafc;
    border: 1px solid var(--border-color);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.8rem;
}

.orbit-node .connection-count {
    background: #e2e8f0;
    color: var(--text-muted);
    padding: 0.1rem 0.3rem;
    border-radius: 3px;
    font-size: 0.65rem;
}

.more-nodes {
    font-size: 0.8rem;
    color: var(--text-muted);
    font-style: italic;
}

.type-breakdown {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.type-stat {
    font-size: 0.75rem;
    color: var(--text-muted);
    background: #f1f5f9;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
}

.dense-clusters {
    background: #fef3c7;
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
}

.dense-clusters h5 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.75rem;
    font-size: 0.9rem;
    color: #b45309;
}

.clusters-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.cluster-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    background: white;
    padding: 0.5rem 0.75rem;
    border-radius: 6px;
    font-size: 0.85rem;
}

.cluster-level {
    font-weight: 600;
    color: var(--text-dark);
}

.cluster-density {
    color: #065f46;
}

.cluster-nodes {
    color: var(--text-muted);
}

/* Insights section common styles */
.insights-section {
    background: #f0f9ff;
    padding: 1rem;
    border-radius: 8px;
}

.insights-section h5 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0 0 0.75rem;
    font-size: 0.9rem;
    color: #0369a1;
}

.insights-section ul {
    margin: 0;
    padding-left: 1.25rem;
}

.insights-section li {
    font-size: 0.85rem;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .contrawave-controls .form-row,
    .constrained-controls .form-row,
    .dirac-controls .form-row,
    .orbits-controls .form-row {
        grid-template-columns: 1fr;
    }

    .dirac-controls .form-group-wide {
        grid-column: span 1;
    }

    .ranking-item {
        grid-template-columns: 30px 1fr;
        gap: 0.5rem;
    }

    .ranking-item .betweenness-bar-container,
    .ranking-item .role-badge {
        display: none;
    }
}

/* ============================================
   WHAT-IF SCENARIOS STYLES
   ============================================ */

#view-scenarios {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding: 1.5rem;
    gap: 1rem;
    overflow: hidden;
}

.scenarios-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
}

.scenarios-header h2 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0;
    color: var(--text-dark);
}

.scenarios-content {
    display: grid;
    grid-template-columns: 350px 1fr 350px;
    gap: 1rem;
    flex: 1;
    min-height: 0;
    overflow: hidden;
}

#scenarios-list {
    background: white;
    border-radius: 12px;
    box-shadow: var(--shadow-sm);
    padding: 1rem;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.scenario-card {
    background: #f8fafc;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    cursor: pointer;
    transition: all 0.2s;
}

.scenario-card:hover {
    border-color: var(--primary);
    box-shadow: var(--shadow-sm);
}

.scenario-card.selected {
    border-color: var(--primary);
    background: #eff6ff;
}

.scenario-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5rem;
}

.scenario-card-title {
    font-weight: 600;
    color: var(--text-dark);
    font-size: 0.95rem;
}

.scenario-type-badge {
    font-size: 0.7rem;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    font-weight: 500;
    text-transform: uppercase;
}

.scenario-type-badge.guilt {
    background: #fef2f2;
    color: #dc2626;
}

.scenario-type-badge.alibi {
    background: #f0fdf4;
    color: #16a34a;
}

.scenario-type-badge.motive {
    background: #fefce8;
    color: #ca8a04;
}

.scenario-type-badge.timeline {
    background: #eff6ff;
    color: #2563eb;
}

.scenario-type-badge.relation {
    background: #faf5ff;
    color: #9333ea;
}

.scenario-type-badge.presence {
    background: #ecfeff;
    color: #0891b2;
}

.scenario-card-description {
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-bottom: 0.75rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.scenario-card-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.plausibility-indicator {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.plausibility-bar {
    width: 60px;
    height: 6px;
    background: #e2e8f0;
    border-radius: 3px;
    overflow: hidden;
}

.plausibility-fill {
    height: 100%;
    border-radius: 3px;
    transition: width 0.3s;
}

.plausibility-fill.high {
    background: linear-gradient(90deg, #22c55e, #16a34a);
}

.plausibility-fill.medium {
    background: linear-gradient(90deg, #eab308, #ca8a04);
}

.plausibility-fill.low {
    background: linear-gradient(90deg, #ef4444, #dc2626);
}

.plausibility-value {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-dark);
}

.implications-count {
    font-size: 0.75rem;
    color: var(--text-muted);
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.implications-count .material-icons {
    font-size: 14px;
}

#scenario-graph-container {
    background: white;
    border-radius: 12px;
    box-shadow: var(--shadow-sm);
    position: relative;
    overflow: hidden;
}

#scenario-graph {
    width: 100%;
    height: 100%;
}

.scenario-graph-legend {
    position: absolute;
    bottom: 1rem;
    left: 1rem;
    background: rgba(255, 255, 255, 0.95);
    border-radius: 8px;
    padding: 0.75rem;
    font-size: 0.8rem;
    box-shadow: var(--shadow-sm);
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.25rem;
}

.legend-item:last-child {
    margin-bottom: 0;
}

.legend-color {
    width: 12px;
    height: 12px;
    border-radius: 3px;
}

.legend-color.modified {
    background: #f97316;
}

.legend-color.affected {
    background: #fbbf24;
}

.legend-color.original {
    background: #94a3b8;
}

#scenario-detail-panel {
    background: white;
    border-radius: 12px;
    box-shadow: var(--shadow-sm);
    padding: 1.5rem;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.scenario-detail-header {
    border-bottom: 1px solid var(--border);
    padding-bottom: 1rem;
    margin-bottom: 1rem;
}

.scenario-detail-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
}

.scenario-detail-meta {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    font-size: 0.85rem;
    color: var(--text-muted);
}

.scenario-section {
    margin-bottom: 1.5rem;
}

.scenario-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    color: var(--text-dark);
    margin-bottom: 0.75rem;
}

.scenario-section h4 .material-icons {
    font-size: 18px;
    color: var(--primary);
}

.implications-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.implication-item {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 0.75rem;
    background: #f8fafc;
    border-radius: 6px;
    font-size: 0.85rem;
}

.implication-icon {
    color: #f97316;
    font-size: 18px !important;
}

.implication-text {
    flex: 1;
    color: var(--text-dark);
}

.implication-confidence {
    font-size: 0.75rem;
    padding: 0.15rem 0.5rem;
    background: #e2e8f0;
    border-radius: 4px;
    color: var(--text-muted);
}

.scenario-actions {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-top: auto;
    padding-top: 1rem;
    border-top: 1px solid var(--border);
}

.scenario-actions .btn {
    justify-content: center;
}

/* Scenario Comparison Modal */
.comparison-container {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 1.5rem;
    padding: 1rem 0;
}

.comparison-scenario {
    background: #f8fafc;
    border-radius: 8px;
    padding: 1.25rem;
}

.comparison-scenario h4 {
    margin: 0 0 1rem;
    color: var(--text-dark);
    font-size: 1rem;
}

.comparison-stats {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.comparison-stat {
    display: flex;
    justify-content: space-between;
    font-size: 0.85rem;
}

.comparison-stat-label {
    color: var(--text-muted);
}

.comparison-stat-value {
    font-weight: 600;
    color: var(--text-dark);
}

.comparison-vs {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-muted);
}

.comparison-differences {
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border);
}

.comparison-differences h4 {
    margin: 0 0 1rem;
    color: var(--text-dark);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.differences-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.difference-item {
    display: grid;
    grid-template-columns: 80px 1fr 1fr;
    gap: 1rem;
    padding: 0.75rem;
    background: #f8fafc;
    border-radius: 6px;
    font-size: 0.85rem;
}

.difference-aspect {
    font-weight: 600;
    color: var(--text-dark);
}

.difference-value {
    color: var(--text-muted);
}

.difference-value.scenario-a {
    color: #2563eb;
}

.difference-value.scenario-b {
    color: #16a34a;
}

/* Create Scenario Modal */
.scenario-form {
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
}

.scenario-form .form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.scenario-form label {
    font-weight: 500;
    color: var(--text-dark);
    font-size: 0.9rem;
}

.scenario-form input,
.scenario-form select,
.scenario-form textarea {
    padding: 0.75rem;
    border: 1px solid var(--border);
    border-radius: 6px;
    font-size: 0.9rem;
}

.scenario-form textarea {
    min-height: 80px;
    resize: vertical;
}

/* ============================================
   ANOMALY DETECTION STYLES
   ============================================ */

#view-anomalies {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding: 1.5rem;
    gap: 1rem;
    overflow: hidden;
}

.anomalies-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
}

.anomalies-header h2 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0;
    color: var(--text-dark);
}

.anomaly-stats-bar {
    display: flex;
    gap: 1rem;
    padding: 1rem;
    background: white;
    border-radius: 8px;
    box-shadow: var(--shadow-sm);
    flex-shrink: 0;
}

.anomaly-stat-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.5rem 1rem;
    background: #f8fafc;
    border-radius: 6px;
    flex: 1;
}

.anomaly-stat-icon {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.anomaly-stat-icon .material-icons {
    font-size: 22px;
    color: white;
}

.anomaly-stat-icon.critical {
    background: linear-gradient(135deg, #dc2626, #b91c1c);
}

.anomaly-stat-icon.high {
    background: linear-gradient(135deg, #ea580c, #c2410c);
}

.anomaly-stat-icon.medium {
    background: linear-gradient(135deg, #ca8a04, #a16207);
}

.anomaly-stat-icon.low {
    background: linear-gradient(135deg, #65a30d, #4d7c0f);
}

.anomaly-stat-info {
    display: flex;
    flex-direction: column;
}

.anomaly-stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-dark);
    line-height: 1;
}

.anomaly-stat-label {
    font-size: 0.75rem;
    color: var(--text-muted);
    text-transform: uppercase;
}

.anomalies-content {
    display: grid;
    grid-template-columns: 1fr 400px;
    gap: 1rem;
    flex: 1;
    min-height: 0;
    overflow: hidden;
}

.anomalies-list-container {
    background: white;
    border-radius: 12px;
    box-shadow: var(--shadow-sm);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.anomalies-filters {
    display: flex;
    gap: 0.75rem;
    padding: 1rem;
    border-bottom: 1px solid var(--border);
    flex-wrap: wrap;
}

.anomalies-filters select {
    padding: 0.5rem 0.75rem;
    border: 1px solid var(--border);
    border-radius: 6px;
    font-size: 0.85rem;
    background: white;
}

#anomalies-list {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.anomaly-card {
    background: #f8fafc;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    cursor: pointer;
    transition: all 0.2s;
}

.anomaly-card:hover {
    border-color: var(--primary);
    box-shadow: var(--shadow-sm);
}

.anomaly-card.selected {
    border-color: var(--primary);
    background: #eff6ff;
}

.anomaly-card.acknowledged {
    opacity: 0.7;
}

.anomaly-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5rem;
}

.anomaly-card-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    color: var(--text-dark);
    font-size: 0.95rem;
}

.anomaly-card-title .material-icons {
    font-size: 18px;
}

.severity-badge {
    font-size: 0.7rem;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-weight: 600;
    text-transform: uppercase;
}

.severity-badge.critical {
    background: #fef2f2;
    color: #dc2626;
}

.severity-badge.high {
    background: #fff7ed;
    color: #ea580c;
}

.severity-badge.medium {
    background: #fefce8;
    color: #ca8a04;
}

.severity-badge.low {
    background: #f0fdf4;
    color: #16a34a;
}

.anomaly-type-badge {
    font-size: 0.7rem;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    background: #e2e8f0;
    color: var(--text-muted);
}

.anomaly-card-description {
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-bottom: 0.75rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.anomaly-card-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.75rem;
    color: var(--text-muted);
}

.anomaly-confidence {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.anomaly-entities {
    display: flex;
    gap: 0.25rem;
}

.entity-chip {
    padding: 0.1rem 0.4rem;
    background: #dbeafe;
    color: #2563eb;
    border-radius: 4px;
    font-size: 0.7rem;
}

#anomaly-detail-panel {
    background: white;
    border-radius: 12px;
    box-shadow: var(--shadow-sm);
    padding: 1.5rem;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.anomaly-detail-header {
    border-bottom: 1px solid var(--border);
    padding-bottom: 1rem;
    margin-bottom: 1rem;
}

.anomaly-detail-title {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
}

.anomaly-detail-title h3 {
    margin: 0;
    font-size: 1.1rem;
    color: var(--text-dark);
}

.anomaly-detail-meta {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    font-size: 0.85rem;
    color: var(--text-muted);
}

.anomaly-section {
    margin-bottom: 1.5rem;
}

.anomaly-section h4 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    color: var(--text-dark);
    margin-bottom: 0.75rem;
}

.anomaly-section h4 .material-icons {
    font-size: 18px;
    color: #ea580c;
}

.anomaly-details-content {
    background: #f8fafc;
    border-radius: 6px;
    padding: 1rem;
    font-size: 0.85rem;
}

.anomaly-detail-row {
    display: flex;
    justify-content: space-between;
    padding: 0.5rem 0;
    border-bottom: 1px solid #e2e8f0;
}

.anomaly-detail-row:last-child {
    border-bottom: none;
}

.anomaly-detail-label {
    color: var(--text-muted);
}

.anomaly-detail-value {
    font-weight: 500;
    color: var(--text-dark);
}

.related-entities-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.related-entity-tag {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.4rem 0.75rem;
    background: #dbeafe;
    color: #2563eb;
    border-radius: 6px;
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.2s;
}

.related-entity-tag:hover {
    background: #bfdbfe;
}

.related-entity-tag .material-icons {
    font-size: 16px;
}

.ai-explanation {
    background: linear-gradient(135deg, #eff6ff, #f0f9ff);
    border: 1px solid #bfdbfe;
    border-radius: 8px;
    padding: 1rem;
}

.ai-explanation-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
    font-weight: 600;
    color: var(--primary);
}

.ai-explanation-content {
    font-size: 0.9rem;
    color: var(--text-dark);
    line-height: 1.6;
}

.anomaly-actions {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-top: auto;
    padding-top: 1rem;
    border-top: 1px solid var(--border);
}

.anomaly-actions .btn {
    justify-content: center;
}

/* Detection Summary Modal Enhanced */
.detection-summary-enhanced {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.detection-summary-enhanced .summary-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border);
}

.detection-summary-enhanced .summary-icon {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.detection-summary-enhanced .summary-icon.critical {
    background: linear-gradient(135deg, #dc2626, #b91c1c);
    animation: pulse-critical 2s infinite;
}

.detection-summary-enhanced .summary-icon.warning {
    background: linear-gradient(135deg, #f97316, #ea580c);
}

.detection-summary-enhanced .summary-icon.success {
    background: linear-gradient(135deg, #22c55e, #16a34a);
}

.detection-summary-enhanced .summary-icon .material-icons {
    color: white;
    font-size: 28px;
}

@keyframes pulse-critical {
    0%, 100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.4); }
    50% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
}

.detection-summary-enhanced .summary-title h3 {
    margin: 0;
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text);
}

.detection-summary-enhanced .summary-title p {
    margin: 0.25rem 0 0;
    font-size: 0.875rem;
    color: var(--text-muted);
}

/* Severity Breakdown Bar */
.severity-breakdown {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.severity-bar {
    display: flex;
    height: 8px;
    border-radius: 4px;
    overflow: hidden;
    background: var(--bg-secondary);
}

.severity-segment {
    transition: flex 0.3s ease;
}

.severity-segment.critical {
    background: linear-gradient(90deg, #dc2626, #ef4444);
}

.severity-segment.high {
    background: linear-gradient(90deg, #f97316, #fb923c);
}

.severity-segment.other {
    background: linear-gradient(90deg, #6b7280, #9ca3af);
}

.severity-legend {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    font-size: 0.75rem;
}

.severity-legend .legend-item {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    color: var(--text-muted);
}

.severity-legend .legend-item .dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
}

.severity-legend .legend-item.critical .dot {
    background: #dc2626;
}

.severity-legend .legend-item.high .dot {
    background: #f97316;
}

.severity-legend .legend-item.other .dot {
    background: #6b7280;
}

/* Detection Types */
.detection-types {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.detection-types h4 {
    margin: 0;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.detection-type-group {
    background: var(--bg-secondary);
    border-radius: 8px;
    padding: 0.75rem;
}

.detection-type-group .type-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
}

.detection-type-group .type-header .material-icons {
    font-size: 18px;
    color: var(--primary);
}

.detection-type-group .type-name {
    font-weight: 500;
    flex: 1;
}

.detection-type-group .type-count {
    background: var(--primary);
    color: white;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 0.125rem 0.5rem;
    border-radius: 10px;
}

.detection-type-group .type-items {
    display: flex;
    flex-direction: column;
    gap: 0.375rem;
    padding-left: 1.75rem;
}

.detection-type-group .type-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8125rem;
    color: var(--text-secondary);
}

.detection-type-group .type-item .severity-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    flex-shrink: 0;
}

.detection-type-group .type-item.severity-critical .severity-dot {
    background: #dc2626;
}

.detection-type-group .type-item.severity-high .severity-dot {
    background: #f97316;
}

.detection-type-group .type-item.severity-medium .severity-dot {
    background: #eab308;
}

.detection-type-group .type-item.severity-low .severity-dot {
    background: #6b7280;
}

.detection-type-group .type-item.more {
    color: var(--text-muted);
    font-style: italic;
    font-size: 0.75rem;
}

/* Detection Alert */
.detection-alert {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    background: linear-gradient(135deg, #fef3c7, #fde68a);
    border: 1px solid #f59e0b;
    border-radius: 8px;
    padding: 0.875rem;
}

.detection-alert .material-icons {
    color: #d97706;
    font-size: 20px;
    flex-shrink: 0;
}

.detection-alert p {
    margin: 0;
    font-size: 0.8125rem;
    color: #92400e;
    line-height: 1.4;
}

/* Anomaly Alert Banner */
.anomaly-alerts-banner {
    background: linear-gradient(135deg, #fef2f2, #fee2e2);
    border: 1px solid #fca5a5;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 1rem;
}

.alert-icon {
    width: 40px;
    height: 40px;
    background: #dc2626;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: pulse-alert 2s infinite;
}

.alert-icon .material-icons {
    color: white;
    font-size: 22px;
}

@keyframes pulse-alert {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

.alert-content {
    flex: 1;
}

.alert-title {
    font-weight: 600;
    color: #991b1b;
    margin-bottom: 0.25rem;
}

.alert-message {
    font-size: 0.85rem;
    color: #b91c1c;
}

.alert-actions {
    display: flex;
    gap: 0.5rem;
}

/* Empty States */
.scenarios-empty-state,
.anomalies-empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 3rem;
    text-align: center;
    color: var(--text-muted);
}

.scenarios-empty-state .material-icons,
.anomalies-empty-state .material-icons {
    font-size: 64px;
    color: #cbd5e1;
    margin-bottom: 1rem;
}

.scenarios-empty-state h4,
.anomalies-empty-state h4 {
    margin: 0 0 0.5rem;
    color: var(--text-dark);
}

.scenarios-empty-state p,
.anomalies-empty-state p {
    margin: 0;
    font-size: 0.9rem;
}

/* Responsive */
@media (max-width: 1200px) {
    .scenarios-content {
        grid-template-columns: 300px 1fr;
    }

    #scenario-detail-panel {
        display: none;
    }

    .anomalies-content {
        grid-template-columns: 1fr;
    }

    #anomaly-detail-panel {
        display: none;
    }
}

@media (max-width: 768px) {
    .scenarios-content {
        grid-template-columns: 1fr;
    }

    #scenario-graph-container {
        display: none;
    }

    .anomaly-stats-bar {
        flex-wrap: wrap;
    }

    .anomaly-stat-item {
        min-width: calc(50% - 0.5rem);
    }
}

/* ============================================
   SCENARIOS TWO-COLUMN LAYOUT
   ============================================ */

.scenarios-two-columns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    height: 100%;
    min-height: 0;
}

.scenarios-left-column {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    min-height: 0;
    overflow: hidden;
}

.scenarios-left-column .panel:first-child {
    flex-shrink: 0;
    max-height: 50%;
}

.scenarios-left-column .panel:first-child .panel-content {
    overflow-y: auto;
    max-height: 300px;
}

.scenarios-left-column .panel:last-child {
    flex: 1;
    min-height: 0;
    display: flex;
    flex-direction: column;
}

.scenarios-left-column .panel:last-child .panel-content {
    flex: 1;
    overflow-y: auto;
}

.scenarios-right-column {
    display: flex;
    flex-direction: column;
    min-height: 0;
}

.scenarios-right-column .panel {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
}

.scenarios-right-column .panel-content {
    flex: 1;
    min-height: 400px;
}

.scenario-graph-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.scenario-graph-panel #scenario-graph-container {
    flex: 1;
    min-height: 400px;
}

/* Responsive: scenarios single column on small screens */
@media (max-width: 1200px) {
    .scenarios-two-columns {
        grid-template-columns: 1fr;
        overflow-y: auto;
    }

    .scenarios-left-column,
    .scenarios-right-column {
        overflow: visible;
    }

    .scenarios-left-column .panel:first-child {
        max-height: none;
    }

    .scenarios-left-column .panel:first-child .panel-content {
        max-height: 350px;
    }

    .scenarios-right-column .panel-content {
        min-height: 350px;
    }
}

/* ============================================
   ANOMALIES TWO-COLUMN LAYOUT
   ============================================ */

.anomalies-two-columns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    height: 100%;
    min-height: 0;
}

.anomalies-left-column {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    min-height: 0;
    overflow: hidden;
}

.anomalies-left-column .panel:first-child {
    flex-shrink: 0;
}

.anomalies-left-column .panel:last-child {
    flex: 1;
    min-height: 0;
    display: flex;
    flex-direction: column;
}

.anomalies-left-column .panel:last-child .panel-content {
    flex: 1;
    overflow-y: auto;
}

.anomalies-right-column {
    display: flex;
    flex-direction: column;
    min-height: 0;
    overflow: hidden;
}

.panel-full-height {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
}

.panel-content-scroll {
    flex: 1;
    overflow-y: auto;
    max-height: none !important;
}

#view-anomalies {
    height: 100%;
    overflow: hidden;
}

#view-anomalies .panel {
    background: white;
    border-radius: 12px;
    box-shadow: var(--shadow-sm);
}

#view-anomalies .panel-header {
    padding: 1rem 1.25rem;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
}

#view-anomalies .panel-content {
    padding: 1rem 1.25rem;
}

#view-anomalies .panel-description {
    padding: 0.75rem 1.25rem;
    background: #f8fafc;
    border-bottom: 1px solid var(--border);
    font-size: 0.85rem;
    color: var(--text-muted);
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
}

#view-anomalies .panel-description .material-icons {
    font-size: 18px;
    flex-shrink: 0;
    margin-top: 2px;
    color: var(--primary);
}

#view-anomalies .panel-description .description-text {
    flex: 1;
    line-height: 1.5;
}

#view-anomalies .panel-description .description-text strong {
    color: var(--text-dark);
}

/* Anomaly Card Actions - 3 colonnes */
#anomalies-list .anomaly-card .anomaly-actions {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
}

#anomalies-list .anomaly-card .anomaly-actions .btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem;
    border-radius: 6px;
    background: #f1f5f9;
    border: 1px solid #e2e8f0;
    transition: all 0.2s;
}

#anomalies-list .anomaly-card .anomaly-actions .btn:hover {
    background: #e2e8f0;
    border-color: #cbd5e1;
}

#anomalies-list .anomaly-card .anomaly-actions .btn .material-icons {
    font-size: 18px;
    color: #64748b;
}

#anomalies-list .anomaly-card .anomaly-actions .btn:hover .material-icons {
    color: var(--primary);
}

/* Responsive pour 2 colonnes anomalies */
@media (max-width: 1024px) {
    .anomalies-two-columns {
        grid-template-columns: 1fr;
        overflow-y: auto;
    }

    .anomalies-left-column,
    .anomalies-right-column {
        overflow: visible;
    }

    .panel-content-scroll {
        max-height: 400px !important;
    }
}

/* ============================================
   ANOMALY STATS DASHBOARD - NEW DESIGN
   ============================================ */

.anomaly-stats-dashboard {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

/* Main stats row - 3 boxes */
.stats-main-row {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
}

.stat-box {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    border-radius: 10px;
    background: #f8fafc;
    border: 1px solid #e2e8f0;
}

.stat-box .stat-icon {
    width: 48px;
    height: 48px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.stat-box .stat-icon .material-icons {
    font-size: 24px;
    color: white;
}

.stat-box.total .stat-icon {
    background: linear-gradient(135deg, #f59e0b, #d97706);
}

.stat-box.pending .stat-icon {
    background: linear-gradient(135deg, #6366f1, #4f46e5);
}

.stat-box.acknowledged .stat-icon {
    background: linear-gradient(135deg, #10b981, #059669);
}

.stat-box .stat-info {
    display: flex;
    flex-direction: column;
}

.stat-box .stat-number {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--text-dark);
    line-height: 1;
}

.stat-box .stat-label {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-top: 0.25rem;
}

/* Severity row */
.stats-severity-row {
    display: flex;
    gap: 1.5rem;
    padding: 0.75rem 1rem;
    background: #f1f5f9;
    border-radius: 8px;
}

.severity-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.severity-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
}

.severity-item.critical .severity-dot { background: #dc2626; }
.severity-item.high .severity-dot { background: #ea580c; }
.severity-item.medium .severity-dot { background: #ca8a04; }
.severity-item.low .severity-dot { background: #16a34a; }

.severity-count {
    font-weight: 700;
    font-size: 1rem;
    color: var(--text-dark);
}

.severity-label {
    font-size: 0.8rem;
    color: var(--text-muted);
}

/* Confidence row */
.stats-confidence-row {
    padding: 0.75rem 0;
}

.confidence-meter {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.confidence-meter .material-icons {
    color: var(--primary);
    font-size: 20px;
}

.confidence-label {
    font-size: 0.85rem;
    color: var(--text-muted);
    white-space: nowrap;
}

.confidence-bar {
    flex: 1;
    height: 8px;
    background: #e2e8f0;
    border-radius: 4px;
    overflow: hidden;
}

.confidence-fill {
    height: 100%;
    background: linear-gradient(90deg, #3b82f6, #2563eb);
    border-radius: 4px;
    transition: width 0.5s ease;
}

.confidence-value {
    font-weight: 700;
    font-size: 1rem;
    color: var(--primary);
    min-width: 45px;
    text-align: right;
}

/* ============================================
   ALERTS BANNER - NEW DESIGN
   ============================================ */

.alerts-banner-new {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem 1rem;
    border-radius: 10px;
    margin-bottom: 0.5rem;
}

.alerts-banner-new.critical {
    background: linear-gradient(135deg, #fef2f2, #fee2e2);
    border: 1px solid #fca5a5;
}

.alerts-banner-new.high {
    background: linear-gradient(135deg, #fff7ed, #ffedd5);
    border: 1px solid #fdba74;
}

.alerts-banner-new.medium {
    background: linear-gradient(135deg, #fefce8, #fef9c3);
    border: 1px solid #fde047;
}

.alerts-banner-new.low {
    background: linear-gradient(135deg, #f0fdf4, #dcfce7);
    border: 1px solid #86efac;
}

.alert-indicator {
    flex-shrink: 0;
}

.alert-indicator .material-icons {
    font-size: 28px;
}

.alerts-banner-new.critical .alert-indicator .material-icons { color: #dc2626; }
.alerts-banner-new.high .alert-indicator .material-icons { color: #ea580c; }
.alerts-banner-new.medium .alert-indicator .material-icons { color: #ca8a04; }
.alerts-banner-new.low .alert-indicator .material-icons { color: #16a34a; }

.alert-indicator .pulse {
    animation: pulse-icon 1.5s ease-in-out infinite;
}

@keyframes pulse-icon {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.1); }
}

.alert-main {
    flex: 1;
    min-width: 0;
}

.alert-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.25rem;
}

.alert-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 24px;
    height: 24px;
    padding: 0 0.5rem;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 700;
    color: white;
}

.alerts-banner-new.critical .alert-badge { background: #dc2626; }
.alerts-banner-new.high .alert-badge { background: #ea580c; }
.alerts-banner-new.medium .alert-badge { background: #ca8a04; }
.alerts-banner-new.low .alert-badge { background: #16a34a; }

.alert-title {
    font-weight: 600;
    font-size: 0.9rem;
}

.alerts-banner-new.critical .alert-title { color: #991b1b; }
.alerts-banner-new.high .alert-title { color: #9a3412; }
.alerts-banner-new.medium .alert-title { color: #854d0e; }
.alerts-banner-new.low .alert-title { color: #166534; }

.alert-preview {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8rem;
}

.severity-tag {
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
}

.severity-tag.critical { background: #fecaca; color: #991b1b; }
.severity-tag.high { background: #fed7aa; color: #9a3412; }
.severity-tag.medium { background: #fef08a; color: #854d0e; }
.severity-tag.low { background: #bbf7d0; color: #166534; }

.alert-text {
    color: var(--text-muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.alert-actions-bar {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-shrink: 0;
}

.alert-actions-bar .btn-outline {
    border: 1px solid currentColor;
    background: transparent;
}

.alerts-banner-new.critical .btn-outline { color: #dc2626; border-color: #fca5a5; }
.alerts-banner-new.high .btn-outline { color: #ea580c; border-color: #fdba74; }

.alert-actions-bar .btn-ghost {
    padding: 0.35rem;
}

/* Responsive */
@media (max-width: 768px) {
    .stats-main-row {
        grid-template-columns: 1fr;
    }

    .stats-severity-row {
        flex-wrap: wrap;
        gap: 1rem;
    }

    .alerts-banner-new {
        flex-wrap: wrap;
    }

    .alert-preview {
        width: 100%;
    }
}

/* ============================================
   ANOMALY DETAIL PANEL - NEW DESIGN
   ============================================ */

.anomaly-detail-card {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.anomaly-detail-header-new {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1rem;
    border-radius: 10px;
    background: #f8fafc;
}

.anomaly-detail-header-new.severity-critical { background: linear-gradient(135deg, #fef2f2, #fee2e2); border-left: 4px solid #dc2626; }
.anomaly-detail-header-new.severity-high { background: linear-gradient(135deg, #fff7ed, #ffedd5); border-left: 4px solid #ea580c; }
.anomaly-detail-header-new.severity-medium { background: linear-gradient(135deg, #fefce8, #fef9c3); border-left: 4px solid #ca8a04; }
.anomaly-detail-header-new.severity-low { background: linear-gradient(135deg, #f0fdf4, #dcfce7); border-left: 4px solid #16a34a; }

.anomaly-detail-header-new .header-icon {
    width: 48px;
    height: 48px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.anomaly-detail-header-new.severity-critical .header-icon { background: #dc2626; }
.anomaly-detail-header-new.severity-high .header-icon { background: #ea580c; }
.anomaly-detail-header-new.severity-medium .header-icon { background: #ca8a04; }
.anomaly-detail-header-new.severity-low .header-icon { background: #16a34a; }

.anomaly-detail-header-new .header-icon .material-icons {
    font-size: 24px;
    color: white;
}

.anomaly-detail-header-new .header-content {
    flex: 1;
    min-width: 0;
}

.anomaly-detail-header-new .header-content h3 {
    margin: 0 0 0.5rem;
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-dark);
    line-height: 1.3;
}

.header-badges {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.type-badge {
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
    background: #e2e8f0;
    color: var(--text-muted);
    text-transform: uppercase;
}

.severity-badge-new {
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
}

.severity-badge-new.severity-critical { background: #fecaca; color: #991b1b; }
.severity-badge-new.severity-high { background: #fed7aa; color: #9a3412; }
.severity-badge-new.severity-medium { background: #fef08a; color: #854d0e; }
.severity-badge-new.severity-low { background: #bbf7d0; color: #166534; }

.anomaly-description-box {
    padding: 0.75rem 1rem;
    background: #f1f5f9;
    border-radius: 8px;
    border-left: 3px solid var(--primary);
}

.anomaly-description-box p {
    margin: 0;
    font-size: 0.9rem;
    color: var(--text-dark);
    line-height: 1.5;
}

.anomaly-metrics {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.75rem;
}

.metric-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background: #f8fafc;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
}

.metric-item .material-icons {
    font-size: 20px;
    color: var(--primary);
}

.metric-content {
    display: flex;
    flex-direction: column;
}

.metric-value {
    font-weight: 700;
    font-size: 1rem;
    color: var(--text-dark);
}

.metric-label {
    font-size: 0.7rem;
    color: var(--text-muted);
    text-transform: uppercase;
}

.confidence-bar-small {
    flex: 1;
    height: 6px;
    background: #e2e8f0;
    border-radius: 3px;
    overflow: hidden;
}

.confidence-fill-small {
    height: 100%;
    background: linear-gradient(90deg, #3b82f6, #2563eb);
    border-radius: 3px;
}

.anomaly-section-new {
    padding: 0.75rem 0;
    border-top: 1px solid #e2e8f0;
}

.anomaly-section-new .section-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-dark);
}

.anomaly-section-new .section-header .material-icons {
    font-size: 18px;
    color: var(--primary);
}

.details-grid {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.details-grid .detail-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0.75rem;
    background: #f8fafc;
    border-radius: 6px;
}

.details-grid .detail-key {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.details-grid .detail-value {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-dark);
}

.related-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.related-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.4rem 0.75rem;
    border-radius: 6px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s;
}

.related-tag .material-icons {
    font-size: 14px;
}

.related-tag.entity {
    background: #dbeafe;
    color: #1d4ed8;
}

.related-tag.entity:hover {
    background: #bfdbfe;
}

.related-tag.event {
    background: #fef3c7;
    color: #92400e;
}

.related-tag.evidence {
    background: #e0e7ff;
    color: #4338ca;
}

.related-tag.evidence:hover {
    background: #c7d2fe;
}

.anomaly-section-new.ai-section {
    background: linear-gradient(135deg, #eff6ff, #f0f9ff);
    margin: 0 -1.25rem;
    padding: 1rem 1.25rem;
    border-radius: 0;
}

.ai-explanation-content {
    font-size: 0.85rem;
    color: var(--text-dark);
    line-height: 1.6;
}

.recommendations-list-new {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.recommendations-list-new li {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    font-size: 0.85rem;
    color: var(--text-dark);
}

.recommendations-list-new li .material-icons {
    font-size: 16px;
    color: #16a34a;
    flex-shrink: 0;
}

.anomaly-actions-footer {
    display: flex;
    gap: 0.75rem;
    padding-top: 1rem;
    border-top: 1px solid #e2e8f0;
    margin-top: 0.5rem;
}

.anomaly-actions-footer .btn {
    flex: 1;
    justify-content: center;
}

.acknowledged-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.5rem 1rem;
    background: #dcfce7;
    color: #166534;
    border-radius: 6px;
    font-size: 0.85rem;
    font-weight: 500;
}

.acknowledged-badge .material-icons {
    font-size: 18px;
}

/* ============================================
   CAUSAL CHAIN ANOMALIES PANEL
   ============================================ */

.causal-chain-anomalies-panel {
    background: white;
    border-radius: 12px;
    border: 1px solid #e2e8f0;
    overflow: hidden;
    margin-bottom: 1rem;
}

.causal-chain-anomalies-panel .panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.75rem 1rem;
    background: linear-gradient(135deg, #fef3c7, #fef9c3);
    border-bottom: 1px solid #fcd34d;
    cursor: pointer;
    transition: all 0.2s ease;
}

.causal-chain-anomalies-panel .panel-header:hover {
    background: linear-gradient(135deg, #fde68a, #fef3c7);
}

.causal-chain-anomalies-panel .panel-header .header-left {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.causal-chain-anomalies-panel .panel-header .material-icons {
    color: #b45309;
    font-size: 1.25rem;
}

.causal-chain-anomalies-panel .panel-header h3 {
    margin: 0;
    font-size: 0.95rem;
    font-weight: 600;
    color: #92400e;
}

.causal-chain-anomalies-panel .panel-header .anomaly-count-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 24px;
    height: 24px;
    padding: 0 0.5rem;
    background: #f59e0b;
    color: white;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
}

.causal-chain-anomalies-panel .panel-header .toggle-icon {
    color: #92400e;
    transition: transform 0.3s ease;
}

.causal-chain-anomalies-panel .panel-header.collapsed .toggle-icon {
    transform: rotate(-90deg);
}

.causal-chain-anomalies-panel .panel-content {
    max-height: 400px;
    overflow-y: auto;
    transition: max-height 0.3s ease;
}

.causal-chain-anomalies-panel .panel-content.collapsed {
    max-height: 0;
    overflow: hidden;
}

.causal-chain-anomalies-panel .anomalies-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    padding: 0.75rem;
}

.chain-anomaly-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    padding: 0.75rem;
    background: var(--bg-subtle);
    border: 1px solid var(--border);
    border-radius: 8px;
    transition: all 0.2s ease;
}

.chain-anomaly-item:hover {
    background: white;
    border-color: #f59e0b;
    box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);
}

.chain-anomaly-item .anomaly-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.chain-anomaly-item .anomaly-icon {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    flex-shrink: 0;
}

.chain-anomaly-item .anomaly-icon.severity-critical {
    background: #fef2f2;
    color: #dc2626;
}

.chain-anomaly-item .anomaly-icon.severity-high {
    background: #fff7ed;
    color: #ea580c;
}

.chain-anomaly-item .anomaly-icon.severity-medium {
    background: #fefce8;
    color: #ca8a04;
}

.chain-anomaly-item .anomaly-icon.severity-low {
    background: #f0fdf4;
    color: #16a34a;
}

.chain-anomaly-item .anomaly-icon .material-icons {
    font-size: 1.1rem;
}

.chain-anomaly-item .anomaly-info {
    flex: 1;
    min-width: 0;
}

.chain-anomaly-item .anomaly-type {
    font-weight: 600;
    font-size: 0.85rem;
    color: var(--text-dark);
    margin-bottom: 0.15rem;
}

.chain-anomaly-item .anomaly-description {
    font-size: 0.8rem;
    color: var(--text-muted);
    line-height: 1.4;
}

.chain-anomaly-item .anomaly-badges {
    display: flex;
    gap: 0.35rem;
    margin-left: auto;
    flex-shrink: 0;
}

.chain-anomaly-item .severity-badge {
    display: inline-flex;
    align-items: center;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
}

.chain-anomaly-item .severity-badge.critical {
    background: #fee2e2;
    color: #991b1b;
}

.chain-anomaly-item .severity-badge.high {
    background: #ffedd5;
    color: #9a3412;
}

.chain-anomaly-item .severity-badge.medium {
    background: #fef9c3;
    color: #854d0e;
}

.chain-anomaly-item .severity-badge.low {
    background: #dcfce7;
    color: #166534;
}

.chain-anomaly-item .status-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 500;
    background: #f3f4f6;
    color: #6b7280;
}

.chain-anomaly-item .status-badge .material-icons {
    font-size: 0.8rem;
}

.anomaly-chain-preview {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.35rem;
    padding: 0.5rem;
    background: white;
    border: 1px dashed #d1d5db;
    border-radius: 6px;
    font-size: 0.75rem;
}

.anomaly-chain-preview .chain-step {
    padding: 0.15rem 0.4rem;
    background: #e0e7ff;
    color: #4338ca;
    border-radius: 4px;
    font-weight: 500;
}

.anomaly-chain-preview .chain-step.problematic {
    background: #fee2e2;
    color: #991b1b;
    border: 1px solid #fca5a5;
}

.anomaly-chain-preview .chain-arrow {
    color: #9ca3af;
}

.causal-chain-anomalies-panel .no-anomalies {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    text-align: center;
    color: var(--text-muted);
}

.causal-chain-anomalies-panel .no-anomalies .material-icons {
    font-size: 2.5rem;
    color: #10b981;
    margin-bottom: 0.5rem;
}

.causal-chain-anomalies-panel .no-anomalies p {
    margin: 0;
    font-size: 0.85rem;
}

/* Anomaly type specific colors */
.chain-anomaly-item[data-type="incomplete"] .anomaly-icon {
    background: #fef3c7;
    color: #b45309;
}

.chain-anomaly-item[data-type="circular"] .anomaly-icon {
    background: #fee2e2;
    color: #dc2626;
}

.chain-anomaly-item[data-type="unknown_entity"] .anomaly-icon {
    background: #e0e7ff;
    color: #4f46e5;
}

.chain-anomaly-item[data-type="complex"] .anomaly-icon {
    background: #fce7f3;
    color: #be185d;
}

.chain-anomaly-item[data-type="missing_relation"] .anomaly-icon {
    background: #f3f4f6;
    color: #6b7280;
}

.chain-anomaly-item[data-type="contradiction"] .anomaly-icon {
    background: #fef2f2;
    color: #b91c1c;
}

/* ============================================
   SCENARIO CARDS - NEW DESIGN
   ============================================ */

.scenario-card-new {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 1rem;
    cursor: pointer;
    transition: all 0.2s;
}

.scenario-card-new:hover {
    border-color: var(--primary);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.scenario-card-new.selected {
    border-color: var(--primary);
    background: #eff6ff;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.scenario-card-header {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    margin-bottom: 0.75rem;
}

.scenario-type-icon {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.scenario-type-icon .material-icons {
    font-size: 20px;
    color: white;
}

.scenario-type-icon.guilt { background: linear-gradient(135deg, #dc2626, #b91c1c); }
.scenario-type-icon.presence { background: linear-gradient(135deg, #0891b2, #0e7490); }
.scenario-type-icon.motive { background: linear-gradient(135deg, #7c3aed, #6d28d9); }
.scenario-type-icon.timeline { background: linear-gradient(135deg, #2563eb, #1d4ed8); }
.scenario-type-icon.relation { background: linear-gradient(135deg, #059669, #047857); }

.scenario-card-info {
    flex: 1;
    min-width: 0;
}

.scenario-type-label {
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    color: var(--text-muted);
    display: block;
    margin-bottom: 0.15rem;
}

.scenario-card-info h4 {
    margin: 0;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-dark);
    line-height: 1.3;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.scenario-plausibility-badge {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    flex-shrink: 0;
}

.scenario-plausibility-badge .plausibility-value {
    font-size: 1.1rem;
    font-weight: 700;
}

.scenario-plausibility-badge.high .plausibility-value { color: #16a34a; }
.scenario-plausibility-badge.medium .plausibility-value { color: #ca8a04; }
.scenario-plausibility-badge.low .plausibility-value { color: #dc2626; }

.plausibility-bar-mini {
    width: 50px;
    height: 4px;
    background: #e2e8f0;
    border-radius: 2px;
    overflow: hidden;
    margin-top: 0.25rem;
}

.plausibility-fill-mini {
    height: 100%;
    border-radius: 2px;
    transition: width 0.3s;
}

.scenario-plausibility-badge.high .plausibility-fill-mini { background: #16a34a; }
.scenario-plausibility-badge.medium .plausibility-fill-mini { background: #ca8a04; }
.scenario-plausibility-badge.low .plausibility-fill-mini { background: #dc2626; }

.scenario-assumption-box {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    padding: 0.75rem;
    background: #f8fafc;
    border-radius: 8px;
    border-left: 3px solid var(--primary);
    margin-bottom: 0.75rem;
}

.scenario-assumption-box .material-icons {
    font-size: 18px;
    color: var(--primary);
    flex-shrink: 0;
    opacity: 0.6;
}

.scenario-assumption-box p {
    margin: 0;
    font-size: 0.85rem;
    color: var(--text-dark);
    font-style: italic;
    line-height: 1.4;
}

.scenario-metrics-row {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
}

.scenario-metric {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.35rem 0.6rem;
    background: #f1f5f9;
    border-radius: 6px;
    font-size: 0.75rem;
}

.scenario-metric .material-icons {
    font-size: 14px;
    color: var(--text-muted);
}

.scenario-metric .metric-number {
    font-weight: 700;
    color: var(--text-dark);
}

.scenario-metric .metric-text {
    color: var(--text-muted);
}

.scenario-metric.supporting .material-icons { color: #16a34a; }
.scenario-metric.supporting .metric-number { color: #16a34a; }

.scenario-metric.contradicting .material-icons { color: #dc2626; }
.scenario-metric.contradicting .metric-number { color: #dc2626; }

.scenario-actions-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 0.5rem;
    padding-top: 0.75rem;
    border-top: 1px solid #e2e8f0;
}

.btn.btn-action {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem;
    border-radius: 6px;
    background: #f1f5f9;
    border: 1px solid #e2e8f0;
    cursor: pointer;
    transition: all 0.2s;
}

.btn.btn-action:hover {
    background: #e2e8f0;
    border-color: #cbd5e1;
}

.btn.btn-action .material-icons {
    font-size: 18px;
    color: #64748b;
}

.btn.btn-action:hover .material-icons {
    color: var(--primary);
}

.btn.btn-action.danger:hover {
    background: #fee2e2;
    border-color: #fca5a5;
}

.btn.btn-action.danger:hover .material-icons {
    color: #dc2626;
}

/* Scenario panel description improvements */
#view-scenarios .panel-description {
    padding: 0.75rem 1.25rem;
    background: #f8fafc;
    border-bottom: 1px solid var(--border);
    font-size: 0.85rem;
    color: var(--text-muted);
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
}

#view-scenarios .panel-description .material-icons {
    font-size: 18px;
    flex-shrink: 0;
    margin-top: 2px;
    color: var(--primary);
}

#view-scenarios .panel-description .description-text {
    flex: 1;
    line-height: 1.5;
}

#view-scenarios .panel-description .description-text strong {
    color: var(--text-dark);
}

/* ==============================================
   Advanced Detection Features - Statistical Display
   ============================================== */

/* Bayesian Indicator in anomaly cards */
.bayesian-indicator {
    font-size: 0.75rem;
    font-weight: 600;
    margin-left: 4px;
}

.bayesian-indicator.positive {
    color: #16a34a;
}

.bayesian-indicator.negative {
    color: #dc2626;
}

/* Z-Score display in anomaly cards */
.anomaly-zscore {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 0.8rem;
    color: #6366f1;
    background: #eef2ff;
    padding: 2px 8px;
    border-radius: 4px;
}

.anomaly-zscore .material-icons {
    font-size: 14px;
}

/* Detection method badge */
.detection-method-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 0.75rem;
    padding: 3px 8px;
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    color: #0369a1;
    border-radius: 12px;
    border: 1px solid #bae6fd;
    cursor: help;
}

.detection-method-badge .material-icons {
    font-size: 14px;
}

/* Method badge in header */
.method-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 0.7rem;
    padding: 2px 6px;
    background: #f1f5f9;
    color: #475569;
    border-radius: 4px;
}

.method-badge .material-icons {
    font-size: 12px;
}

/* Bayesian adjustment display */
.bayesian-adjust {
    font-size: 0.75rem;
    font-weight: 600;
    padding: 2px 6px;
    border-radius: 4px;
    margin-left: 8px;
}

.bayesian-adjust.positive {
    background: #dcfce7;
    color: #16a34a;
}

.bayesian-adjust.negative {
    background: #fee2e2;
    color: #dc2626;
}

/* Stats section in anomaly detail */
.anomaly-section-new.stats-section {
    background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
    border: 1px solid #e9d5ff;
}

.anomaly-section-new.stats-section .section-header {
    color: #7c3aed;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 8px;
}

.stats-grid .detail-row {
    background: rgba(255, 255, 255, 0.6);
    padding: 6px 10px;
    border-radius: 6px;
}

/* Algorithm stats in detection summary */
.algorithm-stats {
    background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
    border: 1px solid #e9d5ff;
    border-radius: 12px;
    padding: 1rem;
    margin: 1rem 0;
}

.algorithm-stats h4 {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #7c3aed;
    font-size: 0.9rem;
    margin-bottom: 0.75rem;
}

.algorithm-stats h4 .material-icons {
    font-size: 18px;
}

.stats-grid-summary {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.stats-grid-summary .stat-item {
    flex: 1;
    min-width: 100px;
    text-align: center;
    padding: 0.75rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.stats-grid-summary .stat-item.highlight {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    border: 1px solid #fbbf24;
}

.stats-grid-summary .stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1e3a5f;
    display: block;
}

.stats-grid-summary .stat-label {
    font-size: 0.75rem;
    color: #64748b;
    margin-top: 4px;
}

/* Detection methods summary section */
.detection-methods-summary {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 1rem;
    margin: 1rem 0;
}

.detection-methods-summary h4 {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #475569;
    font-size: 0.9rem;
    margin-bottom: 0.75rem;
}

.detection-methods-summary h4 .material-icons {
    font-size: 18px;
    color: #0ea5e9;
}

.methods-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.detection-method-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 12px;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 20px;
    font-size: 0.8rem;
}

.method-badge-summary {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    color: #334155;
}

.method-badge-summary .material-icons {
    font-size: 16px;
    color: #0ea5e9;
}

.method-count {
    background: #0ea5e9;
    color: white;
    font-size: 0.7rem;
    font-weight: 600;
    padding: 2px 6px;
    border-radius: 10px;
    min-width: 20px;
    text-align: center;
}

/* Z-score display in type items */
.type-item .item-zscore {
    font-size: 0.7rem;
    color: #6366f1;
    background: #eef2ff;
    padding: 1px 6px;
    border-radius: 4px;
    margin-left: auto;
}

/* Metric item enhancements */
.anomaly-metrics .metric-item {
    position: relative;
}

.confidence-bar-small {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: #e2e8f0;
    border-radius: 0 0 8px 8px;
    overflow: hidden;
}

.confidence-fill-small {
    height: 100%;
    background: linear-gradient(90deg, #0ea5e9, #06b6d4);
    transition: width 0.3s ease;
}

/* Tooltip enhancements for anomaly detection - only apply to specific anomaly elements */
.anomaly-card [data-tooltip],
.anomaly-detail-card [data-tooltip],
.detection-summary-enhanced [data-tooltip],
.detection-method-badge[data-tooltip],
.anomaly-zscore[data-tooltip],
.severity-segment[data-tooltip] {
    position: relative;
}

.anomaly-card [data-tooltip]:hover::after,
.anomaly-detail-card [data-tooltip]:hover::after,
.detection-summary-enhanced [data-tooltip]:hover::after,
.detection-method-badge[data-tooltip]:hover::after,
.anomaly-zscore[data-tooltip]:hover::after,
.severity-segment[data-tooltip]:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%);
    background: #1e293b;
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 0.75rem;
    white-space: nowrap;
    max-width: 300px;
    white-space: normal;
    z-index: 1000;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.anomaly-card [data-tooltip]:hover::before,
.anomaly-detail-card [data-tooltip]:hover::before,
.detection-summary-enhanced [data-tooltip]:hover::before,
.detection-method-badge[data-tooltip]:hover::before,
.anomaly-zscore[data-tooltip]:hover::before,
.severity-segment[data-tooltip]:hover::before {
    content: '';
    position: absolute;
    bottom: calc(100% + 2px);
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-top-color: #1e293b;
    z-index: 1000;
}
